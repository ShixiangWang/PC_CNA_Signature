<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Shixiang Wang" />
<meta name="author" content="Huimin Li" />
<meta name="author" content="Xuan Wang" />
<meta name="author" content="Minfang Song" />
<meta name="author" content="Xue-Song Liu (Corresponding author)" />

<meta name="date" content="2020-03-10" />

<title>Prostate Cancer Variation Signature Analysis Report</title>

<script src="index_files/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.6/css/bootstrap.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.6/js/bootstrap.min.js"></script>
<script src="index_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="index_files/navigation-1.1/tabsets.js"></script>
<script src="index_files/navigation-1.1/codefolding.js"></script>
<link href="index_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="index_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="index_files/readthedown-0.1/readthedown.css" rel="stylesheet" />
<script src="index_files/readthedown-0.1/readthedown.js"></script>
<script src="index_files/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="index_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="index_files/datatables-binding-0.12/datatables.js"></script>
<link href="index_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="index_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="index_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="index_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="index_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


</head>

<body>


<div id="content" data-toggle="wy-nav-shift">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("text-table-of-contents");
});
</script>

<!-- code folding -->

<nav id="nav-top" role="navigation" aria-label="top navigation">
    <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
</nav>


<div id="header">
<h1 class="title">Prostate Cancer Variation Signature Analysis Report</h1>
</div>


<div id="table-of-contents">
    <h2><a href="#content">Prostate Cancer Variation Signature Analysis Report</a></h2>
    <div id="text-table-of-contents">
      <ul>
      <li><a href="#data-preprocessing">Data Preprocessing</a><ul>
      <li><a href="#data-downloading">Data downloading</a><ul>
      <li><a href="#wes-data">WES data</a></li>
      <li><a href="#phenotype-data">Phenotype data</a></li>
      <li><a href="#survival-data">Survival data</a></li>
      </ul></li>
      <li><a href="#data-preprocessing-1">Data preprocessing</a><ul>
      <li><a href="#pipeline">Pipeline</a></li>
      <li><a href="#sequence-alignment">Sequence alignment</a></li>
      <li><a href="#copy-number-calling">Copy number calling</a></li>
      <li><a href="#mutation-calling">Mutation calling</a></li>
      </ul></li>
      <li><a href="#data-cleaning">Data cleaning</a><ul>
      <li><a href="#phenotype-data-1">Phenotype data</a></li>
      <li><a href="#survival-data-1">Survival data</a></li>
      <li><a href="#variation-profile">Variation profile</a></li>
      </ul></li>
      </ul></li>
      <li><a href="#signature-identification">Signature Identification</a><ul>
      <li><a href="#tally-variation-records">Tally variation records</a><ul>
      <li><a href="#methods">Methods</a></li>
      <li><a href="#tally-records">Tally records</a></li>
      </ul></li>
      <li><a href="#estimate-signature-number">Estimate signature number</a><ul>
      <li><a href="#copy-number-1">Copy number</a></li>
      <li><a href="#sbs-1">SBS</a></li>
      <li><a href="#result">Result</a></li>
      </ul></li>
      <li><a href="#extract-signatures">Extract signatures</a></li>
      <li><a href="#show-signature-profile-and-aetiology">Show signature profile and aetiology</a><ul>
      <li><a href="#sbs-signature-profile">SBS signature profile</a></li>
      <li><a href="#copy-number-signature-profile">Copy number signature profile</a></li>
      <li><a href="#show-similarity-matrix">Show similarity matrix</a></li>
      <li><a href="#check-the-signature-exposure">Check the signature exposure</a></li>
      </ul></li>
      </ul></li>
      <li><a href="#association-analysis">Association Analysis</a><ul>
      <li><a href="#data-integration">Data integration</a></li>
      <li><a href="#association-analysis-1">Association analysis</a><ul>
      <li><a href="#prepare">Prepare</a></li>
      <li><a href="#signatures-features">Signatures &amp; features</a></li>
      <li><a href="#signatures-mutated-genes">Signatures &amp; mutated genes</a></li>
      <li><a href="#signatures-mutated-pathways">Signatures &amp; mutated pathways</a></li>
      <li><a href="#correlation-network">Correlation network</a></li>
      <li><a href="#signatures-psa">Signatures &amp; PSA</a></li>
      </ul></li>
      </ul></li>
      <li><a href="#group-analysis">Group Analysis</a><ul>
      <li><a href="#group-comparison">Group comparison</a></li>
      <li><a href="#group-mapping">Group mapping</a></li>
      <li><a href="#grouped-signature-exposure-profile">Grouped signature exposure profile</a><ul>
      <li><a href="#copy-number-signatures">Copy number signatures</a></li>
      <li><a href="#sbs-signatures">SBS signatures</a></li>
      </ul></li>
      <li><a href="#copy-number-profile-of-different-groups">Copy number profile of different groups</a><ul>
      <li><a href="#sig1-cases">Sig1 cases</a></li>
      <li><a href="#sig2-cases">Sig2 cases</a></li>
      <li><a href="#sig3-cases">Sig3 cases</a></li>
      <li><a href="#sig4-cases">Sig4 cases</a></li>
      <li><a href="#sig5-cases">Sig5 cases</a></li>
      <li><a href="#selected-cases">Selected cases</a></li>
      </ul></li>
      </ul></li>
      <li><a href="#survival-analysis">Survival Analysis</a><ul>
      <li><a href="#prepare-1">Prepare</a></li>
      <li><a href="#os-analysis-fo-signatures">OS analysis fo signatures</a></li>
      <li><a href="#pfs-analysis-for-signatures">PFS analysis for signatures</a></li>
      <li><a href="#os-analysis-for-features">OS analysis for features</a></li>
      <li><a href="#pfs-analysis-for-features">PFS analysis for features</a></li>
      </ul></li>
      <li><a href="#variation-summary">Variation Summary</a><ul>
      <li><a href="#oncoplot">Oncoplot</a></li>
      <li><a href="#sample-summary">Sample summary</a><ul>
      <li><a href="#copy-number-data">Copy number data</a></li>
      <li><a href="#maf-data">MAF data</a></li>
      </ul></li>
      <li><a href="#summary-plots">Summary plots</a><ul>
      <li><a href="#maf">MAF</a></li>
      <li><a href="#copy-number-3">Copy number</a></li>
      </ul></li>
      </ul></li>
      <li><a href="#supplementary-analysis-and-visualization">Supplementary Analysis and Visualization</a><ul>
      <li><a href="#facets-results">FACETS results</a></li>
      <li><a href="#method-comparison-between-macintyre-et-al-and-our-study">Method comparison between Macintyre et al and our study</a><ul>
      <li><a href="#sample-by-component-matrix-generation">Sample-by-component matrix generation</a></li>
      <li><a href="#copy-number-signatures-from-m-method">Copy number signatures from “M” method</a></li>
      <li><a href="#why-we-created-method-w">Why we created method “W”</a></li>
      </ul></li>
      <li><a href="#some-validation-analysis-in-other-datasets">Some validation analysis in other datasets</a><ul>
      <li><a href="#profile">Profile</a></li>
      <li><a href="#exposure">Exposure</a></li>
      <li><a href="#similarity-matrix">Similarity matrix</a></li>
      <li><a href="#exposure-comparison">Exposure comparison</a></li>
      <li><a href="#survival-analysis-1">Survival analysis</a></li>
      </ul></li>
      </ul></li>
      <li><a href="#reference">Reference</a></li>
      </ul>
    </div>
</div>

<div id="main">
<p>Contact Prof. Xue-Song Liu: <a href="mailto:liuxs@shanghaitech.edu.cn" class="email">liuxs@shanghaitech.edu.cn</a></p>
<p>This report is written to help readers understand what and how we did in this project. Please read the formal manuscript <strong>TBD</strong> for more details.</p>
<blockquote>
<p>This document is compiled from an Rmarkdown file which contains all code or description necessary to (auto-)reproduce the analysis for the accompanying project. Each section below describes a different component of the analysis and all numbers and figures are generated directly from the underlying data on compilation.</p>
</blockquote>
<div id="data-preprocessing" class="section level1">
<h1>Data Preprocessing</h1>
<p>This part focuses on data preprocessing, it contains the following sections:</p>
<ul>
<li><a href="#data-downloading">Data downloading</a></li>
<li><a href="#data-preprocessing">Data preprocessing</a>
<ul>
<li>Pipeline</li>
<li>Copy number calling</li>
<li>Mutation calling</li>
</ul></li>
<li><a href="#data-cleaning">Data cleaning</a></li>
</ul>
<div id="data-downloading" class="section level2">
<h2>Data downloading</h2>
<p>This section describes where and how we downloaded the data.</p>
<div id="wes-data" class="section level3">
<h3>WES data</h3>
<p>Whole exome sequencing raw data were downloaded from the following 6 dbGap studies:</p>
<ul>
<li><code>phs000178</code>: this is TCGA prostate cancer cohort, the raw data is <code>bam</code> format stored in <a href="https://portal.gdc.cancer.gov/">GDC portal</a>, we access them by dbGap permission</li>
<li><code>phs000447</code>: <code>sra</code> data</li>
<li><code>phs000554</code>: <code>sra</code> data</li>
<li><code>phs000909</code>: <code>sra</code> data</li>
<li><code>phs000915</code>: <code>sra</code> data</li>
<li><code>phs001141</code>: <code>sra</code> data</li>
</ul>
<p>A recent study <span class="citation">(Armenia et al. <a href="#ref-armenia2018long">2018</a>)</span> used 5 dbGap studies:</p>
<ul>
<li><code>phs000178</code></li>
<li><code>phs000447</code></li>
<li><code>phs000909</code></li>
<li><code>phs000915</code></li>
<li><code>phs000945</code></li>
</ul>
<p>Our study contains two new datasets <code>phs000554</code> and <code>phs001141</code> than <span class="citation">Armenia et al. (<a href="#ref-armenia2018long">2018</a>)</span>, however, <code>phs000945</code> was excluded from our study due to its unavailable status in dbGap database.</p>
<p>Therefore, to our knowledge, we included all available raw WES data in our study.</p>
<p>After selecting the raw WES data, we downloaded them by either <code>sratools</code> for dbGap data or <code>gdc-client</code> for TCGA data.</p>
</div>
<div id="phenotype-data" class="section level3">
<h3>Phenotype data</h3>
<p>Phenotype data of <code>phs000447</code>, <code>phs000554</code>, <code>phs000909</code>, <code>phs000915</code> and <code>phs001141</code> were downloaded along with the raw WES data. Phenotype data of TCGA prostate cancer cohort were downloaded from UCSC Xena by UCSCXenaTools <span class="citation">(Wang and Liu <a href="#ref-wang2019ucscxenatools">2019</a>)</span>. The cleaning process is described in <a href="#data-cleaning">‘Data cleaning’</a> section.</p>
</div>
<div id="survival-data" class="section level3">
<h3>Survival data</h3>
<p>Survival data of <code>phs000554</code> were included in phenotype data described above. Survival data of TCGA prostate cancer cohort were downloaded from UCSC Xena by UCSCXenaTools <span class="citation">(Wang and Liu <a href="#ref-wang2019ucscxenatools">2019</a>)</span>. The cleaning process is described in <a href="#data-cleaning">‘Data cleaning’</a> section.</p>
</div>
</div>
<div id="data-preprocessing-1" class="section level2">
<h2>Data preprocessing</h2>
<p>This section describes how we preprocessed the data.</p>
<div id="pipeline" class="section level3">
<h3>Pipeline</h3>
<p>The following diagram shows our upstream workflow. Steps before signature identification are belong to preprocessing. The preprocessing pipeline generates the variation records of samples.</p>
<p><img src="fig/PRAD_Analysis_Pipeline.png" width="600px" style="display: block; margin: auto;" /></p>
<center>
<strong>Genomic variation signature identification pipeline of prostate cancer</strong>
</center>
</div>
<div id="sequence-alignment" class="section level3">
<h3>Sequence alignment</h3>
<p>For cohorts including <code>phs000447</code>, <code>phs000554</code>, <code>phs000909</code>, <code>phs000915</code> and <code>phs001141</code>, the raw data are in <code>sra</code> format. We did sequence alignment to them. To keep in line with TCGA bam data, we used the same reference genome (downloaded from <a href="https://portal.gdc.cancer.gov/">GDC portal</a>) and operations (see <a href="https://docs.gdc.cancer.gov/Data/Bioinformatics_Pipelines/DNA_Seq_Variant_Calling_Pipeline/">GDC docs</a>).</p>
<blockquote>
<p>Of note, the preprocessing step was done on Linux server provided by High Performance Computing Service of ShanghaiTech University. So the work is presented in PBS scripts. If readers want to reproduce this work, please focus on the key code lines.</p>
</blockquote>
<p>The details are described as below.</p>
<div id="from-sra-to-fastq" class="section level4">
<h4>1. from <code>sra</code> to <code>fastq</code></h4>
<p>The raw WES data downloaded from dbGap database are in <code>sra</code> format, we need to convert them into <code>fastq</code> format firstly.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">#PBS -N fastq_&lt;sample&gt;</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=1</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#PBS -l walltime=20:00:00</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#PBS -l mem=10gb</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="va">workdir=</span>/public/home/liuxs/ncbi/dbGaP-16533</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="bu">cd</span> <span class="va">$workdir</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="ex">fastq-dump</span> -outdir fastq --split-3 --skip-technical --clip --gzip <span class="va">$workdir</span>/sra/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.sra</a></code></pre></div>
</div>
<div id="removed-the-adapters" class="section level4">
<h4>2. removed the adapters</h4>
<p>This step detected and removed the adapters with <code>trimgalore</code> <span class="citation">(Krueger <a href="#ref-krueger2015trim">2015</a>)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">#PBS -N &lt;sample&gt;_clean</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=1</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#PBS -l walltime=12:00:00</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="va">workdir=</span>/public/home/liuxs/ncbi/dbGaP-16533</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="ex">trim_galore</span> -q 20 --phred33 --stringency 3 --length 20 -e 0.1 --paired --gzip <span class="va">$workdir</span>/fastq/<span class="op">&lt;</span>sample<span class="op">&gt;</span>_1.fastq.gz \</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="va">$workdir</span>/fastq/<span class="op">&lt;</span>sample<span class="op">&gt;</span>_2.fastq.gz -o <span class="va">$workdir</span>/dnaseq/trimclean</a></code></pre></div>
</div>
<div id="bwa" class="section level4">
<h4>3. bwa</h4>
<p>This step aligned sequence reads to reference genome with recommended <code>BWA MEM</code> algorithm <span class="citation">(Li <a href="#ref-li2013aligning">2013</a>)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">#PBS -N mem_&lt;sample&gt;</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=4</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#PBS -l walltime=35:00:00</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#PBS -l mem=20gb</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#PBS -q normal_3</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="ex">bwa</span> mem -M -R <span class="st">&quot;@RG\tID:&lt;sample&gt;\t\</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="st">LM:&lt;sample&gt;\t\</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="st">SM:&lt;sample&gt;\t\</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="st">PL:illumina\tPU:&lt;sample&gt;&quot;</span>\</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"> /public/home/liuxs/biodata/reference/genome/gdc_hg38/GRCh38.d1.vd1.fa\</a>
<a class="sourceLine" id="cb3-15" data-line-number="15"> /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/trimclean/<span class="op">&lt;</span>sample<span class="op">&gt;</span>_1_val_1.fq.gz\</a>
<a class="sourceLine" id="cb3-16" data-line-number="16"> /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/trimclean/<span class="op">&lt;</span>sample<span class="op">&gt;</span>_2_val_2.fq.gz\</a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="op">&gt;&lt;</span>sample<span class="op">&gt;</span>.sam\</a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="kw">|</span><span class="fu">mv</span> <span class="op">&lt;</span>sample<span class="op">&gt;</span>.sam /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/bwa</a></code></pre></div>
</div>
<div id="sam-to-bam" class="section level4">
<h4>4. <code>sam</code> to <code>bam</code></h4>
<p>This step converted <code>sam</code> files to <code>bam</code> files with <code>samtools</code> <span class="citation">(Li et al. <a href="#ref-li2009sequence">2009</a>)</span>, which are smaller.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">#PBS -N bam_&lt;sample&gt;</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=4</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#PBS -l walltime=15:00:00</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#PBS -l mem=20gb</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="ex">samtools</span> view -bS /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/bwa/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.sam<span class="op">&gt;</span>\</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/bam/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.bam</a></code></pre></div>
</div>
<div id="sort-bam" class="section level4">
<h4>5. sort <code>bam</code></h4>
<p>Next we sorted the <code>bam</code> files with <code>Picard</code> <span class="citation">(“Picard Toolkit” <a href="#ref-Picard2019toolkit">2019</a>)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">#PBS -N sort_&lt;sample&gt;</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=4</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#PBS -l walltime=15:00:00</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#PBS -l mem=20gb</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="ex">java</span> -jar -Xmx12G -Djava.io.tmpdir=/public/home/liuxs/lhm/tmp \</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"> /public/home/liuxs/anaconda3/envs/wes/share/picard-2.20.6-0/picard.jar  SortSam\</a>
<a class="sourceLine" id="cb5-12" data-line-number="12"> I=/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/bam/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.bam\</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"> O=/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/bamsort/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.sort.bam\</a>
<a class="sourceLine" id="cb5-14" data-line-number="14"> SORT_ORDER=coordinate</a></code></pre></div>
</div>
<div id="mark-duplications" class="section level4">
<h4>6. mark duplications</h4>
<p>This step marked duplications with <code>Picard</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">#PBS -N rmdump_&lt;sample&gt; </span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=4</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#PBS -l walltime=10:00:00</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#PBS -l mem=10gb</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="ex">java</span> -jar /public/home/liuxs/anaconda3/envs/wes/share/picard-2.20.6-0/picard.jar MarkDuplicates\</a>
<a class="sourceLine" id="cb6-11" data-line-number="11"> I=/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/bamsort/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.sort.bam\</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"> O=/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/markqump/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.rdup.bam\</a>
<a class="sourceLine" id="cb6-13" data-line-number="13"> VALIDATION_STRINGENCY=LENIENT \</a>
<a class="sourceLine" id="cb6-14" data-line-number="14"> MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=1000 \</a>
<a class="sourceLine" id="cb6-15" data-line-number="15"> M=/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/markqump/matric/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.sort.addhead.rmdup.metric</a></code></pre></div>
<p>We then built index with <code>samtools</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">#PBS -N index_&lt;sample&gt;</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=4</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#PBS -l walltime=10:00:00</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb7-9" data-line-number="9"></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="ex">samtools</span> index /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/markqump/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.rdup.bam\</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"> /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/markqump/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.rdup.bam.bai</a></code></pre></div>
</div>
<div id="bqsr" class="section level4">
<h4>7. BQSR</h4>
<p>A base quality score recalibration (BQSR) step was then performed.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">#PBS -N bqsr_&lt;sample1&gt;</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=4</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#PBS -l walltime=30:00:00</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="bu">cd</span> /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/markqump</a>
<a class="sourceLine" id="cb8-10" data-line-number="10"></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="va">sample=</span><span class="op">&lt;</span><span class="ex">sample1</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="va">dbsnp=</span>/public/home/liuxs/biodata/reference/genome/hg38/ftp.broadinstitute.org/bundle/hg38/dbsnp_146.hg38.vcf.gz</a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="va">dbsnp1000G=</span>/public/home/liuxs/biodata/reference/genome/hg38/ftp.broadinstitute.org/bundle/hg38/1000G_phase1.snps.high_confidence.hg38.vcf.gz </a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="va">dbindel100G=</span>/public/home/liuxs/biodata/reference/genome/hg38/ftp.broadinstitute.org/bundle/hg38/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz</a>
<a class="sourceLine" id="cb8-15" data-line-number="15"></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="kw">if</span><span class="bu"> [</span> <span class="ot">-e</span> <span class="va">$sample</span>.rdup.bam<span class="bu"> ]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17">   <span class="ex">java</span> -jar -Xmx12G -Djava.io.tmpdir=/public/home/liuxs/lhm/tmp  /public/home/liuxs/anaconda3/envs/wes/share/gatk4-4.1.3.0-0/gatk-package-4.1.3.0-local.jar BaseRecalibrator \</a>
<a class="sourceLine" id="cb8-18" data-line-number="18">    -R /public/home/liuxs/biodata/reference/genome/gdc_hg38/GRCh38.d1.vd1.fa \</a>
<a class="sourceLine" id="cb8-19" data-line-number="19">    -I <span class="va">${sample}</span>.rdup.bam \</a>
<a class="sourceLine" id="cb8-20" data-line-number="20">    -O /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/table/<span class="va">${sample}</span>.recal_data.table \</a>
<a class="sourceLine" id="cb8-21" data-line-number="21">    --known-sites <span class="va">$dbsnp</span> --known-sites <span class="va">$dbsnp1000G</span> --known-sites <span class="va">$dbindel100G</span> <span class="kw">&amp;&amp;</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22">   <span class="ex">java</span> -jar -Xmx12G -Djava.io.tmpdir=/public/home/liuxs/lhm/tmp   /public/home/liuxs/anaconda3/envs/wes/share/gatk4-4.1.3.0-0/gatk-package-4.1.3.0-local.jar  ApplyBQSR  \</a>
<a class="sourceLine" id="cb8-23" data-line-number="23">    -R /public/home/liuxs/biodata/reference/genome/gdc_hg38/GRCh38.d1.vd1.fa \</a>
<a class="sourceLine" id="cb8-24" data-line-number="24">    -I <span class="va">${sample}</span>.rdup.bam \</a>
<a class="sourceLine" id="cb8-25" data-line-number="25">    --bqsr-recal-file /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/table/<span class="va">${sample}</span>.recal_data.table \</a>
<a class="sourceLine" id="cb8-26" data-line-number="26">    -O /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/bqsrbam/<span class="va">${sample}</span>.sorted.marked.BQSR.bam </a>
<a class="sourceLine" id="cb8-27" data-line-number="27">    <span class="bu">echo</span> gatk-BQSR <span class="kw">`</span><span class="fu">date</span><span class="kw">`</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="kw">fi</span></a></code></pre></div>
<p>The result <code>bam</code> files were then used for copy number calling and mutation calling.</p>
</div>
</div>
<div id="copy-number-calling" class="section level3">
<h3>Copy number calling</h3>
<p>The absolute copy number profile for each sample was detected by two well known softwares <a href="https://github.com/mskcc/facets">FACETS</a> <span class="citation">(Shen and Seshan <a href="#ref-shen_facets:_2016">2016</a>)</span> and <a href="https://sequenzatools.bitbucket.io/#/home">Sequenza</a> <span class="citation">(Favero et al. <a href="#ref-favero2014sequenza">2014</a>)</span>.</p>
<p>The code to generate tumor-normal pair for FACETS is <a href="https://github.com/ShixiangWang/prad_signature/blob/master/analysis/src/00-generate-samplefile-for-facets-cnv-calling.R">here</a>, the code to generate tumor-normal pair for Sequenza is <a href="https://github.com/ShixiangWang/prad_signature/blob/master/analysis/src/00-generate-samplefile-for-seqz-cnv-calling.R">here</a>.</p>
<div id="facets" class="section level4">
<h4>FACETS</h4>
<p>We followed the standard pipeline of FACETS described in <a href="https://github.com/mskcc/facets/blob/master/vignettes/FACETS.pdf">vignette</a> to call absolute copy number.</p>
<div id="snp-pileup" class="section level5">
<h5>1. SNP pileup</h5>
<p>This step followed the <a href="https://github.com/mskcc/facets/blob/master/inst/extcode/README.txt" class="uri">https://github.com/mskcc/facets/blob/master/inst/extcode/README.txt</a>.</p>
<p>For dbGap studies:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co">#PBS -N &lt;sample&gt;_snp</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=1</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#PBS -l walltime=10:00:00</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="bu">cd</span> /public/home/liuxs/anaconda3/envs/R/lib/R/library/facets/extcode</a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="bu">source</span> activate R</a>
<a class="sourceLine" id="cb9-10" data-line-number="10"></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co"># &lt;sample1&gt;=tumorbam</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co"># &lt;sample2&gt;=normalbam</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="va">path1=</span><span class="st">&quot;/public/home/liuxs/ncbi/dbGaP-16533/copy/out&quot;</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="va">path2=</span><span class="st">&quot;/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/bqsrbam&quot;</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="va">path3=</span><span class="st">&quot;/public/home/liuxs/ncbi/dbGaP-21926/dnaseq/BQSR/bqsrbam&quot;</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="va">name=</span><span class="op">&lt;</span><span class="ex">sample1</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="kw">if</span><span class="bu"> [</span> <span class="ot">-e</span> /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/bqsrbam/<span class="va">$name</span>.sorted.marked.BQSR.bam<span class="bu"> ]</span>; </a>
<a class="sourceLine" id="cb9-21" data-line-number="21"> <span class="kw">then</span> </a>
<a class="sourceLine" id="cb9-22" data-line-number="22">  <span class="ex">./snp-pileup</span> -g -q15 -Q20 -P100 -r25,0 /public/home/liuxs/biodata/reference/genome/hg38/snpvcf/common_all_20180418.vcf.gz\</a>
<a class="sourceLine" id="cb9-23" data-line-number="23">  <span class="va">${path1}</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.out.gz \</a>
<a class="sourceLine" id="cb9-24" data-line-number="24">  <span class="va">${path2}</span>/<span class="op">&lt;</span>sample2<span class="op">&gt;</span>.sorted.marked.BQSR.bam \</a>
<a class="sourceLine" id="cb9-25" data-line-number="25">  <span class="va">${path2}</span>/<span class="op">&lt;</span>sample1<span class="op">&gt;</span>.sorted.marked.BQSR.bam</a>
<a class="sourceLine" id="cb9-26" data-line-number="26"> <span class="kw">else</span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27">  <span class="ex">./snp-pileup</span> -g -q15 -Q20 -P100 -r25,0 /public/home/liuxs/biodata/reference/genome/hg38/snpvcf/common_all_20180418.vcf.gz\</a>
<a class="sourceLine" id="cb9-28" data-line-number="28"> <span class="va">${path1}</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.out.gz \</a>
<a class="sourceLine" id="cb9-29" data-line-number="29"> <span class="va">${path3}</span>/<span class="op">&lt;</span>sample2<span class="op">&gt;</span>.sorted.marked.BQSR.bam  \</a>
<a class="sourceLine" id="cb9-30" data-line-number="30"> <span class="va">${path3}</span>/<span class="op">&lt;</span>sample1<span class="op">&gt;</span>.sorted.marked.BQSR.bam </a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="kw">fi</span></a></code></pre></div>
<p>For TCGA:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">#PBS -N &lt;sample&gt;_snp</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=1</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#PBS -l walltime=10:00:00</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="bu">cd</span> /public/home/liuxs/anaconda3/envs/R/lib/R/library/facets/extcode</a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="bu">source</span> activate R</a>
<a class="sourceLine" id="cb10-10" data-line-number="10"></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co"># &lt;sample1&gt;=tumorbam</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co"># &lt;sample2&gt;=normalbam</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="va">path1=</span><span class="st">&quot;/public/home/liuxs/ncbi/dbGaP-16533/copy/csv&quot;</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="va">path2=</span><span class="st">&quot;/public/home/liuxs/biodata/gdc/links/TCGA_PRAD&quot;</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="ex">./snp-pileup</span> -g -q15 -Q20 -P100 -r25,0 /public/home/liuxs/biodata/reference/genome/hg38/snpvcf/common_all_20180418.vcf.gz <span class="va">${path1}</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.out.gz <span class="va">${path2}</span>/<span class="op">&lt;</span>sample2<span class="op">&gt;</span>.bam <span class="va">${path2}</span>/<span class="op">&lt;</span>sample1<span class="op">&gt;</span>.bam</a></code></pre></div>
</div>
<div id="run-facets-package" class="section level5">
<h5>2. run <code>facets</code> package</h5>
<p>This is a template R script used for copy number calling.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">#! /usr/bin/env Rscript</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">library</span>(<span class="st">&quot;pctGCdata&quot;</span>)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="kw">library</span>(<span class="st">&quot;facets&quot;</span>)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">rcmat =<span class="st"> </span><span class="kw">readSnpMatrix</span>(<span class="st">&quot;/public/home/liuxs/ncbi/dbGaP-16533/copy/out/&lt;sample&gt;.out.gz&quot;</span>)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">xx =<span class="st"> </span><span class="kw">preProcSample</span>(rcmat,<span class="dt">gbuild =</span> <span class="st">&quot;hg38&quot;</span>)</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">oo=<span class="kw">procSample</span>(xx,<span class="dt">cval=</span><span class="dv">150</span>)</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">fit=<span class="kw">emcncf</span>(oo)</a>
<a class="sourceLine" id="cb11-10" data-line-number="10"></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#plot </span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="kw">pdf</span>(<span class="st">&quot;/public/home/liuxs/ncbi/dbGaP-16533/copy/facetdata_150/&lt;sample&gt;.pdf&quot;</span>)</a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="kw">plotSample</span>(<span class="dt">x=</span>oo,<span class="dt">emfit=</span>fit)</a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="kw">logRlogORspider</span>(oo<span class="op">$</span>out, oo<span class="op">$</span>dipLogR) </a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="cf">while</span> (<span class="op">!</span><span class="kw">is.null</span>(<span class="kw">dev.list</span>()))  <span class="kw">dev.off</span>()</a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co"># </span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="kw">save</span>(fit,<span class="dt">file =</span> <span class="st">&quot;/public/home/liuxs/ncbi/dbGaP-16533/copy/facetdata_150/&lt;sample&gt;.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co"># output purity and ploidy -----</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19">purity=fit<span class="op">$</span>purity</a>
<a class="sourceLine" id="cb11-20" data-line-number="20">purity=<span class="kw">round</span>(purity,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-21" data-line-number="21">ploidy=fit<span class="op">$</span>ploidy</a>
<a class="sourceLine" id="cb11-22" data-line-number="22">ploidy=<span class="kw">round</span>(ploidy,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-23" data-line-number="23">output &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;&lt;sample&gt;&quot;</span>, purity, ploidy, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="kw">write</span>(output, <span class="st">&quot;/public/home/liuxs/ncbi/dbGaP-16533/copy/facetdata_150/&lt;sample&gt;.txt&quot;</span>, <span class="dt">append =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>This is the PBS script used for calling the R script above.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">##### submit R script</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#PBS -N R</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#PBS -l nodes=1:ppn=1</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#PBS -l walltime=50:00:00</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="bu">source</span> activate R</a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="kw">for</span> <span class="ex">i</span> in /public/home/liuxs/ncbi/dbGaP-16533/copy/Rdata/re150/pbs_150/*pbs<span class="kw">;do</span> <span class="ex">Rscript</span> <span class="va">$i</span><span class="kw">;done</span></a></code></pre></div>
</div>
</div>
<div id="sequenza" class="section level4">
<h4>Sequenza</h4>
<p>We followed the standard pipeline of Sequenza described in <a href="https://cran.r-project.org/web/packages/sequenza/vignettes/sequenza.html">vignette</a> to call absolute copy number. A modified <a href="https://github.com/ShixiangWang/copynumber">copynumber</a> package was used to work with hg38 genome build.</p>
<div id="process-a-fasta-file-to-produce-a-gc-wiggle-track-file" class="section level5">
<h5>1. process a <code>fasta</code> file to produce a GC <code>wiggle</code> track file</h5>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="bu">source</span> activate python3</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="va">ref_file=</span>/public/home/liuxs/biodata/reference/genome/gdc_hg38/GRCh38.d1.vd1.fa</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="va">gc_file=</span>/public/home/wangshx/wangshx/PRAD_Sig/hg38.gc50Base.wig.gz</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="fu">mkdir</span> -p <span class="va">$(</span><span class="fu">dirname</span> <span class="va">$gc_file)</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co"># sequenza-utils version: 3.0.0</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="ex">sequenza-utils</span> gc_wiggle -w 50 --fasta <span class="va">$ref_file</span> -o <span class="va">$gc_file</span></a></code></pre></div>
</div>
<div id="process-bam-and-wiggle-files-to-produce-a-small-seqz-file" class="section level5">
<h5>2. process <code>bam</code> and <code>wiggle</code> files to produce a small <code>seqz</code> file:</h5>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co">#PBS -N PBS_&lt;sample&gt;_seqz</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=1</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#PBS -l walltime=70:00:00</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="bu">source</span> activate python3</a>
<a class="sourceLine" id="cb14-9" data-line-number="9"></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="va">ref_file=</span>/public/home/liuxs/biodata/reference/genome/gdc_hg38/GRCh38.d1.vd1.fa</a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="va">gc_file=</span>/public/home/wangshx/wangshx/PRAD_Sig/hg38.gc50Base.wig.gz</a>
<a class="sourceLine" id="cb14-12" data-line-number="12"></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="va">out_dir=</span>/public/home/wangshx/wangshx/PRAD_Sig</a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="va">seqz_dir=$out_dir</span><span class="st">&quot;/seqz&quot;</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="va">sseqz_dir=$out_dir</span><span class="st">&quot;/small-seqz&quot;</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="fu">mkdir</span> -p <span class="va">$seqz_dir</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="fu">mkdir</span> -p <span class="va">$sseqz_dir</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#tumor=&lt;tumor&gt;</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#normal=&lt;normal&gt;</span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22"></a>
<a class="sourceLine" id="cb14-23" data-line-number="23"><span class="ex">sequenza-utils</span> bam2seqz -n <span class="op">&lt;</span>normal<span class="op">&gt;</span> -t <span class="op">&lt;</span>tumor<span class="op">&gt;</span> \</a>
<a class="sourceLine" id="cb14-24" data-line-number="24">    --fasta <span class="va">$ref_file</span> -gc <span class="va">$gc_file</span> \</a>
<a class="sourceLine" id="cb14-25" data-line-number="25">    -o <span class="va">$seqz_dir</span>/<span class="st">&quot;&lt;sample&gt;.seqz.gz&quot;</span></a>
<a class="sourceLine" id="cb14-26" data-line-number="26"></a>
<a class="sourceLine" id="cb14-27" data-line-number="27"><span class="ex">sequenza-utils</span> seqz_binning --seqz <span class="va">$seqz_dir</span>/<span class="st">&quot;&lt;sample&gt;.seqz.gz&quot;</span> \</a>
<a class="sourceLine" id="cb14-28" data-line-number="28">    -w 50 -o <span class="va">$sseqz_dir</span>/<span class="st">&quot;&lt;sample&gt;.small.seqz.gz&quot;</span></a>
<a class="sourceLine" id="cb14-29" data-line-number="29"></a>
<a class="sourceLine" id="cb14-30" data-line-number="30"><span class="co"># Only keep chr1-22,X,Y</span></a>
<a class="sourceLine" id="cb14-31" data-line-number="31"><span class="fu">zcat</span> <span class="va">$sseqz_dir</span>/<span class="st">&quot;&lt;sample&gt;.small.seqz.gz&quot;</span> <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb14-32" data-line-number="32">    <span class="fu">awk</span> <span class="st">&#39;/^chromosome|chr[12]?[0-9XY]\t/{print}&#39;</span> <span class="kw">|</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb14-33" data-line-number="33">    <span class="fu">gzip</span> <span class="op">&gt;</span> <span class="va">$sseqz_dir</span>/<span class="st">&quot;&lt;sample&gt;.small_filter.seqz.gz&quot;</span></a></code></pre></div>
</div>
<div id="call-copy-number-in-r" class="section level5">
<h5>3. call copy number in R</h5>
<p>This is a template R script used for copy number calling.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co">#! /usr/bin/env Rscript</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="kw">library</span>(<span class="st">&quot;sequenza&quot;</span>)</a>
<a class="sourceLine" id="cb15-4" data-line-number="4"></a>
<a class="sourceLine" id="cb15-5" data-line-number="5">args &lt;-<span class="st"> </span><span class="kw">commandArgs</span>(<span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">sample_id &lt;-<span class="st"> </span>args[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">input_file &lt;-<span class="st"> </span>args[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">out_dir &lt;-<span class="st"> </span>args[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb15-9" data-line-number="9"></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co"># https://github.com/ShixiangWang/copynumber</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11">test &lt;-<span class="st"> </span><span class="kw">sequenza.extract</span>(input_file, <span class="dt">assembly =</span> <span class="st">&quot;hg38&quot;</span>)</a>
<a class="sourceLine" id="cb15-12" data-line-number="12"></a>
<a class="sourceLine" id="cb15-13" data-line-number="13">CP &lt;-<span class="st"> </span><span class="kw">sequenza.fit</span>(test, <span class="dt">female =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb15-14" data-line-number="14"></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="kw">sequenza.results</span>(</a>
<a class="sourceLine" id="cb15-16" data-line-number="16">  <span class="dt">sequenza.extract =</span> test,</a>
<a class="sourceLine" id="cb15-17" data-line-number="17">  <span class="dt">cp.table =</span> CP,</a>
<a class="sourceLine" id="cb15-18" data-line-number="18">  <span class="dt">sample.id =</span> sample_id,</a>
<a class="sourceLine" id="cb15-19" data-line-number="19">  <span class="dt">out.dir =</span> out_dir,</a>
<a class="sourceLine" id="cb15-20" data-line-number="20">  <span class="dt">female =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb15-21" data-line-number="21">)</a></code></pre></div>
<p>This is a template PBS script used for calling the R script above.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co">#PBS -N PBS_&lt;sample&gt;_seqz</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=1</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">#PBS -l walltime=70:00:00</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="bu">source</span> activate R_36</a>
<a class="sourceLine" id="cb16-9" data-line-number="9"></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="va">out_dir=</span>/public/home/wangshx/wangshx/PRAD_Sig</a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="va">sseqz_dir=$out_dir</span><span class="st">&quot;/small-seqz&quot;</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="va">res_dir=$out_dir</span><span class="st">&quot;/seqz_wes_result&quot;</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="ex">Rscript</span> <span class="va">$out_dir</span><span class="st">&quot;/3-sequenza.R&quot;</span> <span class="op">&lt;</span>sample<span class="op">&gt;</span> <span class="va">$sseqz_dir</span>/<span class="st">&quot;&lt;sample&gt;.small_filter.seqz.gz&quot;</span> <span class="va">$res_dir</span></a></code></pre></div>
</div>
</div>
</div>
<div id="mutation-calling" class="section level3">
<h3>Mutation calling</h3>
<p>Somatic mutations were detected by following GATK best practice with Mutect2 <span class="citation">(Van der Auwera et al. <a href="#ref-van2013fastq">2013</a>)</span>.</p>
<div id="call-somatic-snvs-and-short-indels" class="section level4">
<h4>1. call somatic SNVs and short INDELs</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co">#PBS -N call-&lt;sample&gt;</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=7</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">#PBS -l walltime=30:00:00</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="va">gene=</span>/public/home/liuxs/biodata/reference/genome/gdc_hg38</a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="va">normal=</span>/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/bqsrbam</a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="va">tumor=</span>/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/bqsrbam</a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="va">path=</span>/public/home/liuxs/ncbi/dbGaP-21926/dnaseq/BQSR/bqsrbam</a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="va">ref=</span>/public/home/liuxs/biodata/reference/genome/hg38/test/ftp.broadinstitute.org/bundle/Mutect2</a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="va">out=</span>/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/vcf</a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="va">inter=</span>/public/home/liuxs/ncbi/dbGaP-16533/run/gatk/mutect</a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="va">out2=</span>/public/home/liuxs/ncbi/dbGaP-21926/dnaseq/BQSR/vcf</a>
<a class="sourceLine" id="cb17-17" data-line-number="17"><span class="va">name=</span><span class="op">&lt;</span><span class="ex">sample1</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18"><span class="kw">if</span><span class="bu"> [</span> <span class="ot">-e</span> /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/bqsrbam/<span class="va">$name</span>.sorted.marked.BQSR.bam<span class="bu"> ]</span>; </a>
<a class="sourceLine" id="cb17-19" data-line-number="19"><span class="kw">then</span> </a>
<a class="sourceLine" id="cb17-20" data-line-number="20"><span class="ex">gatk</span> --java-options <span class="st">&quot;-Xmx20G -Djava.io.tmpdir=/public/home/liuxs/lhm/tmp&quot;</span>  Mutect2 \</a>
<a class="sourceLine" id="cb17-21" data-line-number="21"> -R <span class="va">$gene</span>/GRCh38.d1.vd1.fa \</a>
<a class="sourceLine" id="cb17-22" data-line-number="22"> -L <span class="va">$inter</span>/Homo_sapiens_assembly38.targets.interval_list \</a>
<a class="sourceLine" id="cb17-23" data-line-number="23"> -I <span class="va">$tumor</span>/<span class="op">&lt;</span>sample1<span class="op">&gt;</span>.sorted.marked.BQSR.bam \</a>
<a class="sourceLine" id="cb17-24" data-line-number="24"> -tumor <span class="op">&lt;</span>sample1<span class="op">&gt;</span> \</a>
<a class="sourceLine" id="cb17-25" data-line-number="25"> -I <span class="va">$normal</span>/<span class="op">&lt;</span>sample2<span class="op">&gt;</span>.sorted.marked.BQSR.bam  \</a>
<a class="sourceLine" id="cb17-26" data-line-number="26"> -normal <span class="op">&lt;</span>sample2<span class="op">&gt;</span>\</a>
<a class="sourceLine" id="cb17-27" data-line-number="27"> --germline-resource <span class="va">$ref</span>/af-only-gnomad.hg38.vcf.gz \</a>
<a class="sourceLine" id="cb17-28" data-line-number="28"> --panel-of-normals /public/home/liuxs/biodata/reference/genome/hg38/test/mu_call_ref/ref/ref/test/1000g_pon.hg38.vcf.gz \</a>
<a class="sourceLine" id="cb17-29" data-line-number="29"> --af-of-alleles-not-in-resource 0.0000025 \</a>
<a class="sourceLine" id="cb17-30" data-line-number="30"> --disable-read-filter  MateOnSameContigOrNoMappedMateReadFilter \</a>
<a class="sourceLine" id="cb17-31" data-line-number="31"> --bam-output <span class="va">$out</span>/bam/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.bam \</a>
<a class="sourceLine" id="cb17-32" data-line-number="32"> --f1r2-tar-gz <span class="va">$out</span>/fir2/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.tar.gz \</a>
<a class="sourceLine" id="cb17-33" data-line-number="33"> -O <span class="va">$out</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.vcf</a>
<a class="sourceLine" id="cb17-34" data-line-number="34"><span class="kw">else</span></a>
<a class="sourceLine" id="cb17-35" data-line-number="35"><span class="ex">gatk</span> --java-options <span class="st">&quot;-Xmx20G -Djava.io.tmpdir=/public/home/liuxs/lhm/tmp&quot;</span>  Mutect2 \</a>
<a class="sourceLine" id="cb17-36" data-line-number="36">   -R <span class="va">$gene</span>/GRCh38.d1.vd1.fa \</a>
<a class="sourceLine" id="cb17-37" data-line-number="37">   -L <span class="va">$inter</span>/Homo_sapiens_assembly38.targets.interval_list \</a>
<a class="sourceLine" id="cb17-38" data-line-number="38">   -I <span class="va">$path</span>/<span class="op">&lt;</span>sample1<span class="op">&gt;</span>.sorted.marked.BQSR.bam \</a>
<a class="sourceLine" id="cb17-39" data-line-number="39">   -tumor <span class="op">&lt;</span>sample1<span class="op">&gt;</span> \</a>
<a class="sourceLine" id="cb17-40" data-line-number="40">   -I <span class="va">$path</span>/<span class="op">&lt;</span>sample2<span class="op">&gt;</span>.sorted.marked.BQSR.bam  \</a>
<a class="sourceLine" id="cb17-41" data-line-number="41">   -normal <span class="op">&lt;</span>sample2<span class="op">&gt;</span>\</a>
<a class="sourceLine" id="cb17-42" data-line-number="42">   --germline-resource <span class="va">$ref</span>/af-only-gnomad.hg38.vcf.gz \</a>
<a class="sourceLine" id="cb17-43" data-line-number="43">   --panel-of-normals /public/home/liuxs/biodata/reference/genome/hg38/test/mu_call_ref/ref/ref/test/1000g_pon.hg38.vcf.gz \</a>
<a class="sourceLine" id="cb17-44" data-line-number="44">   --af-of-alleles-not-in-resource 0.0000025 \</a>
<a class="sourceLine" id="cb17-45" data-line-number="45">   --disable-read-filter  MateOnSameContigOrNoMappedMateReadFilter \</a>
<a class="sourceLine" id="cb17-46" data-line-number="46">   --bam-output <span class="va">$out2</span>/bam/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.bam \</a>
<a class="sourceLine" id="cb17-47" data-line-number="47">   --f1r2-tar-gz <span class="va">$out2</span>/fir2/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.tar.gz \</a>
<a class="sourceLine" id="cb17-48" data-line-number="48">   -O <span class="va">$out2</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.vcf</a>
<a class="sourceLine" id="cb17-49" data-line-number="49"><span class="kw">fi</span></a></code></pre></div>
</div>
<div id="estimate-cross-sample-contamination-using-getpileupsummaries-and-calculatecontamination." class="section level4">
<h4>2. estimate cross-sample contamination using GetPileupSummaries and CalculateContamination.</h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co">#PBS -N getpile_normal_&lt;sample2&gt;</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=7</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#PBS -l walltime=30:00:00</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="va">bam=</span>/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/bqsrbam</a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="va">SNP=</span>/public/home/liuxs/biodata/reference/genome/hg38/test/ftp.broadinstitute.org/bundle/Mutect2</a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="va">out=</span>/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/vcf/piptable</a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="va">path=</span>/public/home/liuxs/ncbi/dbGaP-21926/dnaseq/BQSR/bqsrbam</a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="va">out2=</span>/public/home/liuxs/ncbi/dbGaP-21926/dnaseq/BQSR/vcf/piptable</a>
<a class="sourceLine" id="cb18-14" data-line-number="14"></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="ex">gatk</span> --java-options <span class="st">&quot;-Xmx20G -Djava.io.tmpdir=/public/home/wangshx/wx/tmp&quot;</span>  GetPileupSummaries \</a>
<a class="sourceLine" id="cb18-16" data-line-number="16">-I <span class="va">$bam</span>/<span class="op">&lt;</span>sample2<span class="op">&gt;</span>.sorted.marked.BQSR.bam \</a>
<a class="sourceLine" id="cb18-17" data-line-number="17">-L /public/home/liuxs/ncbi/dbGaP-16533/run/gatk/mutect/Homo_sapiens_assembly38.targets.interval_list \</a>
<a class="sourceLine" id="cb18-18" data-line-number="18">-V <span class="va">$SNP</span>/af-only-gnomad.hg38.vcf.gz \</a>
<a class="sourceLine" id="cb18-19" data-line-number="19">-O <span class="va">$out</span>/<span class="op">&lt;</span>sample2<span class="op">&gt;</span>-normal.pileups.table</a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co">#PBS -N seg_and_cont</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=7</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co">#PBS -l walltime=30:00:00</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb19-9" data-line-number="9"></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="va">input=</span>/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/vcf/piptable</a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="va">input2=</span>/public/home/liuxs/ncbi/dbGaP-21926/dnaseq/BQSR/vcf/piptable</a>
<a class="sourceLine" id="cb19-12" data-line-number="12"></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="va">name=</span><span class="op">&lt;</span><span class="ex">sample1</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="kw">if</span><span class="bu"> [</span> <span class="ot">-e</span> /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/vcf/piptable/<span class="va">$name</span>-tumor.pileups.table<span class="bu"> ]</span>; </a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="kw">then</span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="ex">gatk</span> --java-options <span class="st">&quot;-Xmx20G -Djava.io.tmpdir=/public/home/wangshx/wx/tmp&quot;</span>  CalculateContamination \</a>
<a class="sourceLine" id="cb19-17" data-line-number="17">-I <span class="va">$input</span>/<span class="op">&lt;</span>sample1<span class="op">&gt;</span>-tumor.pileups.table \</a>
<a class="sourceLine" id="cb19-18" data-line-number="18">-matched <span class="va">$input</span>/<span class="op">&lt;</span>sample2<span class="op">&gt;</span>-normal.pileups.table \</a>
<a class="sourceLine" id="cb19-19" data-line-number="19">-O <span class="va">$input</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>-contamination.table \</a>
<a class="sourceLine" id="cb19-20" data-line-number="20">-tumor-segmentation <span class="va">$input</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>-segments.table</a>
<a class="sourceLine" id="cb19-21" data-line-number="21"><span class="kw">else</span></a>
<a class="sourceLine" id="cb19-22" data-line-number="22"><span class="ex">gatk</span> --java-options <span class="st">&quot;-Xmx20G -Djava.io.tmpdir=/public/home/wangshx/wx/tmp&quot;</span>  CalculateContamination \</a>
<a class="sourceLine" id="cb19-23" data-line-number="23"> -I <span class="va">$input2</span>/<span class="op">&lt;</span>sample1<span class="op">&gt;</span>-tumor.pileups.table \</a>
<a class="sourceLine" id="cb19-24" data-line-number="24"> -matched <span class="va">$input2</span>/<span class="op">&lt;</span>sample2<span class="op">&gt;</span>-normal.pileups.table \</a>
<a class="sourceLine" id="cb19-25" data-line-number="25"> -O <span class="va">$input2</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>-contamination.table \</a>
<a class="sourceLine" id="cb19-26" data-line-number="26"> -tumor-segmentation <span class="va">$input2</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>-segments.table</a>
<a class="sourceLine" id="cb19-27" data-line-number="27"><span class="kw">fi</span></a></code></pre></div>
</div>
<div id="get-tumor-artifacts-using-learnreadorientationmodel." class="section level4">
<h4>3. get tumor artifacts using LearnReadOrientationModel.</h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co">#PBS -N flr_&lt;sample&gt;</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=7</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#PBS -l walltime=20:00:00</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="va">out=</span>/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/vcf/fir2</a>
<a class="sourceLine" id="cb20-10" data-line-number="10"></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="ex">java</span> -jar /public/home/liuxs/anaconda3/envs/wes/share/gatk4-4.1.3.0-0/gatk-package-4.1.3.0-local.jar  LearnReadOrientationModel \</a>
<a class="sourceLine" id="cb20-12" data-line-number="12">-I /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/vcf/fir2/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.tar.gz  \</a>
<a class="sourceLine" id="cb20-13" data-line-number="13">-O <span class="va">$out</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>-tumor-artifact-prior.tar.gz</a></code></pre></div>
</div>
<div id="keep-confident-somatic-calls-using-filtermutectcalls." class="section level4">
<h4>4. keep confident somatic calls using FilterMutectCalls.</h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co">#PBS -N filter-&lt;sample&gt;</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=4</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co">#PBS -l walltime=20:00:00</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="va">gene=</span>/public/home/liuxs/biodata/reference/genome/gdc_hg38</a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="va">out=</span>/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/vcf</a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="va">input=</span>/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/vcf/piptable</a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="va">fir2=</span>/public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/vcf/fir2</a>
<a class="sourceLine" id="cb21-13" data-line-number="13"></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="ex">gatk</span> --java-options <span class="st">&quot;-Xmx20G -Djava.io.tmpdir=/public/home/liuxs/lhm/tmp&quot;</span> FilterMutectCalls \</a>
<a class="sourceLine" id="cb21-16" data-line-number="16">-R <span class="va">$gene</span>/GRCh38.d1.vd1.fa \</a>
<a class="sourceLine" id="cb21-17" data-line-number="17">-V <span class="va">$out</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.vcf \</a>
<a class="sourceLine" id="cb21-18" data-line-number="18">-O /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/filter/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.filter.vcf \</a>
<a class="sourceLine" id="cb21-19" data-line-number="19">--tumor-segmentation <span class="va">$input</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>-segments.table \</a>
<a class="sourceLine" id="cb21-20" data-line-number="20">--contamination-table <span class="va">$input</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>-contamination.table \</a>
<a class="sourceLine" id="cb21-21" data-line-number="21">--ob-priors <span class="va">$fir2</span>/<span class="op">&lt;</span>sample<span class="op">&gt;</span>-tumor-artifact-prior.tar.gz \</a>
<a class="sourceLine" id="cb21-22" data-line-number="22">--min-allele-fraction 0.05</a></code></pre></div>
</div>
<div id="get-pass-labeled-mutation" class="section level4">
<h4>5. get PASS labeled mutation</h4>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co">#PBS -N call-&lt;sample&gt;</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=7</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">#PBS -l walltime=30:00:00</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="bu">source</span> activate wes</a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="ex">vcftools</span> --vcf /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/filter/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.filter.vcf\</a>
<a class="sourceLine" id="cb22-10" data-line-number="10">  --remove-filtered-all --recode --recode-INFO-all --out /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/PASS/<span class="op">&lt;</span>sample<span class="op">&gt;</span>-SNvs_only</a></code></pre></div>
</div>
<div id="annotate-mutations" class="section level4">
<h4>6. annotate mutations</h4>
<p>This step annotated somatic mutations with VEP <span class="citation">(McLaren et al. <a href="#ref-mclaren2016ensembl">2016</a>)</span>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co">#PBS -N annotate-&lt;sample&gt;</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=4</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#PBS -l walltime=20:00:00</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="bu">source</span> activate neo</a>
<a class="sourceLine" id="cb23-9" data-line-number="9"></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="ex">vep</span>  --input_file /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/PASS/<span class="op">&lt;</span>sample<span class="op">&gt;</span>-SNvs_only.recode.vcf \</a>
<a class="sourceLine" id="cb23-11" data-line-number="11">--output_file /public/home/liuxs/ncbi/dbGaP-16533/dnaseq/BQSR/annonate/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.anno.vcf \</a>
<a class="sourceLine" id="cb23-12" data-line-number="12">--symbol --term SO  --format vcf --vcf --cache --assembly GRCh38 --tsl \</a>
<a class="sourceLine" id="cb23-13" data-line-number="13">--hgvs --fasta ~/.vep/homo_sapiens/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz \</a>
<a class="sourceLine" id="cb23-14" data-line-number="14">--offline --cache --dir_cache ~/.vep/ \</a>
<a class="sourceLine" id="cb23-15" data-line-number="15">--transcript_version --cache_version 98 \</a>
<a class="sourceLine" id="cb23-16" data-line-number="16">--plugin Downstream  --plugin Wildtype \</a>
<a class="sourceLine" id="cb23-17" data-line-number="17">--dir_plugins ~/.vep/Plugins </a></code></pre></div>
</div>
<div id="convert-vcf-to-maf" class="section level4">
<h4>7. convert VCF to MAF</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co">#PBS -N call-&lt;sample&gt;</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">#PBS -l nodes=1:ppn=7</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">#PBS -l walltime=30:00:00</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">#PBS -S /bin/bash</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">#PBS -q normal_8</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">#PBS -j oe</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="bu">source</span> activate neo</a>
<a class="sourceLine" id="cb24-9" data-line-number="9"> <span class="ex">vcf2maf.pl</span> \</a>
<a class="sourceLine" id="cb24-10" data-line-number="10"> --input-vcf /public/home/liuxs/ncbi/dbGaP-16533/mutation/annonatevcf/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.anno.vcf \</a>
<a class="sourceLine" id="cb24-11" data-line-number="11"> --output-maf /public/home/liuxs/ncbi/dbGaP-16533/mutation/vcf2maf/<span class="op">&lt;</span>sample<span class="op">&gt;</span>.maf \</a>
<a class="sourceLine" id="cb24-12" data-line-number="12"> --ref-fasta /public/home/liuxs/biodata/reference/genome/gdc_hg38/GRCh38.d1.vd1.fa \</a>
<a class="sourceLine" id="cb24-13" data-line-number="13"> --tumor-id <span class="op">&lt;</span>sample1<span class="op">&gt;</span> --normal-id <span class="op">&lt;</span>sample2<span class="op">&gt;</span>  --vep-path /public/home/liuxs/anaconda3/envs/neo/bin \</a>
<a class="sourceLine" id="cb24-14" data-line-number="14"> --ncbi-build GRCh38</a></code></pre></div>
</div>
</div>
</div>
<div id="data-cleaning" class="section level2">
<h2>Data cleaning</h2>
<p>This section describes how we cleaned the data for downstream analysis.</p>
<div id="phenotype-data-1" class="section level3">
<h3>Phenotype data</h3>
<p>2 info tables of SRA runs downloaded from dbGap are stored in <a href="https://github.com/ShixiangWang/prad_signature/tree/master/dbGap">here</a>. Phenotype data of dbGap studies are stored in <a href="https://github.com/ShixiangWang/prad_signature/tree/master/dbGap/phenotype">here</a>. Phenotype data of some cohorts were also downloaded from original articles and cleaned by hand. We then carefully checked and compared all available data, extracted key info and generated tidy datasets including sample-pair data used for variation calling and phenotype data used for downstream analysis.</p>
<p>The whole procedure is recorded in <a href="https://github.com/ShixiangWang/prad_signature/blob/master/dbGap/01-tidy_mapping.R">01-tidy_mapping.R</a>, <a href="https://github.com/ShixiangWang/prad_signature/blob/master/dbGap/02-tidy_clinical_data.R">02-tidy_clinical_data.R</a> and <a href="https://github.com/ShixiangWang/prad_signature/blob/master/dbGap/03-combine_and_clean_IDs.R">03-combine_and_clean_IDs.R</a>.</p>
</div>
<div id="survival-data-1" class="section level3">
<h3>Survival data</h3>
<p>We merged two available clinical datasets from TCGA and <code>phs000554</code> with <a href="https://github.com/ShixiangWang/prad_signature/blob/master/analysis/src/01-prepare-survival-data.R">R script</a>.</p>
</div>
<div id="variation-profile" class="section level3">
<h3>Variation profile</h3>
<p><a href="#copy-number-calling">Copy number calling</a> and <a href="#mutation-calling">mutation calling</a> all generated per-sample results. We go further merged them into one file, respectively.</p>
<p>For results from Sequenza, we merged them with R script <a href="https://github.com/ShixiangWang/prad_signature/blob/master/analysis/src/00-generate-samplefile-for-seqz-cnv-calling.R">00-generate-samplefile-for-seqz-cnv-calling.R</a>.</p>
<p>For results from FACETS, we merged them with R script <a href="https://github.com/ShixiangWang/prad_signature/blob/master/analysis/src/00-generate-samplefile-for-facets-cnv-calling.R">00-generate-samplefile-for-facets-cnv-calling.R</a>.</p>
<p>For results from Mutect2, we merged VCFs into MAF with tool <a href="https://github.com/mskcc/vcf2maf">vcf2maf</a>. TODO: more detail code.</p>
</div>
</div>
</div>
<div id="signature-identification" class="section level1">
<h1>Signature Identification</h1>
<p>This part has been divided into 4 sections as the following, it describes how to get the genomic variation (or instability) signatures from mutation profile (including copy number profile and single base substitution (SBS) profile).</p>
<ul>
<li><a href="#tally-variation-records">Tally variation records</a></li>
<li><a href="#estimate-signature-number">Estimate signature number</a></li>
<li><a href="#extract-signatures">Extract signatures</a></li>
<li><a href="#show-signature-profile-and-aetiology">Show signature profile and aetiology</a></li>
</ul>
<p>All the processes have been implemented in R package <a href="https://github.com/ShixiangWang/sigminer"><strong>sigminer</strong></a>.</p>
<div id="tally-variation-records" class="section level2">
<h2>Tally variation records</h2>
<div id="methods" class="section level3">
<h3>Methods</h3>
<p>For SBS profile, same as previously reported <span class="citation">(Alexandrov et al. <a href="#ref-alexandrov2013signatures">2013</a>)</span>, for each sample, we firstly classified mutation records into six substitution subtypes: C&gt;A, C&gt;G, C&gt;T, T&gt;A, T&gt;C, and T&gt;G (all substitutions are referred to by the pyrimidine of the mutated Watson–Crick base pair). Further, each of the substitutions was examined by incorporating information on the bases immediately 5’ and 3’ to each mutated base generating 96 possible mutation types (6 types of substitution ∗ 4 types of 5’ base ∗ 4 types of 3’ base). Each of 96 mutation types is called <strong>component</strong> here.</p>
<p>For copy number profile, we firstly computed the genome-wide distributions of 8 fundamental copy number features for each sample:</p>
<ul>
<li>the breakpoint count per 10 Mb (named <strong>BP10MB</strong>)</li>
<li>the breakpoint count per chromosome arm (named <strong>BPArm</strong>)</li>
<li>the copy number of the segments (named <strong>CN</strong>)</li>
<li>the difference in copy number between adjacent segments (named <strong>CNCP</strong>)</li>
<li>the lengths of oscillating copy number segment chains (named <strong>OsCN</strong>)</li>
<li>the log10 based size of segments (named <strong>SS</strong>)</li>
<li>the minimal number of chromosome with 50% copy number variation (named <strong>NC50</strong>)</li>
<li>the burden of chromosome (named <strong>BoChr</strong>)</li>
</ul>
<p>These features were selected as hallmarks of previously reported genomic aberations like chromothripsis or to denote the distribution pattern of copy number events. The former 6 features have been used in <span class="citation">Macintyre et al. (<a href="#ref-macintyre2018copy">2018</a>)</span> to uncover the mutational processes in ovarian carcinoma.</p>
<p>Next, unlike <span class="citation">Macintyre et al. (<a href="#ref-macintyre2018copy">2018</a>)</span> applied mixture modeling to separate the first 6 copy number features distributions into mixtures of Poisson or Gaussian distributions, we directly classified 8 copy number features distributions into different components according to the comprehensive consideration of value range, abundance and biological significance. Most of the result are discrete values, and the others are range values.</p>
<p>The setting of 8 features with 80 components are shown as below.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">DT<span class="op">::</span><span class="kw">datatable</span>(sigminer<span class="op">::</span>CN.features)</a></code></pre></div>
<div id="htmlwidget-66b717d254d8c4cb5828" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-66b717d254d8c4cb5828">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80"],["BP10MB","BP10MB","BP10MB","BP10MB","BP10MB","BP10MB","BP10MB","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","CN","CN","CN","CN","CN","CN","CN","CNCP","CNCP","CNCP","CNCP","CNCP","CNCP","CNCP","OsCN","OsCN","OsCN","OsCN","OsCN","OsCN","OsCN","SS","SS","SS","SS","SS","SS","SS","SS","NC50","NC50","NC50","NC50","NC50","NC50","NC50","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr"],["BP10MB[0]","BP10MB[1]","BP10MB[2]","BP10MB[3]","BP10MB[4]","BP10MB[5]","BP10MB[&gt;5]","BPArm[0]","BPArm[1]","BPArm[2]","BPArm[3]","BPArm[4]","BPArm[5]","BPArm[6]","BPArm[7]","BPArm[8]","BPArm[9]","BPArm[10]","BPArm[&gt;10 &amp; &lt;=20]","BPArm[&gt;20 &amp; &lt;=30]","BPArm[&gt;30]","CN[0]","CN[1]","CN[2]","CN[3]","CN[4]","CN[&gt;4 &amp; &lt;=8]","CN[&gt;8]","CNCP[0]","CNCP[1]","CNCP[2]","CNCP[3]","CNCP[4]","CNCP[&gt;4 &amp; &lt;=8]","CNCP[&gt;8]","OsCN[0]","OsCN[1]","OsCN[2]","OsCN[3]","OsCN[4]","OsCN[&gt;4 &amp; &lt;=10]","OsCN[&gt;10]","SS[&lt;=2]","SS[&gt;2 &amp; &lt;=3]","SS[&gt;3 &amp; &lt;=4]","SS[&gt;4 &amp; &lt;=5]","SS[&gt;5 &amp; &lt;=6]","SS[&gt;6 &amp; &lt;=7]","SS[&gt;7 &amp; &lt;=8]","SS[&gt;8]","NC50[&lt;=2]","NC50[3]","NC50[4]","NC50[5]","NC50[6]","NC50[7]","NC50[&gt;7]","BoChr[1]","BoChr[2]","BoChr[3]","BoChr[4]","BoChr[5]","BoChr[6]","BoChr[7]","BoChr[8]","BoChr[9]","BoChr[10]","BoChr[11]","BoChr[12]","BoChr[13]","BoChr[14]","BoChr[15]","BoChr[16]","BoChr[17]","BoChr[18]","BoChr[19]","BoChr[20]","BoChr[21]","BoChr[22]","BoChr[23]"],["point","point","point","point","point","point","range","point","point","point","point","point","point","point","point","point","point","point","range","range","range","point","point","point","point","point","range","range","point","point","point","point","point","range","range","point","point","point","point","point","range","range","range","range","range","range","range","range","range","range","range","point","point","point","point","point","range","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point"],[0,1,2,3,4,5,5,0,1,2,3,4,5,6,7,8,9,10,10,20,30,0,1,2,3,4,4,8,0,1,2,3,4,4,8,0,1,2,3,4,4,10,null,2,3,4,5,6,7,8,null,3,4,5,6,7,7,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],[0,1,2,3,4,5,null,0,1,2,3,4,5,6,7,8,9,10,20,30,null,0,1,2,3,4,8,null,0,1,2,3,4,8,null,0,1,2,3,4,10,null,2,3,4,5,6,7,8,null,2,3,4,5,6,7,null,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>feature<\/th>\n      <th>component<\/th>\n      <th>label<\/th>\n      <th>min<\/th>\n      <th>max<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<blockquote>
<p>When component is a discrete value (label is ‘point’), min=max.</p>
<p>When component is a range value (label is ‘range’), the range is left open and right closed.</p>
<p>Of note, the blank in <code>min</code> column is <code>-Inf</code> and the blank in <code>max</code> column is <code>Inf</code>. <code>[23]</code> in <code>BoChr</code> represents chromosome X (chromosome Y is excluded).</p>
</blockquote>
<p>Compare to the method from <span class="citation">Macintyre et al. (<a href="#ref-macintyre2018copy">2018</a>)</span>, our method has several advantages:</p>
<ol style="list-style-type: decimal">
<li>the computation is more efficient.</li>
<li>the meaning of component is easier to read and understand.</li>
<li>the new features <strong>NC50</strong> and <strong>BoChr</strong> can be used to determine the distribution pattern of copy number events (global or local). and the contribution of each chromosome.</li>
<li>most importantly, the classification is fixed, so it is much easier to compare the signatures within/across tumor types, the results across different studies and the result signatures to reference signatures. In a word, our method constructs the standard to extract, study and compare copy number signatures.</li>
<li>our method is more extensible.</li>
</ol>
<p>I talk more about No.1-4 in an individual section (<a href="#method-comparison-between-macintyre-et-al-and-our-study">“Method comparison between Macintyre et al and our study”</a>), the No.5 will be described in <a href="">sigminer vignette</a>(<strong>TBD</strong>).</p>
<p>We will generate sample-by-component matrix using the methods above and treate the result as the input of nonnegative matrix decomposition (NMF) algorithm for extracting signatures.</p>
</div>
<div id="tally-records" class="section level3">
<h3>Tally records</h3>
<div id="copy-number" class="section level4">
<h4>Copy number</h4>
<p>Read absolute copy number profile as a <code>CopyNumber</code> object.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># Load packages -----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(sigminer))</a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(tidyverse))</a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(NMF))</a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co"># Set this per R session</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw">options</span>(<span class="dt">sigminer.sex =</span> <span class="st">&quot;male&quot;</span>, <span class="dt">sigminer.copynumber.max =</span> 20L)</a>
<a class="sourceLine" id="cb27-3" data-line-number="3"></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="co"># Generate CopyNumber object ----------------------------------------------</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"></a>
<a class="sourceLine" id="cb27-6" data-line-number="6">CNV.seqz &lt;-<span class="st"> </span><span class="kw">read_copynumber</span>(<span class="st">&quot;../data/CNV_from_sequenza.tsv&quot;</span>,</a>
<a class="sourceLine" id="cb27-7" data-line-number="7">  <span class="dt">genome_build =</span> <span class="st">&quot;hg38&quot;</span>,</a>
<a class="sourceLine" id="cb27-8" data-line-number="8">  <span class="dt">complement =</span> <span class="ot">FALSE</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb27-10" data-line-number="10"></a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="co"># remove WCMC160-SRR3146971 with only one CNV</span></a>
<a class="sourceLine" id="cb27-12" data-line-number="12">CNV.seqz &lt;-<span class="st"> </span><span class="kw">subset</span>(CNV.seqz, <span class="dt">subset =</span> <span class="op">!</span>sample <span class="op">%in%</span><span class="st"> &quot;WCMC160-SRR3146971&quot;</span>)</a>
<a class="sourceLine" id="cb27-13" data-line-number="13"><span class="kw">save</span>(CNV.seqz, <span class="dt">file =</span> <span class="st">&quot;../output/CNV.seqz.RData&quot;</span>)</a></code></pre></div>
<p>Tally the alteration records.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">ncores &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co"># Set a proper number of thread</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="co"># Use classfication method devised by me (&quot;W&quot;)</span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4">CNV.seqz.tally.W &lt;-<span class="st"> </span><span class="kw">sig_tally</span>(CNV.seqz, <span class="dt">method =</span> <span class="st">&quot;W&quot;</span>, <span class="dt">cores =</span> ncores, <span class="dt">feature_setting =</span> CN.features)</a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="kw">save</span>(CNV.seqz.tally.W, <span class="dt">file =</span> <span class="st">&quot;../output/CNV.seqz.tally.W.RData&quot;</span>)</a></code></pre></div>
</div>
<div id="sbs" class="section level4">
<h4>SBS</h4>
<p>Read SBS profile as a <code>MAF</code> object.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co"># Reading data ------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2">Maf &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">fread</span>(<span class="st">&quot;/public/data/maf/all.maf&quot;</span>)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="co"># Remove all NA columns</span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4">Maf &lt;-<span class="st"> </span>Maf[, <span class="kw">which</span>(<span class="kw">unlist</span>(<span class="kw">lapply</span>(Maf, <span class="cf">function</span>(x) <span class="op">!</span><span class="kw">all</span>(<span class="kw">is.na</span>(x))))), with =<span class="st"> </span>F]</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">Maf &lt;-<span class="st"> </span><span class="kw">read_maf</span>(Maf)</a>
<a class="sourceLine" id="cb29-6" data-line-number="6"><span class="kw">save</span>(Maf, <span class="dt">file =</span> <span class="st">&quot;../output/PRAD_TCGA_plus_dbGap_Maf.RData&quot;</span>)</a></code></pre></div>
<p>The result <code>MAF</code> object can be used in any analysis provided by R package <strong>maftools</strong> <span class="citation">(Mayakonda and Koeffler <a href="#ref-mayakonda2016maftools">2016</a>)</span>.</p>
<p>Tally the SBS records.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">Maf.tally &lt;-<span class="st"> </span><span class="kw">sig_tally</span>(Maf,</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">                       <span class="dt">cores =</span> ncores, <span class="dt">ref_genome =</span> <span class="st">&quot;BSgenome.Hsapiens.UCSC.hg38&quot;</span>,</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">                       <span class="dt">useSyn =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="kw">save</span>(Maf.tally, <span class="dt">file =</span> <span class="st">&quot;../output/PRAD_TCGA_plus_dbGap_Maf.tally.RData&quot;</span>)</a></code></pre></div>
</div>
</div>
</div>
<div id="estimate-signature-number" class="section level2">
<h2>Estimate signature number</h2>
<p>Here, r package <strong>NMF</strong> <span class="citation">(Gaujoux and Seoighe <a href="#ref-gaujoux2010flexible">2010</a>)</span> is used for running NMF algorithm Factorization rank <code>r</code> in NMF defines the number of signatures used to approximate the target sample-by-component matrix. A common way for deciding on <code>r</code> is to try different values, compute some quality measure of the results, and choose the best value according to this quality criteria.</p>
<p>As suggested, performing 30-50 runs is considered sufficient to get a robust estimation of the <code>r</code> value. Here we perform 50 runs.</p>
<div id="copy-number-1" class="section level3">
<h3>Copy number</h3>
<p>Estimate the number of copy number signature from 2 to 12.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">EST.seqz.W.all &lt;-<span class="st"> </span><span class="kw">sig_estimate</span>(CNV.seqz.tally.W<span class="op">$</span>nmf_matrix,</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">  <span class="dt">range =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">nrun =</span> <span class="dv">50</span>, <span class="dt">cores =</span> ncores, <span class="dt">use_random =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">  <span class="dt">save_plots =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">  <span class="dt">verbose =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb31-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb31-6" data-line-number="6"><span class="kw">save</span>(EST.seqz.W.all, <span class="dt">file =</span> <span class="st">&quot;../output/EST.seqz.W.all.RData&quot;</span>)</a></code></pre></div>
</div>
<div id="sbs-1" class="section level3">
<h3>SBS</h3>
<p>Estimate the number of SBS signature from 2 to 10.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="co"># Remove the effect of hyper mutated samples (not removing hyper-mutated samples)</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="co"># The idead is adopted from SignatureAnalyzer package</span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3">nmf_matrix &lt;-<span class="st"> </span><span class="kw">handle_hyper_mutation</span>(Maf.tally<span class="op">$</span>nmf_matrix)</a>
<a class="sourceLine" id="cb32-4" data-line-number="4"></a>
<a class="sourceLine" id="cb32-5" data-line-number="5">EST.Maf &lt;-<span class="st"> </span><span class="kw">sig_estimate</span>(nmf_matrix,</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">  <span class="dt">range =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">nrun =</span> <span class="dv">50</span>, <span class="dt">cores =</span> ncores, <span class="dt">use_random =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb32-7" data-line-number="7">  <span class="dt">save_plots =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb32-8" data-line-number="8">  <span class="dt">verbose =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb32-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb32-10" data-line-number="10"></a>
<a class="sourceLine" id="cb32-11" data-line-number="11"><span class="kw">save</span>(EST.Maf, <span class="dt">file =</span> <span class="st">&quot;../output/EST.PRAD_TCGA_plus_dbGap_Maf.RData&quot;</span>)</a>
<a class="sourceLine" id="cb32-12" data-line-number="12"><span class="kw">save</span>(nmf_matrix, <span class="dt">file =</span> <span class="st">&quot;../output/Maf_matrix.RData&quot;</span>)</a></code></pre></div>
</div>
<div id="result" class="section level3">
<h3>Result</h3>
<p>Let’s load the estimated results.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">load</span>(<span class="dt">file =</span> <span class="st">&quot;../output/EST.seqz.W.all.RData&quot;</span>)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="kw">load</span>(<span class="dt">file =</span> <span class="st">&quot;../output/EST.PRAD_TCGA_plus_dbGap_Maf.RData&quot;</span>)</a></code></pre></div>
<p>The most common approach is to use the cophenetic correlation coefficient. I show the measure vs. signature number as below.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">show_sig_number_survey</span>(EST.seqz.W.all, <span class="dt">right_y =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" width="2400" /></p>
<p>The best possible signature number value is the one at which the cophenetic correlation value on the y-axis drops significantly <span class="citation">(Gaujoux and Seoighe <a href="#ref-gaujoux2010flexible">2010</a>)</span>. Here we can take that the value <code>5</code> is the optimal signature number. For <code>3</code>, it is small to produce the result with biological significance due to the hugo contribution of CNV in prostate cancer; for <code>8</code>, it is a little bigger, so it may be not easy to understand the result considering currently we know few about the mechanism and consequence of copy number events.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">p =<span class="st"> </span><span class="kw">show_sig_number_survey</span>(EST.seqz.W.all, <span class="dt">right_y =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="kw">add_h_arrow</span>(p, <span class="dt">x =</span> <span class="fl">5.2</span>, <span class="dt">y =</span> <span class="fl">0.99</span>, <span class="dt">seg_len =</span> <span class="fl">0.5</span>, <span class="dt">space =</span> <span class="fl">0.2</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" width="1200" /></p>
<p>Next we take a look at SBS.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">p =<span class="st"> </span><span class="kw">show_sig_number_survey</span>(EST.Maf, <span class="dt">right_y =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="kw">add_h_arrow</span>(p, <span class="dt">x =</span> <span class="fl">3.2</span>, <span class="dt">y =</span> <span class="fl">0.982</span>, <span class="dt">seg_len =</span> <span class="fl">0.5</span>, <span class="dt">space =</span> <span class="fl">0.2</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" width="1200" /></p>
<p>For SBS, we select <code>3</code>. We have the knowledge that <code>3</code> mutational signatures from TCGA prostate cancers are recorded in COSMIC database (COSMIC 1, 5, 6), and the cophenetic has a sharp decrease after <code>3</code> indicating that substantially less stability is achieved using more than <code>3</code> clusters.</p>
</div>
</div>
<div id="extract-signatures" class="section level2">
<h2>Extract signatures</h2>
<p>Now that we have determined the signature number, we then extract the signatures with 50 runs.</p>
<p>Copy number:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co"># Extract signatures ------------------------------------------------------</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2">Sig.CNV.seqz.W &lt;-<span class="st"> </span><span class="kw">sig_extract</span>(CNV.seqz.tally.W<span class="op">$</span>nmf_matrix, <span class="dt">n_sig =</span> <span class="dv">5</span>, <span class="dt">nrun =</span> <span class="dv">50</span>, <span class="dt">cores =</span> ncores)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="kw">save</span>(Sig.CNV.seqz.W, <span class="dt">file =</span> <span class="st">&quot;../output/Sig.CNV.seqz.W.RData&quot;</span>)</a></code></pre></div>
<p>SBS:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co"># Extract signatures ------------------------------------------------------</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2">Sig.SNV &lt;-<span class="st"> </span><span class="kw">sig_extract</span>(nmf_matrix, <span class="dt">n_sig =</span> <span class="dv">3</span>, <span class="dt">nrun =</span> <span class="dv">50</span>, <span class="dt">cores =</span> ncores)</a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="kw">save</span>(Sig.SNV, <span class="dt">file =</span> <span class="st">&quot;../output/Sig.PRAD_TCGA_plus_dbGap_Maf.RData&quot;</span>)</a></code></pre></div>
</div>
<div id="show-signature-profile-and-aetiology" class="section level2">
<h2>Show signature profile and aetiology</h2>
<p>Now that we have the extracted signatures, we can show the signature profile.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">load</span>(<span class="st">&quot;../output/Sig.PRAD_TCGA_plus_dbGap_Maf.RData&quot;</span>)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="kw">load</span>(<span class="st">&quot;../output/Sig.CNV.seqz.W.RData&quot;</span>)</a></code></pre></div>
<div id="sbs-signature-profile" class="section level3">
<h3>SBS signature profile</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># I provide two style &#39;default&#39; and &#39;cosmic&#39; in sigminer</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="kw">show_sig_profile</span>(Sig.SNV, <span class="dt">mode =</span> <span class="st">&quot;SBS&quot;</span>, <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>, <span class="dt">x_label_angle =</span> <span class="dv">90</span>, <span class="dt">x_label_vjust =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" width="3000" /></p>
<blockquote>
<p>SBS signatures are displayed based on the observed component frequency of the human genome, i.e., representing the relative proportions of mutations generated by each signature based on the actual trinucleotide frequencies of the reference human genome.</p>
</blockquote>
<p>The aetiology of SBS signatures is more clear than the aetiology of copy number signatures. We can find aetiologies of the 3 signatures above by computing their cosine similarity to COSMIC reference signatures.</p>
<p>We compare the 3 signature to COSMIC signature database v2 and v3.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">sim_v2 =<span class="st"> </span><span class="kw">get_sig_similarity</span>(Sig.SNV, <span class="dt">sig_db =</span> <span class="st">&quot;legacy&quot;</span>)</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="co">#&gt; -Comparing against COSMIC signatures</span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="co">#&gt; ------------------------------------</span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4"><span class="co">#&gt; --Found Sig1 most similar to COSMIC_3</span></a>
<a class="sourceLine" id="cb41-5" data-line-number="5"><span class="co">#&gt;    Aetiology: defects in DNA-DSB repair by HR [similarity: 0.844]</span></a>
<a class="sourceLine" id="cb41-6" data-line-number="6"><span class="co">#&gt; --Found Sig2 most similar to COSMIC_15</span></a>
<a class="sourceLine" id="cb41-7" data-line-number="7"><span class="co">#&gt;    Aetiology: defective DNA mismatch repair [similarity: 0.943]</span></a>
<a class="sourceLine" id="cb41-8" data-line-number="8"><span class="co">#&gt; --Found Sig3 most similar to COSMIC_1</span></a>
<a class="sourceLine" id="cb41-9" data-line-number="9"><span class="co">#&gt;    Aetiology: spontaneous deamination of 5-methylcytosine [similarity: 0.935]</span></a>
<a class="sourceLine" id="cb41-10" data-line-number="10"><span class="co">#&gt; ------------------------------------</span></a>
<a class="sourceLine" id="cb41-11" data-line-number="11"><span class="co">#&gt; Return result invisiblely.</span></a></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">sim_v3 =<span class="st"> </span><span class="kw">get_sig_similarity</span>(Sig.SNV, <span class="dt">sig_db =</span> <span class="st">&quot;SBS&quot;</span>)</a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="co">#&gt; -Comparing against COSMIC signatures</span></a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="co">#&gt; ------------------------------------</span></a>
<a class="sourceLine" id="cb42-4" data-line-number="4"><span class="co">#&gt; --Found Sig1 most similar to SBS40</span></a>
<a class="sourceLine" id="cb42-5" data-line-number="5"><span class="co">#&gt;    Aetiology: Unknown [similarity: 0.883]</span></a>
<a class="sourceLine" id="cb42-6" data-line-number="6"><span class="co">#&gt; --Found Sig2 most similar to SBS15</span></a>
<a class="sourceLine" id="cb42-7" data-line-number="7"><span class="co">#&gt;    Aetiology: Defective DNA mismatch repair [similarity: 0.967]</span></a>
<a class="sourceLine" id="cb42-8" data-line-number="8"><span class="co">#&gt; --Found Sig3 most similar to SBS1</span></a>
<a class="sourceLine" id="cb42-9" data-line-number="9"><span class="co">#&gt;    Aetiology: spontaneous or enzymatic deamination of 5-methylcytosine [similarity: 0.966]</span></a>
<a class="sourceLine" id="cb42-10" data-line-number="10"><span class="co">#&gt; ------------------------------------</span></a>
<a class="sourceLine" id="cb42-11" data-line-number="11"><span class="co">#&gt; Return result invisiblely.</span></a></code></pre></div>
<p>From the results above, basically we can confirm that the aetiology of <code>Sig2</code> is <strong>dMMR</strong> (defects in mismatch repair) and the aetiology of <code>Sig3</code> is <strong>aging</strong>. The aetiology of <code>Sig1</code> may be <strong>HRD</strong> (Defective homologous recombination-based DNA damage repair) or an unknown reason.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">p =<span class="st"> </span><span class="kw">show_sig_profile</span>(Sig.SNV, <span class="dt">mode =</span> <span class="st">&quot;SBS&quot;</span>, <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>, <span class="dt">x_label_angle =</span> <span class="dv">90</span>, <span class="dt">x_label_vjust =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="kw">add_labels</span>(p, <span class="dt">x =</span> <span class="fl">0.92</span>, <span class="dt">y =</span> <span class="fl">0.3</span>, <span class="dt">y_end =</span> <span class="fl">0.85</span>, <span class="dt">n_label =</span> <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb43-3" data-line-number="3">           <span class="dt">labels =</span> <span class="kw">rev</span>(<span class="kw">c</span>(<span class="st">&quot;HRD or unknown&quot;</span>, <span class="st">&quot;dMMR&quot;</span>, <span class="st">&quot;Aging&quot;</span>)), <span class="dt">hjust =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" width="3000" /></p>
<p>The exposure of signatures in each sample is plotted as the below.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">show_sig_exposure</span>(Sig.SNV, <span class="dt">rm_space =</span> <span class="ot">TRUE</span>, <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" width="2400" /></p>
<p>Set a cutoff 2000 to remove some outliers.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw">show_sig_exposure</span>(Sig.SNV, </a>
<a class="sourceLine" id="cb45-2" data-line-number="2">                  <span class="dt">cutoff =</span> <span class="dv">2000</span>,</a>
<a class="sourceLine" id="cb45-3" data-line-number="3">                  <span class="dt">rm_space =</span> <span class="ot">TRUE</span>, <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" width="2400" /></p>
<blockquote>
<p>The <code>Est_Counts</code> panel shows the estimated SBS count.</p>
</blockquote>
<p>We can clearly see that</p>
<ul>
<li>most of samples have very few SBS signature exposures.</li>
<li><code>Sig1</code> and <code>Sig3</code> are the major resources.</li>
</ul>
</div>
<div id="copy-number-signature-profile" class="section level3">
<h3>Copy number signature profile</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">show_sig_profile</span>(Sig.CNV.seqz.W, <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;W&quot;</span>, <span class="dt">normalize =</span> <span class="st">&quot;feature&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" width="3600" /></p>
<blockquote>
<p>Similar to SBS signatures, copy number signatures are displayed based on the observed component frequency of the human genome. Of note, considering the count process of each feature is relatively independent, the profile is row normalized by each feature, unlike <span class="citation">Macintyre et al. (<a href="#ref-macintyre2018copy">2018</a>)</span> did column normalization (this method is easy to mislead readers), so the bar height can be compared within/between features.</p>
</blockquote>
<p>There is no reference database for copy number signatures, we cannot get aetiologies of the 5 signatures by similarity computation. By reading the description of previous reports <span class="citation">(Macintyre et al. <a href="#ref-macintyre2018copy">2018</a>; Yi and Ju <a href="#ref-yi2018patterns">2018</a>)</span> and studying the signature profile carefully, we determine or limite aetiologies of the 5 signatures with also the downstream analyses supported. Please see our manuscript (<strong>TODO</strong>) for details.</p>
<p>The exposure of signatures in each sample is plotted as the below.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">show_sig_exposure</span>(Sig.CNV.seqz.W, <span class="dt">rm_space =</span> <span class="ot">TRUE</span>, <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" width="2400" /></p>
<blockquote>
<p>The <code>Est_Counts</code> panel shows the estimated copy number segment count.</p>
</blockquote>
</div>
<div id="show-similarity-matrix" class="section level3">
<h3>Show similarity matrix</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">pheatmap<span class="op">::</span><span class="kw">pheatmap</span>(sim_v2<span class="op">$</span>similarity,</a>
<a class="sourceLine" id="cb48-2" data-line-number="2">  <span class="dt">cluster_rows =</span> F</a>
<a class="sourceLine" id="cb48-3" data-line-number="3">)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" width="3300" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">pheatmap<span class="op">::</span><span class="kw">pheatmap</span>(sim_v3<span class="op">$</span>similarity,</a>
<a class="sourceLine" id="cb49-2" data-line-number="2">  <span class="dt">cluster_rows =</span> F</a>
<a class="sourceLine" id="cb49-3" data-line-number="3">)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-33-1.png" width="4500" /></p>
</div>
<div id="check-the-signature-exposure" class="section level3">
<h3>Check the signature exposure</h3>
<p>Signature exposure is the estimation of mutation calling records. Here we check this by correlation analysis.</p>
<div id="mutation" class="section level4">
<h4>Mutation</h4>
<p>Observe total SBS mutations from data.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">load</span>(<span class="dt">file =</span> <span class="st">&quot;../output/PRAD_TCGA_plus_dbGap_Maf.RData&quot;</span>)</a>
<a class="sourceLine" id="cb50-2" data-line-number="2">Maf_dt =<span class="st"> </span><span class="kw">rbind</span>(Maf<span class="op">@</span>data, Maf<span class="op">@</span>maf.silent)</a>
<a class="sourceLine" id="cb50-3" data-line-number="3">Mut_dt =<span class="st"> </span>Maf_dt[Variant_Type <span class="op">==</span><span class="st"> &quot;SNP&quot;</span>, .(<span class="dt">Total =</span> .N), by =<span class="st"> </span>Tumor_Sample_Barcode]</a></code></pre></div>
<p>Estimate SBS mutations from signature exposure.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">Mut_expo =<span class="st"> </span><span class="kw">get_sig_exposure</span>(Sig.SNV)[, .(sample, <span class="dt">Est=</span>Sig1<span class="op">+</span>Sig2<span class="op">+</span>Sig3)]</a></code></pre></div>
<p>Merge the two <code>data.table</code> above.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">Mut_merged_dt =<span class="st"> </span><span class="kw">merge</span>(Mut_dt, Mut_expo, <span class="dt">by.x =</span> <span class="st">&quot;Tumor_Sample_Barcode&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;sample&quot;</span>)</a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="co"># log10 the data</span></a>
<a class="sourceLine" id="cb52-3" data-line-number="3">Mut_merged_dt[, <span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(<span class="dt">Total =</span> <span class="kw">log10</span>(Total), <span class="dt">Est =</span> <span class="kw">log10</span>(Est))]</a>
<a class="sourceLine" id="cb52-4" data-line-number="4"></a>
<a class="sourceLine" id="cb52-5" data-line-number="5"><span class="kw">head</span>(Mut_merged_dt)</a>
<a class="sourceLine" id="cb52-6" data-line-number="6"><span class="co">#&gt;    Tumor_Sample_Barcode     Total       Est</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7"><span class="co">#&gt; 1:           SRR2404024 1.6989700 1.6989700</span></a>
<a class="sourceLine" id="cb52-8" data-line-number="8"><span class="co">#&gt; 2:           SRR2404067 0.9542425 0.9542425</span></a>
<a class="sourceLine" id="cb52-9" data-line-number="9"><span class="co">#&gt; 3:           SRR2404095 1.9344985 1.9344984</span></a>
<a class="sourceLine" id="cb52-10" data-line-number="10"><span class="co">#&gt; 4:           SRR2404185 1.7708520 1.7708520</span></a>
<a class="sourceLine" id="cb52-11" data-line-number="11"><span class="co">#&gt; 5:           SRR2404230 1.8325089 1.8325089</span></a>
<a class="sourceLine" id="cb52-12" data-line-number="12"><span class="co">#&gt; 6:           SRR2404278 1.9777236 1.9777236</span></a></code></pre></div>
<p>Now we can see their correlation.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">ggpubr<span class="op">::</span><span class="kw">ggscatter</span>(Mut_merged_dt, <span class="dt">x =</span> <span class="st">&quot;Total&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Est&quot;</span>, <span class="dt">add =</span> <span class="st">&quot;reg.line&quot;</span>,</a>
<a class="sourceLine" id="cb53-2" data-line-number="2">                  <span class="dt">xlab =</span> <span class="st">&quot;Log10 based total SBS counts (observed)&quot;</span>,</a>
<a class="sourceLine" id="cb53-3" data-line-number="3">                  <span class="dt">ylab =</span> <span class="st">&quot;Log10 based total SBS counts (estimated)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb53-4" data-line-number="4"><span class="st">  </span>ggpubr<span class="op">::</span><span class="kw">stat_cor</span>(<span class="dt">label.x.npc =</span> <span class="fl">0.5</span>, <span class="dt">label.y.npc =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" width="2400" /></p>
<p>We can know that we did a perfect NMF for SBS data.</p>
</div>
<div id="copy-number-2" class="section level4">
<h4>Copy number</h4>
<p>Observe total segment counts from copy number data.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">load</span>(<span class="dt">file =</span> <span class="st">&quot;../output/CNV.seqz.RData&quot;</span>)</a>
<a class="sourceLine" id="cb54-2" data-line-number="2">CN_dt =<span class="st"> </span>CNV.seqz<span class="op">@</span>data[, .(<span class="dt">Total =</span> .N), by =<span class="st"> </span>sample]</a></code></pre></div>
<p>Estimate segment counts from signature exposure.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">CN_expo =<span class="st"> </span><span class="kw">get_sig_exposure</span>(Sig.CNV.seqz.W)[, .(sample, <span class="dt">Est=</span>Sig1<span class="op">+</span>Sig2<span class="op">+</span>Sig3<span class="op">+</span>Sig4<span class="op">+</span>Sig5)]</a></code></pre></div>
<p>Merge the two <code>data.table</code> above.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1">CN_merged_dt =<span class="st"> </span><span class="kw">merge</span>(CN_dt, CN_expo, <span class="dt">by =</span> <span class="st">&quot;sample&quot;</span>)</a>
<a class="sourceLine" id="cb56-2" data-line-number="2"></a>
<a class="sourceLine" id="cb56-3" data-line-number="3"><span class="kw">head</span>(CN_merged_dt)</a>
<a class="sourceLine" id="cb56-4" data-line-number="4"><span class="co">#&gt;                 sample Total      Est</span></a>
<a class="sourceLine" id="cb56-5" data-line-number="5"><span class="co">#&gt; 1: 00-000450-SRR474658    58 61.71629</span></a>
<a class="sourceLine" id="cb56-6" data-line-number="6"><span class="co">#&gt; 2:   00-1165-SRR461844    51 51.71139</span></a>
<a class="sourceLine" id="cb56-7" data-line-number="7"><span class="co">#&gt; 3:    00-160-SRR471373    65 68.69707</span></a>
<a class="sourceLine" id="cb56-8" data-line-number="8"><span class="co">#&gt; 4:   00-1823-SRR471613    75 79.23348</span></a>
<a class="sourceLine" id="cb56-9" data-line-number="9"><span class="co">#&gt; 5:   01-1934-SRR471793    80 84.30801</span></a>
<a class="sourceLine" id="cb56-10" data-line-number="10"><span class="co">#&gt; 6:   01-2382-SRR471433    51 54.44634</span></a></code></pre></div>
<p>Now we can see their correlation.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">ggpubr<span class="op">::</span><span class="kw">ggscatter</span>(CN_merged_dt, <span class="dt">x =</span> <span class="st">&quot;Total&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Est&quot;</span>, <span class="dt">add =</span> <span class="st">&quot;reg.line&quot;</span>,</a>
<a class="sourceLine" id="cb57-2" data-line-number="2">                  <span class="dt">xlab =</span> <span class="st">&quot;Log10 based total segment counts (observed)&quot;</span>,</a>
<a class="sourceLine" id="cb57-3" data-line-number="3">                  <span class="dt">ylab =</span> <span class="st">&quot;Log10 based total segment counts (estimated)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-4" data-line-number="4"><span class="st">  </span>ggpubr<span class="op">::</span><span class="kw">stat_cor</span>(<span class="dt">label.x.npc =</span> <span class="fl">0.5</span>, <span class="dt">label.y.npc =</span> <span class="fl">0.8</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-41-1.png" width="2400" /></p>
<p>We can see that the estimation of copy number segment count fits observed data well. The residue can be further visualized by histgram.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">CN_merged_dt[, Residue<span class="op">:</span><span class="er">=</span>Est<span class="op">-</span>Total]</a></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb59-2" data-line-number="2"><span class="kw">ggplot</span>(CN_merged_dt) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Residue))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-43-1.png" width="2400" /></p>
<hr />
</div>
</div>
</div>
</div>
<div id="association-analysis" class="section level1">
<h1>Association Analysis</h1>
<p>This part has been divided into 2 sections: data integration and association analysis.</p>
<div id="data-integration" class="section level2">
<h2>Data integration</h2>
<p>In this section, I integrate all genotype/phenotype data as a tidy data table used for downstream analyses.</p>
<p>Load packages and prepared data.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="co"># Integrate all informaiton to sample level</span></a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb60-3" data-line-number="3"><span class="kw">library</span>(sigminer)</a>
<a class="sourceLine" id="cb60-4" data-line-number="4"><span class="kw">library</span>(maftools)</a>
<a class="sourceLine" id="cb60-5" data-line-number="5"></a>
<a class="sourceLine" id="cb60-6" data-line-number="6"><span class="co"># Loading clinical related data -------------------------------------------</span></a>
<a class="sourceLine" id="cb60-7" data-line-number="7"></a>
<a class="sourceLine" id="cb60-8" data-line-number="8">Info &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;../data/PRAD_CLINICAL.rds&quot;</span>)</a>
<a class="sourceLine" id="cb60-9" data-line-number="9"><span class="co"># Purity and ploidy info from sequenza</span></a>
<a class="sourceLine" id="cb60-10" data-line-number="10">PurityInfo &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(<span class="st">&quot;../data/PRAD_Purity_and_Ploidy_Sequenza.tsv&quot;</span>)</a>
<a class="sourceLine" id="cb60-11" data-line-number="11"></a>
<a class="sourceLine" id="cb60-12" data-line-number="12"><span class="co"># Processing CNV data -----------------------------------------------------</span></a>
<a class="sourceLine" id="cb60-13" data-line-number="13"></a>
<a class="sourceLine" id="cb60-14" data-line-number="14"><span class="kw">load</span>(<span class="st">&quot;../output/CNV.seqz.RData&quot;</span>)</a>
<a class="sourceLine" id="cb60-15" data-line-number="15"><span class="kw">load</span>(<span class="st">&quot;../output/Sig.CNV.seqz.W.RData&quot;</span>)</a>
<a class="sourceLine" id="cb60-16" data-line-number="16">CNV &lt;-<span class="st"> </span>CNV.seqz</a>
<a class="sourceLine" id="cb60-17" data-line-number="17">Sig.CNV &lt;-<span class="st"> </span>Sig.CNV.seqz.W</a>
<a class="sourceLine" id="cb60-18" data-line-number="18"><span class="kw">rm</span>(Sig.CNV.seqz.W, CNV.seqz)</a></code></pre></div>
<p>After running NMF, we can get robust clusters from consensus matrix, more see <code>?NMF::predict</code>.</p>
<p>I also create functions <code>get_sig_exposure()</code> to get the absolute/relative exposure of signatures and <code>scoring()</code> to get scores of typical copy number features. More run <code>?sigminer::get_sig_exposure</code> and <code>?sigminer::scoring</code> in your R console or see the package manual.</p>
<blockquote>
<p>Relative exposure is more useful for clustering and absolute exposure is more useful for association analysis.</p>
</blockquote>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="co"># CNV</span></a>
<a class="sourceLine" id="cb61-2" data-line-number="2">CNVGroupInfo &lt;-<span class="st"> </span><span class="kw">get_groups</span>(Sig.CNV, <span class="dt">method =</span> <span class="st">&quot;consensus&quot;</span>, <span class="dt">match_consensus =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb61-3" data-line-number="3"><span class="co">#&gt; =&gt; Obtaining clusters from the hierarchical clustering of the consensus matrix...</span></a>
<a class="sourceLine" id="cb61-4" data-line-number="4"><span class="co">#&gt; =&gt; Finding the dominant signature of each group...</span></a>
<a class="sourceLine" id="cb61-5" data-line-number="5"><span class="co">#&gt; =&gt; Generating a table of group and dominant signature:</span></a>
<a class="sourceLine" id="cb61-6" data-line-number="6"><span class="co">#&gt;    </span></a>
<a class="sourceLine" id="cb61-7" data-line-number="7"><span class="co">#&gt;     Sig1 Sig2 Sig3 Sig4 Sig5</span></a>
<a class="sourceLine" id="cb61-8" data-line-number="8"><span class="co">#&gt;   1    9    2   14   10    0</span></a>
<a class="sourceLine" id="cb61-9" data-line-number="9"><span class="co">#&gt;   2    0   60    0    3    0</span></a>
<a class="sourceLine" id="cb61-10" data-line-number="10"><span class="co">#&gt;   3    0    3  219    2    0</span></a>
<a class="sourceLine" id="cb61-11" data-line-number="11"><span class="co">#&gt;   4    0    0    0  170    0</span></a>
<a class="sourceLine" id="cb61-12" data-line-number="12"><span class="co">#&gt;   5    0    3   35  200  207</span></a>
<a class="sourceLine" id="cb61-13" data-line-number="13"><span class="co">#&gt; =&gt; Assigning a group to a signature with the maxium fraction (stored in &#39;map_table&#39; attr)...</span></a>
<a class="sourceLine" id="cb61-14" data-line-number="14"><span class="co">#&gt; =&gt; Summarizing...</span></a>
<a class="sourceLine" id="cb61-15" data-line-number="15"><span class="co">#&gt;  group #1: 35 samples with Sig3 enriched.</span></a>
<a class="sourceLine" id="cb61-16" data-line-number="16"><span class="co">#&gt;  group #2: 63 samples with Sig2 enriched.</span></a>
<a class="sourceLine" id="cb61-17" data-line-number="17"><span class="co">#&gt;  group #3: 224 samples with Sig3 enriched.</span></a>
<a class="sourceLine" id="cb61-18" data-line-number="18"><span class="co">#&gt;  group #4: 170 samples with Sig4 enriched.</span></a>
<a class="sourceLine" id="cb61-19" data-line-number="19"><span class="co">#&gt;  group #5: 445 samples with Sig5 enriched.</span></a>
<a class="sourceLine" id="cb61-20" data-line-number="20">CNVInfo &lt;-<span class="st"> </span>CNV<span class="op">@</span>summary.per.sample</a>
<a class="sourceLine" id="cb61-21" data-line-number="21">CNVExposureInfo &lt;-<span class="st"> </span><span class="kw">get_sig_exposure</span>(Sig.CNV)</a>
<a class="sourceLine" id="cb61-22" data-line-number="22">CNVscores &lt;-<span class="st"> </span><span class="kw">scoring</span>(CNV)</a></code></pre></div>
<p>We find that the group <code>1</code> is assigned to <code>Sig3</code> due to sample with <code>Sig3</code> dominant has the maximum fraction in group <code>1</code>. However, group <code>1</code> is the only group with <code>Sig1</code> enriched. So we modify this result.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">CNVGroupInfo<span class="op">$</span>enrich_sig[CNVGroupInfo<span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;1&quot;</span>] =<span class="st"> &quot;Sig1&quot;</span></a></code></pre></div>
<p>Next, we process mutation data to get TMB, driver info, clusters, and etc (detail of some step has been described in <a href="https://github.com/ShixiangWang/prad_signature/blob/master/analysis/src/03-data-integration-updates.R">R script</a> of the repo).</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="co"># Processing mutation data ------------------------------------------------</span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2"></a>
<a class="sourceLine" id="cb63-3" data-line-number="3"><span class="kw">load</span>(<span class="dt">file =</span> <span class="st">&quot;../output/PRAD_TCGA_plus_dbGap_Maf.RData&quot;</span>)</a>
<a class="sourceLine" id="cb63-4" data-line-number="4"><span class="kw">load</span>(<span class="dt">file =</span> <span class="st">&quot;../output/Sig.PRAD_TCGA_plus_dbGap_Maf.RData&quot;</span>)</a>
<a class="sourceLine" id="cb63-5" data-line-number="5"></a>
<a class="sourceLine" id="cb63-6" data-line-number="6">Maf_samp =<span class="st"> </span>data.table<span class="op">::</span><span class="kw">data.table</span>(</a>
<a class="sourceLine" id="cb63-7" data-line-number="7">  <span class="dt">Tumor_Sample_Barcode =</span> <span class="kw">unique</span>(<span class="kw">rbind</span>(Maf<span class="op">@</span>data, Maf<span class="op">@</span>maf.silent)<span class="op">$</span>Tumor_Sample_Barcode)</a>
<a class="sourceLine" id="cb63-8" data-line-number="8">)</a>
<a class="sourceLine" id="cb63-9" data-line-number="9"></a>
<a class="sourceLine" id="cb63-10" data-line-number="10">TMBInfo &lt;-<span class="st"> </span>Maf<span class="op">@</span>variant.type.summary</a>
<a class="sourceLine" id="cb63-11" data-line-number="11">TMBInfo<span class="op">$</span>n_INDEL =<span class="st"> </span>TMBInfo<span class="op">$</span>DEL <span class="op">+</span><span class="st"> </span>TMBInfo<span class="op">$</span>INS</a>
<a class="sourceLine" id="cb63-12" data-line-number="12">TMBInfo =<span class="st"> </span>TMBInfo[, .(Tumor_Sample_Barcode, n_INDEL, SNP)]</a>
<a class="sourceLine" id="cb63-13" data-line-number="13"><span class="kw">colnames</span>(TMBInfo)[<span class="dv">3</span>] =<span class="st"> &quot;n_SNV&quot;</span></a>
<a class="sourceLine" id="cb63-14" data-line-number="14">TMBInfo =<span class="st"> </span><span class="kw">merge</span>(Maf_samp, TMBInfo, <span class="dt">by =</span> <span class="st">&quot;Tumor_Sample_Barcode&quot;</span>, <span class="dt">all =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb63-15" data-line-number="15"><span class="co"># Fill NAs</span></a>
<a class="sourceLine" id="cb63-16" data-line-number="16">TMBInfo =<span class="st"> </span>TMBInfo <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-17" data-line-number="17"><span class="st">  </span>dtplyr<span class="op">::</span><span class="kw">lazy_dt</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-18" data-line-number="18"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(dplyr<span class="op">::</span><span class="kw">starts_with</span>(<span class="st">&quot;n_&quot;</span>)), <span class="op">~</span><span class="kw">ifelse</span>(<span class="kw">is.na</span>(.), <span class="dv">0</span>, .)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-19" data-line-number="19"><span class="st">  </span>data.table<span class="op">::</span><span class="kw">as.data.table</span>()</a>
<a class="sourceLine" id="cb63-20" data-line-number="20"></a>
<a class="sourceLine" id="cb63-21" data-line-number="21"><span class="kw">load</span>(<span class="dt">file =</span> <span class="st">&quot;../output/PRAD_driver_info.RData&quot;</span>)</a>
<a class="sourceLine" id="cb63-22" data-line-number="22"><span class="kw">load</span>(<span class="dt">file =</span> <span class="st">&quot;../output/PRAD_heter_info.RData&quot;</span>)</a>
<a class="sourceLine" id="cb63-23" data-line-number="23"></a>
<a class="sourceLine" id="cb63-24" data-line-number="24">SNVGroupInfo &lt;-<span class="st"> </span><span class="kw">get_groups</span>(Sig.SNV, <span class="dt">method =</span> <span class="st">&quot;consensus&quot;</span>, <span class="dt">match_consensus =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb63-25" data-line-number="25"><span class="co">#&gt; =&gt; Obtaining clusters from the hierarchical clustering of the consensus matrix...</span></a>
<a class="sourceLine" id="cb63-26" data-line-number="26"><span class="co">#&gt; =&gt; Finding the dominant signature of each group...</span></a>
<a class="sourceLine" id="cb63-27" data-line-number="27"><span class="co">#&gt; =&gt; Generating a table of group and dominant signature:</span></a>
<a class="sourceLine" id="cb63-28" data-line-number="28"><span class="co">#&gt;    </span></a>
<a class="sourceLine" id="cb63-29" data-line-number="29"><span class="co">#&gt;     Sig1 Sig2 Sig3</span></a>
<a class="sourceLine" id="cb63-30" data-line-number="30"><span class="co">#&gt;   1   16   34   21</span></a>
<a class="sourceLine" id="cb63-31" data-line-number="31"><span class="co">#&gt;   2   30    0  193</span></a>
<a class="sourceLine" id="cb63-32" data-line-number="32"><span class="co">#&gt;   3  677    0    0</span></a>
<a class="sourceLine" id="cb63-33" data-line-number="33"><span class="co">#&gt; =&gt; Assigning a group to a signature with the maxium fraction (stored in &#39;map_table&#39; attr)...</span></a>
<a class="sourceLine" id="cb63-34" data-line-number="34"><span class="co">#&gt; =&gt; Summarizing...</span></a>
<a class="sourceLine" id="cb63-35" data-line-number="35"><span class="co">#&gt;  group #1: 71 samples with Sig2 enriched.</span></a>
<a class="sourceLine" id="cb63-36" data-line-number="36"><span class="co">#&gt;  group #2: 223 samples with Sig3 enriched.</span></a>
<a class="sourceLine" id="cb63-37" data-line-number="37"><span class="co">#&gt;  group #3: 677 samples with Sig1 enriched.</span></a>
<a class="sourceLine" id="cb63-38" data-line-number="38">SNVExposureInfo &lt;-<span class="st"> </span><span class="kw">get_sig_exposure</span>(Sig.SNV)</a>
<a class="sourceLine" id="cb63-39" data-line-number="39"></a>
<a class="sourceLine" id="cb63-40" data-line-number="40"><span class="co"># Processing gene and pathway mutation ------------------------------------</span></a>
<a class="sourceLine" id="cb63-41" data-line-number="41"></a>
<a class="sourceLine" id="cb63-42" data-line-number="42"><span class="kw">load</span>(<span class="dt">file =</span> <span class="st">&quot;../output/PRAD_gene_and_pathway_mutation.RData&quot;</span>)</a></code></pre></div>
<p>Next, we keep keys of all <code>data.frame</code>s are same and merge them into one.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="co"># Merge data --------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb64-2" data-line-number="2">Info &lt;-<span class="st"> </span>Info <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb64-4" data-line-number="4">    <span class="dt">CNV_ID =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb64-5" data-line-number="5">      <span class="op">!</span><span class="kw">startsWith</span>(tumor_Run, <span class="st">&quot;TCGA&quot;</span>) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(tumor_Run) <span class="op">~</span><span class="st"> </span><span class="kw">paste</span>(subject_id, tumor_Run, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>),</a>
<a class="sourceLine" id="cb64-6" data-line-number="6">      <span class="kw">startsWith</span>(tumor_Run, <span class="st">&quot;TCGA&quot;</span>) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(tumor_Run) <span class="op">~</span><span class="st"> </span>tumor_Run,</a>
<a class="sourceLine" id="cb64-7" data-line-number="7">      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="ot">NA_character_</span></a>
<a class="sourceLine" id="cb64-8" data-line-number="8">    )</a>
<a class="sourceLine" id="cb64-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb64-10" data-line-number="10"></a>
<a class="sourceLine" id="cb64-11" data-line-number="11">PurityInfo</a>
<a class="sourceLine" id="cb64-12" data-line-number="12"><span class="co">#&gt; # A tibble: 938 x 3</span></a>
<a class="sourceLine" id="cb64-13" data-line-number="13"><span class="co">#&gt;    purity ploidy sample             </span></a>
<a class="sourceLine" id="cb64-14" data-line-number="14"><span class="co">#&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;              </span></a>
<a class="sourceLine" id="cb64-15" data-line-number="15"><span class="co">#&gt;  1   0.59    1.9 00-000450-SRR474658</span></a>
<a class="sourceLine" id="cb64-16" data-line-number="16"><span class="co">#&gt;  2   0.55    1.9 00-1165-SRR461844  </span></a>
<a class="sourceLine" id="cb64-17" data-line-number="17"><span class="co">#&gt;  3   0.75    1.9 00-160-SRR471373   </span></a>
<a class="sourceLine" id="cb64-18" data-line-number="18"><span class="co">#&gt;  4   0.72    2   00-1823-SRR471613  </span></a>
<a class="sourceLine" id="cb64-19" data-line-number="19"><span class="co">#&gt;  5   0.73    2   01-1934-SRR471793  </span></a>
<a class="sourceLine" id="cb64-20" data-line-number="20"><span class="co">#&gt;  6   0.4     1.9 01-2382-SRR471433  </span></a>
<a class="sourceLine" id="cb64-21" data-line-number="21"><span class="co">#&gt;  7   0.45    4.1 01-2492-SRR471733  </span></a>
<a class="sourceLine" id="cb64-22" data-line-number="22"><span class="co">#&gt;  8   0.73    2   01-2554-SRR471673  </span></a>
<a class="sourceLine" id="cb64-23" data-line-number="23"><span class="co">#&gt;  9   0.22    3.4 01-28-SRR471073    </span></a>
<a class="sourceLine" id="cb64-24" data-line-number="24"><span class="co">#&gt; 10   0.35    2   02-1082-SRR472616  </span></a>
<a class="sourceLine" id="cb64-25" data-line-number="25"><span class="co">#&gt; # … with 928 more rows</span></a>
<a class="sourceLine" id="cb64-26" data-line-number="26"><span class="kw">colnames</span>(CNVGroupInfo) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;cnv_group&quot;</span>, <span class="st">&quot;cnv_weight&quot;</span>, <span class="st">&quot;cnv_enrich_sig&quot;</span>)</a>
<a class="sourceLine" id="cb64-27" data-line-number="27">CNVInfo</a>
<a class="sourceLine" id="cb64-28" data-line-number="28"><span class="co">#&gt;                  sample n_of_cnv n_of_amp n_of_del n_of_vchr cna_burden</span></a>
<a class="sourceLine" id="cb64-29" data-line-number="29"><span class="co">#&gt;   1:    TCGA-HI-7169-01        2        2        0         0      0.000</span></a>
<a class="sourceLine" id="cb64-30" data-line-number="30"><span class="co">#&gt;   2:    TCGA-CH-5743-01        3        2        1         1      0.000</span></a>
<a class="sourceLine" id="cb64-31" data-line-number="31"><span class="co">#&gt;   3:    TCGA-EJ-7791-01        3        3        0         1      0.000</span></a>
<a class="sourceLine" id="cb64-32" data-line-number="32"><span class="co">#&gt;   4:    TCGA-FC-A66V-01        3        3        0         1      0.000</span></a>
<a class="sourceLine" id="cb64-33" data-line-number="33"><span class="co">#&gt;   5:    TCGA-J4-AATV-01        3        3        0         0      0.000</span></a>
<a class="sourceLine" id="cb64-34" data-line-number="34"><span class="co">#&gt;  ---                                                                   </span></a>
<a class="sourceLine" id="cb64-35" data-line-number="35"><span class="co">#&gt; 933: 5115609-SRR8311697      303      291       12        22      0.856</span></a>
<a class="sourceLine" id="cb64-36" data-line-number="36"><span class="co">#&gt; 934: 5115412-SRR8311627      356      354        2        22      0.948</span></a>
<a class="sourceLine" id="cb64-37" data-line-number="37"><span class="co">#&gt; 935: 5115406-SRR8312068      367      337       30        22      0.297</span></a>
<a class="sourceLine" id="cb64-38" data-line-number="38"><span class="co">#&gt; 936:      36-SRR5876749      393      392        1        22      0.926</span></a>
<a class="sourceLine" id="cb64-39" data-line-number="39"><span class="co">#&gt; 937: 5115615-SRR8311749      420      406       14        22      0.360</span></a>
<a class="sourceLine" id="cb64-40" data-line-number="40"></a>
<a class="sourceLine" id="cb64-41" data-line-number="41"><span class="kw">colnames</span>(CNVExposureInfo) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="kw">paste0</span>(<span class="st">&quot;CN-&quot;</span>, <span class="kw">colnames</span>(CNVExposureInfo)[<span class="op">-</span><span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb64-42" data-line-number="42"><span class="kw">colnames</span>(TMBInfo)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;sample&quot;</span></a>
<a class="sourceLine" id="cb64-43" data-line-number="43">TMBInfo[, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.character</span>(sample)][, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">startsWith</span>(sample, <span class="st">&quot;TCGA&quot;</span>),</a>
<a class="sourceLine" id="cb64-44" data-line-number="44">                                                             <span class="kw">substr</span>(sample, <span class="dv">1</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb64-45" data-line-number="45">                                                             sample</a>
<a class="sourceLine" id="cb64-46" data-line-number="46">)]</a>
<a class="sourceLine" id="cb64-47" data-line-number="47"></a>
<a class="sourceLine" id="cb64-48" data-line-number="48"><span class="kw">colnames</span>(DriverDF)[<span class="dv">1</span>] =<span class="st"> &quot;sample&quot;</span></a>
<a class="sourceLine" id="cb64-49" data-line-number="49">DriverDF[, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.character</span>(sample)][, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">startsWith</span>(sample, <span class="st">&quot;TCGA&quot;</span>),</a>
<a class="sourceLine" id="cb64-50" data-line-number="50">                                                              <span class="kw">substr</span>(sample, <span class="dv">1</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb64-51" data-line-number="51">                                                              sample</a>
<a class="sourceLine" id="cb64-52" data-line-number="52">)]</a>
<a class="sourceLine" id="cb64-53" data-line-number="53"><span class="kw">colnames</span>(SNVGroupInfo) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;snv_group&quot;</span>, <span class="st">&quot;snv_weight&quot;</span>, <span class="st">&quot;snv_enrich_sig&quot;</span>)</a>
<a class="sourceLine" id="cb64-54" data-line-number="54">SNVGroupInfo[, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.character</span>(sample)][, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">startsWith</span>(sample, <span class="st">&quot;TCGA&quot;</span>),</a>
<a class="sourceLine" id="cb64-55" data-line-number="55">                                                                  <span class="kw">substr</span>(sample, <span class="dv">1</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb64-56" data-line-number="56">                                                                  sample</a>
<a class="sourceLine" id="cb64-57" data-line-number="57">)]</a>
<a class="sourceLine" id="cb64-58" data-line-number="58"><span class="kw">colnames</span>(SNVExposureInfo) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="kw">paste0</span>(<span class="st">&quot;SBS-&quot;</span>, <span class="kw">colnames</span>(SNVExposureInfo)[<span class="op">-</span><span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb64-59" data-line-number="59">SNVExposureInfo[, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.character</span>(sample)][, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">startsWith</span>(sample, <span class="st">&quot;TCGA&quot;</span>),</a>
<a class="sourceLine" id="cb64-60" data-line-number="60">                                                                     <span class="kw">substr</span>(sample, <span class="dv">1</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb64-61" data-line-number="61">                                                                     sample</a>
<a class="sourceLine" id="cb64-62" data-line-number="62">)]</a>
<a class="sourceLine" id="cb64-63" data-line-number="63"><span class="kw">colnames</span>(TitvInfo) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;Ti_fraction&quot;</span>, <span class="st">&quot;Tv_fraction&quot;</span>)</a>
<a class="sourceLine" id="cb64-64" data-line-number="64">TitvInfo[, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.character</span>(sample)][, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">startsWith</span>(sample, <span class="st">&quot;TCGA&quot;</span>),</a>
<a class="sourceLine" id="cb64-65" data-line-number="65">                                                              <span class="kw">substr</span>(sample, <span class="dv">1</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb64-66" data-line-number="66">                                                              sample</a>
<a class="sourceLine" id="cb64-67" data-line-number="67">)]</a>
<a class="sourceLine" id="cb64-68" data-line-number="68"><span class="kw">colnames</span>(MathDF) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;MATH&quot;</span>)</a>
<a class="sourceLine" id="cb64-69" data-line-number="69">MathDF[, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.character</span>(sample)][, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">startsWith</span>(sample, <span class="st">&quot;TCGA&quot;</span>),</a>
<a class="sourceLine" id="cb64-70" data-line-number="70">                                                            <span class="kw">substr</span>(sample, <span class="dv">1</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb64-71" data-line-number="71">                                                            sample</a>
<a class="sourceLine" id="cb64-72" data-line-number="72">)]</a>
<a class="sourceLine" id="cb64-73" data-line-number="73"><span class="kw">colnames</span>(ClusterDF) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;n_mutation_cluster&quot;</span>)</a>
<a class="sourceLine" id="cb64-74" data-line-number="74">ClusterDF[, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.character</span>(sample)][, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">startsWith</span>(sample, <span class="st">&quot;TCGA&quot;</span>),</a>
<a class="sourceLine" id="cb64-75" data-line-number="75">                                                               <span class="kw">substr</span>(sample, <span class="dv">1</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb64-76" data-line-number="76">                                                               sample</a>
<a class="sourceLine" id="cb64-77" data-line-number="77">)]</a>
<a class="sourceLine" id="cb64-78" data-line-number="78"></a>
<a class="sourceLine" id="cb64-79" data-line-number="79"><span class="co"># data.table::setDT(summary_mutation)</span></a>
<a class="sourceLine" id="cb64-80" data-line-number="80"><span class="co"># data.table::setDT(summary_pathway)</span></a>
<a class="sourceLine" id="cb64-81" data-line-number="81"></a>
<a class="sourceLine" id="cb64-82" data-line-number="82"><span class="kw">colnames</span>(summary_mutation)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;sample&quot;</span></a>
<a class="sourceLine" id="cb64-83" data-line-number="83"><span class="kw">colnames</span>(summary_pathway)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;sample&quot;</span></a>
<a class="sourceLine" id="cb64-84" data-line-number="84">summary_mutation[, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.character</span>(sample)][, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">startsWith</span>(sample, <span class="st">&quot;TCGA&quot;</span>),</a>
<a class="sourceLine" id="cb64-85" data-line-number="85">                                                                      <span class="kw">substr</span>(sample, <span class="dv">1</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb64-86" data-line-number="86">                                                                      sample</a>
<a class="sourceLine" id="cb64-87" data-line-number="87">)]</a>
<a class="sourceLine" id="cb64-88" data-line-number="88">summary_pathway[, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.character</span>(sample)][, sample <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">startsWith</span>(sample, <span class="st">&quot;TCGA&quot;</span>),</a>
<a class="sourceLine" id="cb64-89" data-line-number="89">                                                                     <span class="kw">substr</span>(sample, <span class="dv">1</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb64-90" data-line-number="90">                                                                     sample</a>
<a class="sourceLine" id="cb64-91" data-line-number="91">)]</a>
<a class="sourceLine" id="cb64-92" data-line-number="92"></a>
<a class="sourceLine" id="cb64-93" data-line-number="93"></a>
<a class="sourceLine" id="cb64-94" data-line-number="94"><span class="kw">colnames</span>(CNVInfo)[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;n_CNV&quot;</span>, <span class="st">&quot;n_Amp&quot;</span>, <span class="st">&quot;n_Del&quot;</span>)</a>
<a class="sourceLine" id="cb64-95" data-line-number="95"></a>
<a class="sourceLine" id="cb64-96" data-line-number="96">MergeInfo &lt;-<span class="st"> </span>Info[<span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(Info<span class="op">$</span>tumor_Run)), ] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-97" data-line-number="97"><span class="st">  </span><span class="kw">left_join</span>(CNVInfo[, .(sample, n_CNV, n_Amp, n_Del)], <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;CNV_ID&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-98" data-line-number="98"><span class="st">  </span><span class="kw">left_join</span>(CNVscores, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;CNV_ID&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-99" data-line-number="99"><span class="st">  </span><span class="kw">left_join</span>(CNVGroupInfo, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;CNV_ID&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-100" data-line-number="100"><span class="st">  </span><span class="kw">left_join</span>(CNVExposureInfo, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;CNV_ID&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-101" data-line-number="101"><span class="st">  </span><span class="kw">left_join</span>(PurityInfo, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;CNV_ID&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-102" data-line-number="102"><span class="st">  </span><span class="kw">left_join</span>(summary_mutation, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;tumor_Run&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-103" data-line-number="103"><span class="st">  </span><span class="kw">left_join</span>(summary_pathway, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;tumor_Run&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-104" data-line-number="104"><span class="st">  </span><span class="kw">left_join</span>(TMBInfo, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;tumor_Run&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-105" data-line-number="105"><span class="st">  </span><span class="kw">left_join</span>(DriverDF, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;tumor_Run&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-106" data-line-number="106"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb64-107" data-line-number="107">    <span class="dt">n_driver =</span> <span class="kw">ifelse</span>(<span class="op">!</span><span class="kw">is.na</span>(n_driver), n_driver, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb64-108" data-line-number="108">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-109" data-line-number="109"><span class="st">  </span><span class="kw">left_join</span>(TitvInfo, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;tumor_Run&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-110" data-line-number="110"><span class="st">  </span><span class="kw">left_join</span>(MathDF, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;tumor_Run&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-111" data-line-number="111"><span class="st">  </span><span class="kw">left_join</span>(ClusterDF, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;tumor_Run&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-112" data-line-number="112"><span class="st">  </span><span class="kw">left_join</span>(SNVGroupInfo, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;tumor_Run&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-113" data-line-number="113"><span class="st">  </span><span class="kw">left_join</span>(SNVExposureInfo, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;tumor_Run&quot;</span> =<span class="st"> &quot;sample&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-114" data-line-number="114"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb64-115" data-line-number="115">    <span class="dt">Stage =</span> <span class="kw">factor</span>(Stage, <span class="dt">ordered =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb64-116" data-line-number="116">    <span class="dt">Fusion =</span> <span class="kw">ifelse</span>(Fusion <span class="op">==</span><span class="st"> &quot;Negative&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>),</a>
<a class="sourceLine" id="cb64-117" data-line-number="117">    <span class="dt">sample_type =</span> <span class="kw">ifelse</span>(sample_type <span class="op">==</span><span class="st"> &quot;Unknown&quot;</span>, <span class="st">&quot;Metastatic&quot;</span>, sample_type), <span class="co"># phs000909 are metastatic samples, https://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi?study_id=phs000909.v1.p1</span></a>
<a class="sourceLine" id="cb64-118" data-line-number="118">    <span class="dt">HasFusion =</span> Fusion,</a>
<a class="sourceLine" id="cb64-119" data-line-number="119">    <span class="dt">HasFusion =</span> <span class="kw">ifelse</span>(HasFusion <span class="op">==</span><span class="st"> &quot;Yes&quot;</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb64-120" data-line-number="120">    <span class="dt">IsMetastatic =</span> <span class="kw">ifelse</span>(sample_type <span class="op">==</span><span class="st"> &quot;Metastatic&quot;</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb64-121" data-line-number="121">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-122" data-line-number="122"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>sTDP, <span class="op">-</span>lTDP)</a>
<a class="sourceLine" id="cb64-123" data-line-number="123"></a>
<a class="sourceLine" id="cb64-124" data-line-number="124"></a>
<a class="sourceLine" id="cb64-125" data-line-number="125"><span class="kw">saveRDS</span>(MergeInfo, <span class="dt">file =</span> <span class="st">&quot;../output/PRAD_Merge_Info_CNV_from_sequenza_update.RDS&quot;</span>)</a></code></pre></div>
</div>
<div id="association-analysis-1" class="section level2">
<h2>Association analysis</h2>
<p>Now we do association analysis between signatures (via exposure) and genotypes/phenotypes.</p>
<div id="prepare" class="section level3">
<h3>Prepare</h3>
<p>Load packages.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb65-2" data-line-number="2"><span class="kw">library</span>(sigminer)</a></code></pre></div>
<p>Load the data.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">df.seqz =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;../output/PRAD_Merge_Info_CNV_from_sequenza_update.RDS&quot;</span>)</a></code></pre></div>
<p>Set the coloumns used for analysis.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="kw">colnames</span>(df.seqz)[<span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">23</span><span class="op">:</span><span class="dv">26</span>)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;MACN score&quot;</span>, <span class="st">&quot;TD score&quot;</span>, <span class="st">&quot;sTD score&quot;</span>, <span class="st">&quot;lTD score&quot;</span>, <span class="st">&quot;Chromothripisis score&quot;</span>)</a>
<a class="sourceLine" id="cb67-2" data-line-number="2"></a>
<a class="sourceLine" id="cb67-3" data-line-number="3"><span class="co"># Just use ploidy from sequenza</span></a>
<a class="sourceLine" id="cb67-4" data-line-number="4">df.seqz<span class="op">$</span>Ploidy =<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb67-5" data-line-number="5"></a>
<a class="sourceLine" id="cb67-6" data-line-number="6"><span class="co"># Merge BRCA1 and BRCA2</span></a>
<a class="sourceLine" id="cb67-7" data-line-number="7">df.seqz[[<span class="st">&quot;BRCA1/2&quot;</span>]] =<span class="st"> </span>df.seqz<span class="op">$</span>BRCA1 <span class="op">|</span><span class="st"> </span>df.seqz<span class="op">$</span>BRCA2</a>
<a class="sourceLine" id="cb67-8" data-line-number="8"><span class="co"># Merge PIK3CA and PIK3CB</span></a>
<a class="sourceLine" id="cb67-9" data-line-number="9">df.seqz[[<span class="st">&quot;PIK3CA/B&quot;</span>]] =<span class="st"> </span>df.seqz<span class="op">$</span>PIK3CA <span class="op">|</span><span class="st"> </span>df.seqz<span class="op">$</span>PIK3CB</a>
<a class="sourceLine" id="cb67-10" data-line-number="10"></a>
<a class="sourceLine" id="cb67-11" data-line-number="11"><span class="co"># Output for reporting as supp table</span></a>
<a class="sourceLine" id="cb67-12" data-line-number="12">openxlsx<span class="op">::</span><span class="kw">write.xlsx</span>(df.seqz, <span class="dt">file =</span> <span class="st">&quot;../output/supp_sample_table.xlsx&quot;</span>)</a>
<a class="sourceLine" id="cb67-13" data-line-number="13"><span class="co"># Save for futher use</span></a>
<a class="sourceLine" id="cb67-14" data-line-number="14"><span class="kw">saveRDS</span>(df.seqz, <span class="dt">file =</span> <span class="st">&quot;../output/df.seqz.RDS&quot;</span>)</a>
<a class="sourceLine" id="cb67-15" data-line-number="15"></a>
<a class="sourceLine" id="cb67-16" data-line-number="16">cols_to_sigs.seqz &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;CN-Sig&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>), <span class="kw">paste0</span>(<span class="st">&quot;SBS-Sig&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb67-17" data-line-number="17"><span class="co"># genes</span></a>
<a class="sourceLine" id="cb67-18" data-line-number="18">cols_to_mutated_genes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">colnames</span>(df.seqz)[<span class="kw">c</span>(<span class="dv">38</span><span class="op">:</span><span class="dv">41</span>, <span class="dv">44</span><span class="op">:</span><span class="dv">54</span>)], <span class="st">&quot;BRCA1/2&quot;</span>, <span class="st">&quot;PIK3CA/B&quot;</span>)</a>
<a class="sourceLine" id="cb67-19" data-line-number="19"><span class="co"># pathways</span></a>
<a class="sourceLine" id="cb67-20" data-line-number="20">cols_to_mutated_pathways &lt;-<span class="st"> </span><span class="kw">colnames</span>(df.seqz)[<span class="dv">55</span><span class="op">:</span><span class="dv">66</span>]</a>
<a class="sourceLine" id="cb67-21" data-line-number="21"></a>
<a class="sourceLine" id="cb67-22" data-line-number="22"><span class="co"># Exclude PSA</span></a>
<a class="sourceLine" id="cb67-23" data-line-number="23">cols_to_features &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb67-24" data-line-number="24">  <span class="st">&quot;IsMetastatic&quot;</span>, <span class="st">&quot;HasFusion&quot;</span>,</a>
<a class="sourceLine" id="cb67-25" data-line-number="25">  <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Stage&quot;</span>, <span class="st">&quot;GleasonScore&quot;</span>,</a>
<a class="sourceLine" id="cb67-26" data-line-number="26">  <span class="st">&quot;n_SNV&quot;</span>, <span class="st">&quot;n_driver&quot;</span>, <span class="st">&quot;n_INDEL&quot;</span>, <span class="st">&quot;Ti_fraction&quot;</span>, <span class="st">&quot;Tv_fraction&quot;</span>,</a>
<a class="sourceLine" id="cb67-27" data-line-number="27">  <span class="st">&quot;cnaBurden&quot;</span>, <span class="st">&quot;n_CNV&quot;</span>, <span class="st">&quot;n_Amp&quot;</span>, <span class="st">&quot;n_Del&quot;</span>, <span class="st">&quot;ploidy&quot;</span>,</a>
<a class="sourceLine" id="cb67-28" data-line-number="28">  <span class="st">&quot;TD score&quot;</span>, </a>
<a class="sourceLine" id="cb67-29" data-line-number="29">  <span class="co"># &quot;sTD score&quot;, &quot;lTD score&quot;, </span></a>
<a class="sourceLine" id="cb67-30" data-line-number="30">  <span class="st">&quot;Chromothripisis score&quot;</span>, <span class="st">&quot;MACN score&quot;</span>,</a>
<a class="sourceLine" id="cb67-31" data-line-number="31">  <span class="st">&quot;MATH&quot;</span>, <span class="st">&quot;n_mutation_cluster&quot;</span>, <span class="st">&quot;purity&quot;</span></a>
<a class="sourceLine" id="cb67-32" data-line-number="32">)</a>
<a class="sourceLine" id="cb67-33" data-line-number="33"></a>
<a class="sourceLine" id="cb67-34" data-line-number="34">feature_type &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;ca&quot;</span>, 2L), <span class="kw">rep</span>(<span class="st">&quot;co&quot;</span>, <span class="kw">length</span>(cols_to_features) <span class="op">-</span><span class="st"> </span>2L))</a></code></pre></div>
</div>
<div id="signatures-features" class="section level3">
<h3>Signatures &amp; features</h3>
<p>Analyze the association between signatures and features.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1">tidy_data.seqz.feature &lt;-<span class="st"> </span><span class="kw">get_sig_feature_association</span>(df.seqz,</a>
<a class="sourceLine" id="cb68-2" data-line-number="2">                                                      <span class="dt">cols_to_sigs =</span> cols_to_sigs.seqz,</a>
<a class="sourceLine" id="cb68-3" data-line-number="3">                                                      <span class="dt">cols_to_features =</span> cols_to_features,</a>
<a class="sourceLine" id="cb68-4" data-line-number="4">                                                      <span class="dt">method_co =</span> <span class="st">&quot;pearson&quot;</span>,</a>
<a class="sourceLine" id="cb68-5" data-line-number="5">                                                      <span class="dt">type =</span> feature_type, </a>
<a class="sourceLine" id="cb68-6" data-line-number="6">                                                      <span class="dt">min_n =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb68-7" data-line-number="7">                                                      <span class="dt">verbose =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb68-8" data-line-number="8"><span class="st">  </span><span class="kw">get_tidy_association</span>(<span class="dt">p_adjust =</span> <span class="ot">TRUE</span>)  <span class="co"># adjust p value with FDR</span></a>
<a class="sourceLine" id="cb68-9" data-line-number="9"><span class="co">#&gt; -&gt; Detecting and transforming possibly ordinal variables...</span></a>
<a class="sourceLine" id="cb68-10" data-line-number="10"><span class="co">#&gt; -&gt; Calculating correlations for continuous variables using pearson...</span></a>
<a class="sourceLine" id="cb68-11" data-line-number="11"><span class="co">#&gt; -&gt; Calculating correlations for categorical variables using wilcox.test...</span></a>
<a class="sourceLine" id="cb68-12" data-line-number="12"><span class="co">#&gt; --&gt; building test models, be patient...</span></a>
<a class="sourceLine" id="cb68-13" data-line-number="13"><span class="co">#&gt; --&gt; done</span></a>
<a class="sourceLine" id="cb68-14" data-line-number="14"><span class="co">#&gt; --&gt; obtaining model results...</span></a>
<a class="sourceLine" id="cb68-15" data-line-number="15"><span class="co">#&gt; --&gt; done</span></a>
<a class="sourceLine" id="cb68-16" data-line-number="16"><span class="co">#&gt; --&gt; collecting data...</span></a>
<a class="sourceLine" id="cb68-17" data-line-number="17"><span class="co">#&gt; --&gt; done</span></a>
<a class="sourceLine" id="cb68-18" data-line-number="18"><span class="co">#&gt; -&gt; Done</span></a></code></pre></div>
<blockquote>
<p>Association of signature exposures with other features was performed using one of two procedures: for a continuous association variable (including ordinal variable), pearson correaltion was performed; for a binary association variable, samples were divided into two groups and Mann-Whitney U-test was performed to test for differences in signature exposure medians between the two groups.</p>
</blockquote>
<p>Show the result.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw">show_sig_feature_corrplot</span>(tidy_data.seqz.feature, <span class="dt">p_val =</span> <span class="fl">0.05</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-54-1.png" width="2700" /></p>
<blockquote>
<p>All shown circles are statistically significant results (FDR &lt; 0.05). A feature will be chopped off from the plot if has no correlation with any signatures. Same for the similar plots below.</p>
</blockquote>
<p>The result table:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">DT<span class="op">::</span><span class="kw">datatable</span>(tidy_data.seqz.feature)</a></code></pre></div>
<div id="htmlwidget-be641c58e929442cdb60" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-be641c58e929442cdb60">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232"],["CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","CN-Sig1","CN-Sig1","CN-Sig2","CN-Sig2","CN-Sig3","CN-Sig3","CN-Sig4","CN-Sig4","CN-Sig5","CN-Sig5","SBS-Sig1","SBS-Sig1","SBS-Sig2","SBS-Sig2","SBS-Sig3","SBS-Sig3"],["Age","Chromothripisis score","CN-Sig1","CN-Sig2","CN-Sig3","CN-Sig4","CN-Sig5","cnaBurden","GleasonScore","MACN score","MATH","n_Amp","n_CNV","n_Del","n_driver","n_INDEL","n_mutation_cluster","n_SNV","ploidy","purity","SBS-Sig1","SBS-Sig2","SBS-Sig3","Stage","TD score","Ti_fraction","Tv_fraction","Age","Chromothripisis score","CN-Sig1","CN-Sig2","CN-Sig3","CN-Sig4","CN-Sig5","cnaBurden","GleasonScore","MACN score","MATH","n_Amp","n_CNV","n_Del","n_driver","n_INDEL","n_mutation_cluster","n_SNV","ploidy","purity","SBS-Sig1","SBS-Sig2","SBS-Sig3","Stage","TD score","Ti_fraction","Tv_fraction","Age","Chromothripisis score","CN-Sig1","CN-Sig2","CN-Sig3","CN-Sig4","CN-Sig5","cnaBurden","GleasonScore","MACN score","MATH","n_Amp","n_CNV","n_Del","n_driver","n_INDEL","n_mutation_cluster","n_SNV","ploidy","purity","SBS-Sig1","SBS-Sig2","SBS-Sig3","Stage","TD score","Ti_fraction","Tv_fraction","Age","Chromothripisis score","CN-Sig1","CN-Sig2","CN-Sig3","CN-Sig4","CN-Sig5","cnaBurden","GleasonScore","MACN score","MATH","n_Amp","n_CNV","n_Del","n_driver","n_INDEL","n_mutation_cluster","n_SNV","ploidy","purity","SBS-Sig1","SBS-Sig2","SBS-Sig3","Stage","TD score","Ti_fraction","Tv_fraction","Age","Chromothripisis score","CN-Sig1","CN-Sig2","CN-Sig3","CN-Sig4","CN-Sig5","cnaBurden","GleasonScore","MACN score","MATH","n_Amp","n_CNV","n_Del","n_driver","n_INDEL","n_mutation_cluster","n_SNV","ploidy","purity","SBS-Sig1","SBS-Sig2","SBS-Sig3","Stage","TD score","Ti_fraction","Tv_fraction","Age","Chromothripisis score","CN-Sig1","CN-Sig2","CN-Sig3","CN-Sig4","CN-Sig5","cnaBurden","GleasonScore","MACN score","MATH","n_Amp","n_CNV","n_Del","n_driver","n_INDEL","n_mutation_cluster","n_SNV","ploidy","purity","SBS-Sig1","SBS-Sig2","SBS-Sig3","Stage","TD score","Ti_fraction","Tv_fraction","Age","Chromothripisis score","CN-Sig1","CN-Sig2","CN-Sig3","CN-Sig4","CN-Sig5","cnaBurden","GleasonScore","MACN score","MATH","n_Amp","n_CNV","n_Del","n_driver","n_INDEL","n_mutation_cluster","n_SNV","ploidy","purity","SBS-Sig1","SBS-Sig2","SBS-Sig3","Stage","TD score","Ti_fraction","Tv_fraction","Age","Chromothripisis score","CN-Sig1","CN-Sig2","CN-Sig3","CN-Sig4","CN-Sig5","cnaBurden","GleasonScore","MACN score","MATH","n_Amp","n_CNV","n_Del","n_driver","n_INDEL","n_mutation_cluster","n_SNV","ploidy","purity","SBS-Sig1","SBS-Sig2","SBS-Sig3","Stage","TD score","Ti_fraction","Tv_fraction","HasFusion","IsMetastatic","HasFusion","IsMetastatic","HasFusion","IsMetastatic","HasFusion","IsMetastatic","HasFusion","IsMetastatic","HasFusion","IsMetastatic","HasFusion","IsMetastatic","HasFusion","IsMetastatic"],[807,937,937,937,937,937,937,937,621,934,929,937,937,937,937,929,929,929,937,937,925,925,925,576,937,925,925,807,937,937,937,937,937,937,937,621,934,929,937,937,937,937,929,929,929,937,937,925,925,925,576,937,925,925,807,937,937,937,937,937,937,937,621,934,929,937,937,937,937,929,929,929,937,937,925,925,925,576,937,925,925,807,937,937,937,937,937,937,937,621,934,929,937,937,937,937,929,929,929,937,937,925,925,925,576,937,925,925,807,937,937,937,937,937,937,937,621,934,929,937,937,937,937,929,929,929,937,937,925,925,925,576,937,925,925,797,925,925,925,925,925,925,925,616,922,971,925,925,925,971,971,971,971,926,926,971,971,971,571,925,971,971,797,925,925,925,925,925,925,925,616,922,971,925,925,925,971,971,971,971,926,926,971,971,971,571,925,971,971,797,925,925,925,925,925,925,925,616,922,971,925,925,925,971,971,971,971,926,926,971,971,971,571,925,971,971,423,937,423,937,423,937,423,937,423,937,422,971,422,971,422,971],[0.171,-0.0358,1,0.395,0.47,0.024,-0.591,0.306,-0.0434,0.519,0.00467,0.622,0.638,0.139,0.123,0.023,0.108,0.00362,0.217,-0.0316,0.162,-0.0155,0.00161,-0.0179,0.733,-0.0317,0.0317,0.245,0.158,0.395,1,0.381,0.272,-0.663,0.283,0.128,0.126,-0.0351,0.82,0.852,0.253,0.195,0.0593,0.164,0.0283,0.186,0.338,0.312,-0.00556,0.00793,0.0112,0.691,-0.084,0.084,0.216,-0.318,0.47,0.381,1,-0.352,-0.732,0.874,0.218,0.454,0.28,0.818,0.768,-0.25,0.137,0.0237,0.0628,0.0169,0.8,0.0347,0.384,-0.0199,-0.0212,0.132,0.517,-0.139,0.139,0.201,0.772,0.024,0.272,-0.352,1,-0.355,-0.317,0.0602,-0.349,-0.25,-0.0524,0.0884,0.864,0.202,0.0763,0.112,0.01,-0.426,0.402,0.0993,-0.01,0.0227,0.114,0.232,-0.035,0.035,-0.351,-0.206,-0.591,-0.663,-0.732,-0.355,1,-0.633,-0.247,-0.269,-0.0765,-0.836,-0.886,-0.361,-0.283,-0.0776,-0.155,-0.022,-0.473,-0.315,-0.442,0.0277,0.00454,-0.214,-0.773,0.152,-0.152,0.274,0.0187,0.162,0.312,0.384,0.0993,-0.442,0.335,0.27,0.078,0.236,0.404,0.412,0.0717,0.316,0.454,0.317,0.134,0.247,0.164,1,0.0332,0.0483,0.171,0.276,-0.265,0.265,0.0766,0.00134,-0.0155,-0.00556,-0.0199,-0.01,0.0277,-0.0265,0.0667,-0.0346,-0.0148,-0.0147,-0.0171,-0.0161,0.43,0.271,0.153,0.982,-0.0219,0.0589,0.0332,1,0.867,0.0309,-0.00915,0.0641,-0.0641,0.0901,0.0361,0.00161,0.00793,-0.0212,0.0227,0.00454,-0.0337,0.0912,-0.0453,-0.0102,-0.00532,-0.00341,0.0118,0.571,0.519,0.248,0.931,-0.0257,0.0876,0.0483,0.867,1,0.0491,0.0254,0.158,-0.158,-4.04,12.8,-16,48.4,-14.6,38.4,-1.87,12.9,3.28,-10.2,-6.36,22,18.3,1.23,6.51,11.5],[2.08145454545455e-06,0.379384615384615,0,1.10492307692308e-35,6.16390243902439e-52,0.565016949152542,1.82964705882353e-88,2.47660273972603e-21,0.385222929936306,8.87351351351351e-65,0.911090047393365,1.404e-100,3.2544e-107,3.74275862068966e-05,0.000286243902439024,0.58404469273743,0.001728,0.929207547169811,4.7336170212766e-11,0.432,1.53974311926606e-06,0.714031088082901,0.965469767441861,0.737265306122449,1.377e-157,0.432,0.432,3.66260869565217e-12,2.19891891891892e-06,1.10492307692308e-35,0,3.56014285714286e-33,5.832e-17,1.28855172413793e-118,3.03567567567568e-18,0.00246857142857143,0.000191213114754098,0.386385093167702,1.74e-227,1.07595e-263,9.19905882352941e-15,3.77454545454545e-09,0.104597260273973,1.04676923076923e-06,0.495905325443787,2.13005940594059e-08,7.30285714285714e-26,7.77e-22,0.903652173913043,0.853463414634146,0.839527093596059,6.152e-133,0.0170865671641791,0.0170865671641791,1.32685714285714e-09,6.35294117647059e-23,6.16390243902439e-52,3.56014285714286e-33,0,3.85967213114754e-28,2.47569230769231e-157,9.33428571428571e-294,8.19529411764706e-08,4.81227906976744e-48,9.94736842105263e-18,8.77642105263157e-226,1.80313043478261e-182,1.7751724137931e-14,4.896e-05,0.570337078651685,0.0826758620689655,0.690063157894737,7.398e-209,0.386385093167702,3.348e-33,0.62951871657754,0.605967567567568,0.00256818897637795,2.16e-64,4.1735593220339e-05,4.1735593220339e-05,1.85328e-08,2.03236363636364e-185,0.565016949152542,5.832e-17,3.85967213114754e-28,0,1.15322033898305e-28,7.29391304347826e-23,0.190421052631579,1.36916129032258e-27,2.30727272727273e-14,0.158013422818792,0.0111792366412214,3.0384e-279,8.955e-10,0.0310791366906475,0.00108,0.817791044776119,6.61787234042553e-42,4.05991836734694e-37,0.00418604651162791,0.817791044776119,0.585944751381215,0.0105009230769231,1.71613186813187e-12,0.386385093167702,0.386385093167702,2.71827692307692e-24,4.86568421052632e-10,1.82964705882353e-88,1.28855172413793e-118,2.47569230769231e-157,1.15322033898305e-28,0,3.33058064516129e-105,9.95381443298969e-10,1.59787951807229e-16,0.0308347826086957,3.78635294117647e-245,1.63374545452778e-312,1.22021052631579e-29,3.312e-18,0.0283795620437956,4.10973451327434e-06,0.59578021978022,9.63692307692308e-53,1.48114285714286e-22,7.632e-45,0.505263157894737,0.911090047393365,4.63456310679612e-07,2.56114285714286e-186,5.99165217391304e-06,5.99165217391304e-06,9.19905882352941e-15,0.656042553191489,1.53974311926606e-06,7.77e-22,3.348e-33,0.00418604651162791,7.632e-45,4.32e-25,2.00903225806452e-11,0.0283795620437956,2.424e-13,4.9248e-37,1.413e-38,0.0445787234042553,1.76023880597015e-23,8.33142857142857e-50,1.34181818181818e-23,4.896e-05,5.53348314606742e-14,1.06354285714286e-06,0,0.397756097560976,0.18882119205298,6.92628099173554e-05,3.71076923076923e-17,1.22224390243902e-16,1.22224390243902e-16,0.0465464788732394,0.967,0.714031088082901,0.903652173913043,0.62951871657754,0.817791044776119,0.505263157894737,0.527441860465116,0.143027027027027,0.392,0.718144329896907,0.725538461538462,0.689142857142857,0.705675392670157,2.68591304347826e-44,2.57516883116883e-17,3.25928571428571e-06,0,0.597245901639344,0.107559183673469,0.397756097560976,0,5.16738461538461e-294,0.565016949152542,0.835128712871287,0.069,0.069,0.0176,0.379384615384615,0.965469767441861,0.853463414634146,0.605967567567568,0.585944751381215,0.911090047393365,0.401890909090909,0.0364114285714286,0.238588235294118,0.817791044776119,0.905538461538462,0.930929577464789,0.789441624365482,2.18468571428571e-84,3.3e-67,1.16037209302326e-14,0,0.543121387283237,0.0125018181818182,0.18882119205298,5.16738461538461e-294,0,0.338025974025974,0.547448275862069,1.42519626168224e-06,1.42519626168224e-06,2.06e-06,2.53866666666667e-64,0.0111384615384615,1.408e-88,3.11272727272727e-05,1.64e-47,0.721,2.79111111111111e-05,3.11272727272727e-05,1.1344e-97,3.90666666666667e-05,7.296e-32,0.0556571428571429,1.73866666666667e-22,0.168533333333333,1.80342857142857e-14],["co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","co","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>signature<\/th>\n      <th>feature<\/th>\n      <th>count<\/th>\n      <th>measure<\/th>\n      <th>p<\/th>\n      <th>type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="signatures-mutated-genes" class="section level3">
<h3>Signatures &amp; mutated genes</h3>
<p>Analyze the association between signatures and mutated genes (only driver genes identified by MutSig).</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1">tidy_data.seqz.gene &lt;-<span class="st"> </span><span class="kw">get_sig_feature_association</span>(df.seqz,</a>
<a class="sourceLine" id="cb71-2" data-line-number="2">                                                   <span class="dt">cols_to_sigs =</span> cols_to_sigs.seqz,</a>
<a class="sourceLine" id="cb71-3" data-line-number="3">                                                   <span class="dt">cols_to_features =</span> cols_to_mutated_genes,</a>
<a class="sourceLine" id="cb71-4" data-line-number="4">                                                   <span class="dt">min_n =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb71-5" data-line-number="5">                                                   <span class="dt">type =</span> <span class="st">&quot;ca&quot;</span>, </a>
<a class="sourceLine" id="cb71-6" data-line-number="6">                                                   <span class="dt">verbose =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-7" data-line-number="7"><span class="st">  </span><span class="kw">get_tidy_association</span>(<span class="dt">p_adjust =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb71-8" data-line-number="8"><span class="co">#&gt; -&gt; Detecting and transforming possibly ordinal variables...</span></a>
<a class="sourceLine" id="cb71-9" data-line-number="9"><span class="co">#&gt; -&gt; Calculating correlations for categorical variables using wilcox.test...</span></a>
<a class="sourceLine" id="cb71-10" data-line-number="10"><span class="co">#&gt; --&gt; building test models, be patient...</span></a>
<a class="sourceLine" id="cb71-11" data-line-number="11"><span class="co">#&gt; --&gt; done</span></a>
<a class="sourceLine" id="cb71-12" data-line-number="12"><span class="co">#&gt; --&gt; obtaining model results...</span></a>
<a class="sourceLine" id="cb71-13" data-line-number="13"><span class="co">#&gt; --&gt; done</span></a>
<a class="sourceLine" id="cb71-14" data-line-number="14"><span class="co">#&gt; --&gt; collecting data...</span></a>
<a class="sourceLine" id="cb71-15" data-line-number="15"><span class="co">#&gt; --&gt; done</span></a>
<a class="sourceLine" id="cb71-16" data-line-number="16"><span class="co">#&gt; -&gt; Done</span></a></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">sum_genes =<span class="st"> </span>tidy_data.seqz.gene <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb72-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(p <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb72-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">min =</span> <span class="kw">min</span>(measure, <span class="dt">na.rm =</span> T),</a>
<a class="sourceLine" id="cb72-4" data-line-number="4">                   <span class="dt">max =</span> <span class="kw">max</span>(measure, <span class="dt">na.rm =</span> T),</a>
<a class="sourceLine" id="cb72-5" data-line-number="5">                   <span class="dt">sum =</span> <span class="kw">list</span>(<span class="kw">summary</span>(measure)))</a>
<a class="sourceLine" id="cb72-6" data-line-number="6"></a>
<a class="sourceLine" id="cb72-7" data-line-number="7">sum_genes<span class="op">$</span>sum</a>
<a class="sourceLine" id="cb72-8" data-line-number="8"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb72-9" data-line-number="9"><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb72-10" data-line-number="10"><span class="co">#&gt; -17.300  -3.830   6.675  17.086  20.550 286.000</span></a></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="co"># myPalette &lt;- colorRampPalette(rev(brewer.pal(11, &quot;RdYlBu&quot;)))</span></a>
<a class="sourceLine" id="cb73-2" data-line-number="2"><span class="co"># sc &lt;- scale_colour_gradientn(colours = myPalette(100), limits=c(-20, 600))</span></a>
<a class="sourceLine" id="cb73-3" data-line-number="3"></a>
<a class="sourceLine" id="cb73-4" data-line-number="4">sc &lt;-<span class="st"> </span><span class="kw">scale_colour_gradientn</span>(</a>
<a class="sourceLine" id="cb73-5" data-line-number="5">  <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;red&quot;</span>),</a>
<a class="sourceLine" id="cb73-6" data-line-number="6">  <span class="dt">values =</span> scales<span class="op">::</span><span class="kw">rescale</span>(<span class="kw">c</span>(</a>
<a class="sourceLine" id="cb73-7" data-line-number="7">   sum_genes<span class="op">$</span>min,</a>
<a class="sourceLine" id="cb73-8" data-line-number="8">    <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb73-9" data-line-number="9">    <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb73-10" data-line-number="10">    sum_genes<span class="op">$</span>max</a>
<a class="sourceLine" id="cb73-11" data-line-number="11">  )))</a>
<a class="sourceLine" id="cb73-12" data-line-number="12"></a>
<a class="sourceLine" id="cb73-13" data-line-number="13"><span class="kw">show_sig_feature_corrplot</span>(tidy_data.seqz.gene, </a>
<a class="sourceLine" id="cb73-14" data-line-number="14">                          <span class="dt">ylab =</span> <span class="st">&quot;Mutated genes&quot;</span>,</a>
<a class="sourceLine" id="cb73-15" data-line-number="15">                          <span class="dt">ca_gradient_colors =</span> sc,</a>
<a class="sourceLine" id="cb73-16" data-line-number="16">                          <span class="dt">p_val =</span> <span class="fl">0.05</span>) <span class="co"># p_val needs to keep in line with the sum_genes p &lt;= 0.05</span></a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-58-1.png" width="2700" /></p>
<p>The result table:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">DT<span class="op">::</span><span class="kw">datatable</span>(tidy_data.seqz.gene)</a></code></pre></div>
<div id="htmlwidget-e055b3cd294efa27da44" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e055b3cd294efa27da44">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136"],["CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3"],["APC","AR","ATM","BRCA1/2","CDK12","CDKN1B","CTNNB1","FOXA1","IDH1","MED12","NKX3-1","PIK3CA/B","PIK3R1","PTEN","RB1","SPOP","TP53","APC","AR","ATM","BRCA1/2","CDK12","CDKN1B","CTNNB1","FOXA1","IDH1","MED12","NKX3-1","PIK3CA/B","PIK3R1","PTEN","RB1","SPOP","TP53","APC","AR","ATM","BRCA1/2","CDK12","CDKN1B","CTNNB1","FOXA1","IDH1","MED12","NKX3-1","PIK3CA/B","PIK3R1","PTEN","RB1","SPOP","TP53","APC","AR","ATM","BRCA1/2","CDK12","CDKN1B","CTNNB1","FOXA1","IDH1","MED12","NKX3-1","PIK3CA/B","PIK3R1","PTEN","RB1","SPOP","TP53","APC","AR","ATM","BRCA1/2","CDK12","CDKN1B","CTNNB1","FOXA1","IDH1","MED12","NKX3-1","PIK3CA/B","PIK3R1","PTEN","RB1","SPOP","TP53","APC","AR","ATM","BRCA1/2","CDK12","CDKN1B","CTNNB1","FOXA1","IDH1","MED12","NKX3-1","PIK3CA/B","PIK3R1","PTEN","RB1","SPOP","TP53","APC","AR","ATM","BRCA1/2","CDK12","CDKN1B","CTNNB1","FOXA1","IDH1","MED12","NKX3-1","PIK3CA/B","PIK3R1","PTEN","RB1","SPOP","TP53","APC","AR","ATM","BRCA1/2","CDK12","CDKN1B","CTNNB1","FOXA1","IDH1","MED12","NKX3-1","PIK3CA/B","PIK3R1","PTEN","RB1","SPOP","TP53"],[929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971],[4.28,5.67,-0.618,6.95,5.33,4.02,1.72,0.206,-4.93,7.4,2.87,1.83,3.78,4.81,3.05,-2.54,3.48,14.3,29,3,20.1,61.2,11.3,22,-0.4,-18.5,0.535,13.7,8.98,10.4,16.4,14,-14.3,13.2,27.8,8.92,-2.33,17.5,11.5,25,6.42,1.57,-18.6,5.61,21.5,0.553,27.3,29.4,23.4,-12.2,24.4,0.089,28.7,13.8,10.3,16.5,-5.32,11.8,3.51,-13.1,-3.46,3.77,8.62,-0.642,-1.46,3.14,7.58,-2.2,-5.19,-6.71,-1.66,-5.39,-6.14,-3.91,-3.59,-0.925,5.85,-1.02,-4.65,-1.72,-4.9,-5.4,-4.87,1.47,-4.29,18.3,36.6,12.8,66.3,15.3,6.4,17.5,4.76,-17.3,28.7,14.2,13.9,14.5,13.1,18.1,0.612,11.1,-6.55,25.9,20.7,123,-8.21,-11.2,286,13.5,891,2.41,-16.3,305,-8.61,-8.13,-8.52,0.902,57.3,-2,30.6,25.7,141,-1.69,-2.56,115,12.7,379,7.69,-10,152,-4.29,1.12,2.59,6.14,32],[6.08909090909091e-07,0.000119784615384615,0.749557251908397,0.0211746835443038,0.334769230769231,0.000287396226415094,0.139645360824742,0.936661654135338,0.199378640776699,0.072,1.31559183673469e-05,0.7023125,5.17333333333333e-05,5.49230769230769e-12,0.00226275862068966,0.0146388888888889,4.5424e-05,7.91589743589744e-08,5.01052631578947e-08,0.15265306122449,0.0414716049382716,0.0211746835443038,0.00126528571428571,0.106231111111111,0.99,0.196594059405941,0.372571428571429,1.3192e-07,0.304785714285714,9.71833333333333e-06,1.89856e-12,8.9058064516129e-10,0.00358950819672131,1.40730434782609e-06,4.4336e-21,0.530622950819672,0.950992592592593,0.104781818181818,0.175838383838384,1.3736e-16,0.329263157894737,0.69392125984252,0.331130434782609,0.62250406504065,6.12e-22,0.329263157894737,7.91272727272727e-23,1.5708e-25,2.38755555555556e-23,0.0816,2.15745454545455e-14,0.655870967741935,0.000460888888888889,0.114731914893617,0.197333333333333,0.108052747252747,0.00244338983050847,0.200076923076923,0.258018691588785,0.248685714285714,0.662592,0.124976842105263,0.106231111111111,0.427107438016529,0.0146388888888889,0.376266666666667,0.0171286486486486,0.0573493975903615,4.352e-23,1.68057142857143e-07,0.258148148148148,0.00330933333333333,0.0108590769230769,1.632e-13,0.0146388888888889,0.34806779661017,0.0127677611940299,0.726387596899225,8.024e-30,0.17816,6.409e-24,1.3124e-30,5.6848e-31,0.25788679245283,3.39433333333333e-13,4.4336e-21,2.01059459459459e-08,0.0146388888888889,1.47609756097561e-07,0.0101575,4.896e-09,0.02278,0.011910303030303,0.0146388888888889,0.0616857142857143,1.3124e-30,0.125941666666667,6.67115789473684e-18,1.68866666666667e-22,1.632e-38,0.00213782456140351,4.36e-09,2.00474074074074e-11,1.13333333333333e-06,0.0477658536585366,1.496e-06,0.110701075268817,0.00848380952380952,0.00612,0.0146805479452055,0.939820895522388,0.0176621052631579,1.78675862068966e-10,0.276990825688073,5.66666666666667e-10,1.2325e-09,5.916e-20,0.749557251908397,1.89575757575758e-09,6.46e-09,0.0176621052631579,0.67568253968254,0.287927927927928,0.0961379310344828,2.11906976744186e-07,0.0211746835443038,0.286836363636364,0.858242424242424,0.110278260869565,1.1152e-24,0.000600872727272727,5.48857142857143e-11,1.19809523809524e-14,3.88355555555556e-18,0.334769230769231,2.88e-18],["ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>signature<\/th>\n      <th>feature<\/th>\n      <th>count<\/th>\n      <th>measure<\/th>\n      <th>p<\/th>\n      <th>type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="signatures-mutated-pathways" class="section level3">
<h3>Signatures &amp; mutated pathways</h3>
<p>Analyze the association between signatures and mutated pathways.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">tidy_data.seqz.pathways &lt;-<span class="st"> </span><span class="kw">get_sig_feature_association</span>(df.seqz,</a>
<a class="sourceLine" id="cb75-2" data-line-number="2">                                                       <span class="dt">cols_to_sigs =</span> cols_to_sigs.seqz,</a>
<a class="sourceLine" id="cb75-3" data-line-number="3">                                                       <span class="dt">cols_to_features =</span> cols_to_mutated_pathways,</a>
<a class="sourceLine" id="cb75-4" data-line-number="4">                                                       <span class="dt">type =</span> <span class="st">&quot;ca&quot;</span>, </a>
<a class="sourceLine" id="cb75-5" data-line-number="5">                                                       <span class="dt">min_n =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb75-6" data-line-number="6">                                                       <span class="dt">verbose =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-7" data-line-number="7"><span class="st">  </span><span class="kw">get_tidy_association</span>(<span class="dt">p_adjust =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb75-8" data-line-number="8"><span class="co">#&gt; -&gt; Detecting and transforming possibly ordinal variables...</span></a>
<a class="sourceLine" id="cb75-9" data-line-number="9"><span class="co">#&gt; -&gt; Calculating correlations for categorical variables using wilcox.test...</span></a>
<a class="sourceLine" id="cb75-10" data-line-number="10"><span class="co">#&gt; --&gt; building test models, be patient...</span></a>
<a class="sourceLine" id="cb75-11" data-line-number="11"><span class="co">#&gt; --&gt; done</span></a>
<a class="sourceLine" id="cb75-12" data-line-number="12"><span class="co">#&gt; --&gt; obtaining model results...</span></a>
<a class="sourceLine" id="cb75-13" data-line-number="13"><span class="co">#&gt; --&gt; done</span></a>
<a class="sourceLine" id="cb75-14" data-line-number="14"><span class="co">#&gt; --&gt; collecting data...</span></a>
<a class="sourceLine" id="cb75-15" data-line-number="15"><span class="co">#&gt; --&gt; done</span></a>
<a class="sourceLine" id="cb75-16" data-line-number="16"><span class="co">#&gt; -&gt; Done</span></a></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">sum_pathways =<span class="st"> </span>tidy_data.seqz.pathways <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(p <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb76-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">min =</span> <span class="kw">min</span>(measure, <span class="dt">na.rm =</span> T),</a>
<a class="sourceLine" id="cb76-4" data-line-number="4">                   <span class="dt">max =</span> <span class="kw">max</span>(measure, <span class="dt">na.rm =</span> T),</a>
<a class="sourceLine" id="cb76-5" data-line-number="5">                   <span class="dt">sum =</span> <span class="kw">list</span>(<span class="kw">summary</span>(measure)))</a>
<a class="sourceLine" id="cb76-6" data-line-number="6"></a>
<a class="sourceLine" id="cb76-7" data-line-number="7">sum_pathways<span class="op">$</span>sum</a>
<a class="sourceLine" id="cb76-8" data-line-number="8"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb76-9" data-line-number="9"><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb76-10" data-line-number="10"><span class="co">#&gt;  -4.130   7.393  16.700  61.573  75.125 768.000</span></a></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1">sc &lt;-<span class="st"> </span><span class="kw">scale_colour_gradientn</span>(</a>
<a class="sourceLine" id="cb77-2" data-line-number="2">  <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;red&quot;</span>),</a>
<a class="sourceLine" id="cb77-3" data-line-number="3">  <span class="dt">values =</span> scales<span class="op">::</span><span class="kw">rescale</span>(<span class="kw">c</span>(</a>
<a class="sourceLine" id="cb77-4" data-line-number="4">    sum_pathways<span class="op">$</span>min,</a>
<a class="sourceLine" id="cb77-5" data-line-number="5">    <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb77-6" data-line-number="6">    <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb77-7" data-line-number="7">    sum_pathways<span class="op">$</span>max</a>
<a class="sourceLine" id="cb77-8" data-line-number="8">  )))</a>
<a class="sourceLine" id="cb77-9" data-line-number="9"></a>
<a class="sourceLine" id="cb77-10" data-line-number="10"></a>
<a class="sourceLine" id="cb77-11" data-line-number="11"><span class="kw">show_sig_feature_corrplot</span>(tidy_data.seqz.pathways,</a>
<a class="sourceLine" id="cb77-12" data-line-number="12">                          <span class="dt">ylab =</span> <span class="st">&quot;Mutated pathways&quot;</span>,</a>
<a class="sourceLine" id="cb77-13" data-line-number="13">                          <span class="dt">ca_gradient_colors =</span> sc,</a>
<a class="sourceLine" id="cb77-14" data-line-number="14">                          <span class="dt">p_val =</span> <span class="fl">0.05</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-62-1.png" width="2700" /></p>
<p>The result table:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1">DT<span class="op">::</span><span class="kw">datatable</span>(tidy_data.seqz.pathways)</a></code></pre></div>
<div id="htmlwidget-b527bb6643b211d85627" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b527bb6643b211d85627">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96"],["CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig1","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig2","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig3","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig4","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","CN-Sig5","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig1","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig2","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3","SBS-Sig3"],["AR_pathway","Cell_Cycle_pathway","Hippo_pathway","HR_pathway","MYC_pathway","NOTCH_pathway","NRF2_pathway","PI3K_pathway","RTK-RAS_pathway","TGF-Beta_pathway","TP53_pathway","WNT_pathway","AR_pathway","Cell_Cycle_pathway","Hippo_pathway","HR_pathway","MYC_pathway","NOTCH_pathway","NRF2_pathway","PI3K_pathway","RTK-RAS_pathway","TGF-Beta_pathway","TP53_pathway","WNT_pathway","AR_pathway","Cell_Cycle_pathway","Hippo_pathway","HR_pathway","MYC_pathway","NOTCH_pathway","NRF2_pathway","PI3K_pathway","RTK-RAS_pathway","TGF-Beta_pathway","TP53_pathway","WNT_pathway","AR_pathway","Cell_Cycle_pathway","Hippo_pathway","HR_pathway","MYC_pathway","NOTCH_pathway","NRF2_pathway","PI3K_pathway","RTK-RAS_pathway","TGF-Beta_pathway","TP53_pathway","WNT_pathway","AR_pathway","Cell_Cycle_pathway","Hippo_pathway","HR_pathway","MYC_pathway","NOTCH_pathway","NRF2_pathway","PI3K_pathway","RTK-RAS_pathway","TGF-Beta_pathway","TP53_pathway","WNT_pathway","AR_pathway","Cell_Cycle_pathway","Hippo_pathway","HR_pathway","MYC_pathway","NOTCH_pathway","NRF2_pathway","PI3K_pathway","RTK-RAS_pathway","TGF-Beta_pathway","TP53_pathway","WNT_pathway","AR_pathway","Cell_Cycle_pathway","Hippo_pathway","HR_pathway","MYC_pathway","NOTCH_pathway","NRF2_pathway","PI3K_pathway","RTK-RAS_pathway","TGF-Beta_pathway","TP53_pathway","WNT_pathway","AR_pathway","Cell_Cycle_pathway","Hippo_pathway","HR_pathway","MYC_pathway","NOTCH_pathway","NRF2_pathway","PI3K_pathway","RTK-RAS_pathway","TGF-Beta_pathway","TP53_pathway","WNT_pathway"],[929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,929,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971,971],[1.74,2.95,2.8,2.12,0.0791,1.45,-1.84,1.84,1.64,-2.65,2.83,2.42,11.7,32.8,8.63,8.69,10.3,10.1,30.1,7.04,8.45,-8.76,12.6,12.6,5.05,6.07,7.87,7.41,23,8.84,-7.16,1.11,9.95,-4.59,21.4,6.93,16.2,5.76,4.78,7.33,5.63,6.14,4.08,9.85,4.29,10.7,0.482,6.43,-3.6,-2.69,-2.3,-2.71,-4.63,-2.55,-0.158,-1.95,-2.58,-0.362,-4.13,-2.58,28.9,28.4,17.2,30.2,24,30.4,-1.22,14.9,19.1,33.9,11.9,14.7,136,426,82.2,40.6,768,115,586,102,78.2,454,51.2,91.4,99.2,348,74,50.2,316,92.1,221,84.8,70.7,180,29.4,75.5],[0.0246,0.526829268292683,0.306162162162162,0.31104,0.6336,0.503703703703704,0.667733333333333,0.1304,0.0505846153846154,0.595428571428571,0.000289745454545455,0.030336,3.94666666666667e-05,0.0505846153846154,0.000904421052631579,0.0234893617021277,0.141341538461538,0.0797672727272727,0.763826086956522,0.0146971428571429,0.0002532,0.904258064516129,2.5632e-07,0.0149890909090909,0.358736842105263,0.995,0.243478260869565,0.133140983606557,0.450835443037975,0.0624905660377359,0.555180722891566,0.638511627906977,0.000650666666666667,0.503703703703704,2.5472e-12,0.025469387755102,0.000170322580645161,0.256457142857143,0.0833142857142857,0.301150684931507,0.921191489361702,0.149014925373134,0.282591549295775,0.003552,0.418461538461538,0.136838095238095,0.301150684931507,0.1304,8.57379310344828e-05,0.117020689655172,0.000650666666666667,0.0148688372093023,0.0691555555555556,0.00163446153846154,0.700483516483517,0.0136975609756098,2.25024e-05,0.667733333333333,1.3584e-12,0.000448941176470588,7.62e-08,0.0150826666666667,5.36e-06,1.05035294117647e-07,0.145454545454545,1.236e-09,0.638896551724138,0.000664216216216216,3.144e-10,0.227294117647059,5.44457142857143e-10,1.64e-08,5.44457142857143e-10,3.70742857142857e-06,1.77969230769231e-08,4.88347826086957e-06,0.0152973913043478,1.49333333333333e-09,0.0997052631578947,4.62545454545455e-06,4.56e-08,0.388987012987013,3.36e-10,1.216e-07,5.93142857142857e-05,1.41473684210526e-07,6.17018181818182e-09,0.995,0.656727272727273,2.25230769230769e-05,0.135483870967742,0.0001024,3.9168e-09,0.13845,4.8288e-14,5.3952e-08],["ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca","ca"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>signature<\/th>\n      <th>feature<\/th>\n      <th>count<\/th>\n      <th>measure<\/th>\n      <th>p<\/th>\n      <th>type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="correlation-network" class="section level3">
<h3>Correlation network</h3>
<p>To determine the structure of relationship between signatures and features, we use continuous variables to do correlation network analysis.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1">f_dt =<span class="st"> </span>df.seqz[, <span class="kw">c</span>(cols_to_sigs.seqz, cols_to_features[<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">-2</span>)])] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb79-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(is.ordered, as.numeric)</a></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1"><span class="kw">library</span>(corrr)</a>
<a class="sourceLine" id="cb80-2" data-line-number="2"></a>
<a class="sourceLine" id="cb80-3" data-line-number="3">res.cor &lt;-<span class="st"> </span><span class="kw">correlate</span>(f_dt,</a>
<a class="sourceLine" id="cb80-4" data-line-number="4">  <span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>,</a>
<a class="sourceLine" id="cb80-5" data-line-number="5">  <span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span></a>
<a class="sourceLine" id="cb80-6" data-line-number="6">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb80-7" data-line-number="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_if</span>(is.numeric, dplyr<span class="op">::</span>coalesce, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb80-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb80-9" data-line-number="9"><span class="co">#&gt; Correlation method: &#39;pearson&#39;</span></a>
<a class="sourceLine" id="cb80-10" data-line-number="10"><span class="co">#&gt; Missing treated using: &#39;pairwise.complete.obs&#39;</span></a>
<a class="sourceLine" id="cb80-11" data-line-number="11"></a>
<a class="sourceLine" id="cb80-12" data-line-number="12"><span class="co">## Avoid corrr error</span></a>
<a class="sourceLine" id="cb80-13" data-line-number="13"><span class="co">## https://github.com/tidymodels/corrr/issues/86</span></a>
<a class="sourceLine" id="cb80-14" data-line-number="14"><span class="co">## https://github.com/tidymodels/corrr/issues/34</span></a>
<a class="sourceLine" id="cb80-15" data-line-number="15"><span class="co">## https://github.com/tidymodels/corrr/issues/78</span></a>
<a class="sourceLine" id="cb80-16" data-line-number="16"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb80-17" data-line-number="17">res.cor[,<span class="op">-</span><span class="dv">1</span>] =<span class="st"> </span>res.cor[, <span class="dv">-1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">matrix</span>(</a>
<a class="sourceLine" id="cb80-18" data-line-number="18">  <span class="kw">rnorm</span>(<span class="kw">nrow</span>(res.cor[, <span class="dv">-1</span>]) <span class="op">*</span><span class="st"> </span><span class="kw">ncol</span>(res.cor[, <span class="dv">-1</span>]), <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="fl">0.01</span>),</a>
<a class="sourceLine" id="cb80-19" data-line-number="19">  <span class="dt">nrow =</span> <span class="kw">nrow</span>(res.cor[, <span class="dv">-1</span>]),</a>
<a class="sourceLine" id="cb80-20" data-line-number="20">  <span class="dt">byrow =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb80-21" data-line-number="21">)</a>
<a class="sourceLine" id="cb80-22" data-line-number="22"></a>
<a class="sourceLine" id="cb80-23" data-line-number="23">p =<span class="st"> </span>res.cor <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb80-24" data-line-number="24"><span class="st">  </span><span class="kw">network_plot</span>(<span class="dt">min_cor =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb80-25" data-line-number="25">               <span class="dt">colours =</span> <span class="kw">rev</span>(<span class="kw">c</span>(<span class="st">&quot;indianred2&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;skyblue1&quot;</span>)))</a>
<a class="sourceLine" id="cb80-26" data-line-number="26"></a>
<a class="sourceLine" id="cb80-27" data-line-number="27"><span class="co">#png(&quot;corrr_network.png&quot;, width = 7, height = 7, res = 300)</span></a>
<a class="sourceLine" id="cb80-28" data-line-number="28">p <span class="op">+</span><span class="st"> </span><span class="kw">scale_size</span>(<span class="dt">range=</span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb80-29" data-line-number="29"><span class="co">#&gt; Scale for &#39;size&#39; is already present. Adding another scale for &#39;size&#39;, which</span></a>
<a class="sourceLine" id="cb80-30" data-line-number="30"><span class="co">#&gt; will replace the existing scale.</span></a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-65-1.png" width="2400" /></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="co">#ggsave(&quot;corrr_network.pdf&quot;, plot = p + scale_size(range=c(0.1, 2)))</span></a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="co">#dev.off()</span></a></code></pre></div>
<p><del><a href="corrr_network.pdf">click here to see the plot</a></del></p>
<blockquote>
<p>variables that are more highly correlated appear closer together and are joined by stronger paths. Paths are also colored by their sign. The proximity of the points are determined using multidimensional clustering.</p>
</blockquote>
</div>
<div id="signatures-psa" class="section level3">
<h3>Signatures &amp; PSA</h3>
<p>In all datasets we collected, 3 of them have PSA info. However, the range of PSA value in 3 datasets differs, so I excluded PSA from features above and analyze it independently.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">df.seqz.psa =<span class="st"> </span>df.seqz <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(PSA)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;Sig&quot;</span>, <span class="dt">ignore.case =</span> F), <span class="kw">c</span>(<span class="st">&quot;PSA&quot;</span>, <span class="st">&quot;Study&quot;</span>, <span class="st">&quot;CNV_ID&quot;</span>))</a>
<a class="sourceLine" id="cb82-4" data-line-number="4"></a>
<a class="sourceLine" id="cb82-5" data-line-number="5">df.seqz.psa &lt;-<span class="st"> </span>df.seqz.psa <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-6" data-line-number="6"><span class="st">  </span>dplyr<span class="op">:::</span><span class="kw">group_by</span>(Study) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-7" data-line-number="7"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">nest</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-8" data-line-number="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb82-9" data-line-number="9">    <span class="dt">data =</span> purrr<span class="op">:::</span><span class="kw">map</span>(data, <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb82-10" data-line-number="10">      <span class="kw">get_sig_feature_association</span>(x,</a>
<a class="sourceLine" id="cb82-11" data-line-number="11">                                  <span class="dt">cols_to_sigs =</span> cols_to_sigs.seqz,</a>
<a class="sourceLine" id="cb82-12" data-line-number="12">                                  <span class="dt">cols_to_features =</span> <span class="st">&quot;PSA&quot;</span>,</a>
<a class="sourceLine" id="cb82-13" data-line-number="13">                                  <span class="dt">method_co =</span> <span class="st">&quot;pearson&quot;</span>,</a>
<a class="sourceLine" id="cb82-14" data-line-number="14">                                  <span class="dt">type =</span> <span class="st">&quot;co&quot;</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-15" data-line-number="15"><span class="st">        </span><span class="kw">get_tidy_association</span>(<span class="dt">p_adjust =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb82-16" data-line-number="16">    })</a>
<a class="sourceLine" id="cb82-17" data-line-number="17">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-18" data-line-number="18"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">unnest</span>(<span class="st">&quot;data&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-19" data-line-number="19"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(feature <span class="op">==</span><span class="st"> &quot;PSA&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-20" data-line-number="20"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">feature =</span> Study)</a>
<a class="sourceLine" id="cb82-21" data-line-number="21"><span class="co">#&gt; -&gt; Detecting and transforming possibly ordinal variables...</span></a>
<a class="sourceLine" id="cb82-22" data-line-number="22"><span class="co">#&gt; -&gt; Calculating correlations for continuous variables using pearson...</span></a>
<a class="sourceLine" id="cb82-23" data-line-number="23"><span class="co">#&gt; -&gt; Done</span></a>
<a class="sourceLine" id="cb82-24" data-line-number="24"><span class="co">#&gt; -&gt; Detecting and transforming possibly ordinal variables...</span></a>
<a class="sourceLine" id="cb82-25" data-line-number="25"><span class="co">#&gt; -&gt; Calculating correlations for continuous variables using pearson...</span></a>
<a class="sourceLine" id="cb82-26" data-line-number="26"><span class="co">#&gt; -&gt; Done</span></a>
<a class="sourceLine" id="cb82-27" data-line-number="27"><span class="co">#&gt; -&gt; Detecting and transforming possibly ordinal variables...</span></a>
<a class="sourceLine" id="cb82-28" data-line-number="28"><span class="co">#&gt; -&gt; Calculating correlations for continuous variables using pearson...</span></a>
<a class="sourceLine" id="cb82-29" data-line-number="29"><span class="co">#&gt; -&gt; Done</span></a></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="kw">show_sig_feature_corrplot</span>(df.seqz.psa, <span class="dt">p_val =</span> <span class="dv">1</span>, <span class="dt">breaks_count =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>), <span class="dt">ylab =</span> <span class="st">&quot;PSA&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-67-1.png" width="2700" /></p>
<p>Alought we can observe the statistically significant correlation between signatures and PSA, the results are inconsistent across different studies. This may be explained by the dynamic property of PSA while not the sample type due to most of them are primary.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="kw">table</span>(df.seqz<span class="op">$</span>sample_type, df.seqz<span class="op">$</span>Study)</a>
<a class="sourceLine" id="cb84-2" data-line-number="2"><span class="co">#&gt;             </span></a>
<a class="sourceLine" id="cb84-3" data-line-number="3"><span class="co">#&gt;              phs000447 phs000554 phs000909 phs000915 phs001141 TCGA</span></a>
<a class="sourceLine" id="cb84-4" data-line-number="4"><span class="co">#&gt;   Metastatic         0        50        80       147        77    0</span></a>
<a class="sourceLine" id="cb84-5" data-line-number="5"><span class="co">#&gt;   Primary          112        11        28         0         0  498</span></a></code></pre></div>
</div>
</div>
</div>
<div id="group-analysis" class="section level1">
<h1>Group Analysis</h1>
<p>This part has been divided into four parts to show the differences across sample groups defined by signature exposure. It provides insight into the heterogeneity of prostate cancers and relative importance of two types of genomic variation signatures.</p>
<p>Load packages.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb85-2" data-line-number="2"><span class="kw">library</span>(sigminer)</a></code></pre></div>
<p>Load the data.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">df.seqz =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;../output/df.seqz.RDS&quot;</span>)</a></code></pre></div>
<div id="group-comparison" class="section level2">
<h2>Group comparison</h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">cols_to_features &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb87-2" data-line-number="2">  <span class="st">&quot;IsMetastatic&quot;</span>, <span class="st">&quot;Stage&quot;</span>, <span class="st">&quot;GleasonScore&quot;</span>,</a>
<a class="sourceLine" id="cb87-3" data-line-number="3">  <span class="st">&quot;Age&quot;</span>, </a>
<a class="sourceLine" id="cb87-4" data-line-number="4">  <span class="st">&quot;n_SNV&quot;</span>, <span class="st">&quot;n_driver&quot;</span>,</a>
<a class="sourceLine" id="cb87-5" data-line-number="5">  <span class="co"># &quot;n_INDEL&quot;, </span></a>
<a class="sourceLine" id="cb87-6" data-line-number="6">  <span class="st">&quot;Ti_fraction&quot;</span>, <span class="st">&quot;Tv_fraction&quot;</span>,</a>
<a class="sourceLine" id="cb87-7" data-line-number="7">  <span class="st">&quot;cnaBurden&quot;</span>, <span class="st">&quot;n_CNV&quot;</span>, <span class="st">&quot;n_Amp&quot;</span>, <span class="st">&quot;n_Del&quot;</span>, <span class="st">&quot;ploidy&quot;</span>,</a>
<a class="sourceLine" id="cb87-8" data-line-number="8">  <span class="st">&quot;TD score&quot;</span>, </a>
<a class="sourceLine" id="cb87-9" data-line-number="9">  <span class="co"># &quot;sTD score&quot;, &quot;lTD score&quot;,</span></a>
<a class="sourceLine" id="cb87-10" data-line-number="10">  <span class="st">&quot;Chromothripisis score&quot;</span>, <span class="st">&quot;MACN score&quot;</span>,</a>
<a class="sourceLine" id="cb87-11" data-line-number="11">  <span class="st">&quot;MATH&quot;</span>, <span class="st">&quot;n_mutation_cluster&quot;</span>, <span class="st">&quot;purity&quot;</span></a>
<a class="sourceLine" id="cb87-12" data-line-number="12">)</a>
<a class="sourceLine" id="cb87-13" data-line-number="13"></a>
<a class="sourceLine" id="cb87-14" data-line-number="14">feature_type &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;ca&quot;</span>, 3L), <span class="kw">rep</span>(<span class="st">&quot;co&quot;</span>, <span class="kw">length</span>(cols_to_features) <span class="op">-</span><span class="st"> </span>3L))</a></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1">df.seqz<span class="op">$</span>GleasonScore =<span class="st"> </span><span class="kw">as.character</span>(df.seqz<span class="op">$</span>GleasonScore)</a>
<a class="sourceLine" id="cb88-2" data-line-number="2">df.seqz<span class="op">$</span>GleasonScore =<span class="st"> </span><span class="kw">factor</span>(df.seqz<span class="op">$</span>GleasonScore, <span class="dt">levels =</span> <span class="kw">as.character</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">10</span>))</a>
<a class="sourceLine" id="cb88-3" data-line-number="3"></a>
<a class="sourceLine" id="cb88-4" data-line-number="4">df.seqz2 =<span class="st"> </span>df.seqz</a>
<a class="sourceLine" id="cb88-5" data-line-number="5">df.seqz2<span class="op">$</span>cnv_enrich_sig =<span class="st"> </span><span class="kw">ifelse</span>(</a>
<a class="sourceLine" id="cb88-6" data-line-number="6">  <span class="op">!</span><span class="kw">is.na</span>(df.seqz2<span class="op">$</span>cnv_enrich_sig),</a>
<a class="sourceLine" id="cb88-7" data-line-number="7">  <span class="kw">paste</span>(df.seqz2<span class="op">$</span>cnv_enrich_sig, <span class="st">&quot;enriched&quot;</span>),</a>
<a class="sourceLine" id="cb88-8" data-line-number="8">  <span class="ot">NA</span></a>
<a class="sourceLine" id="cb88-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb88-10" data-line-number="10"></a>
<a class="sourceLine" id="cb88-11" data-line-number="11">grp.cnv &lt;-<span class="st"> </span><span class="kw">get_group_comparison</span>(</a>
<a class="sourceLine" id="cb88-12" data-line-number="12">  df.seqz2,</a>
<a class="sourceLine" id="cb88-13" data-line-number="13">  <span class="dt">col_group =</span> <span class="st">&quot;cnv_enrich_sig&quot;</span>, <span class="co"># or &quot;cnv_group&quot;</span></a>
<a class="sourceLine" id="cb88-14" data-line-number="14">  <span class="dt">cols_to_compare =</span> cols_to_features,</a>
<a class="sourceLine" id="cb88-15" data-line-number="15">  <span class="dt">type =</span> feature_type</a>
<a class="sourceLine" id="cb88-16" data-line-number="16">)</a></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1">plot.cnv &lt;-<span class="st"> </span><span class="kw">show_group_comparison</span>(</a>
<a class="sourceLine" id="cb89-2" data-line-number="2">  grp.cnv,</a>
<a class="sourceLine" id="cb89-3" data-line-number="3">  <span class="dt">xlab =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb89-4" data-line-number="4">  <span class="dt">method =</span> <span class="st">&quot;anova&quot;</span>,</a>
<a class="sourceLine" id="cb89-5" data-line-number="5">  <span class="dt">text_angle_x =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb89-6" data-line-number="6">  <span class="dt">text_hjust_x =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb89-7" data-line-number="7">  <span class="dt">legend_position_ca =</span> <span class="st">&quot;right&quot;</span>,</a>
<a class="sourceLine" id="cb89-8" data-line-number="8">  <span class="dt">label.x.npc =</span> <span class="st">&quot;center&quot;</span>, </a>
<a class="sourceLine" id="cb89-9" data-line-number="9">  <span class="dt">label.y.npc =</span> <span class="st">&quot;top&quot;</span>,</a>
<a class="sourceLine" id="cb89-10" data-line-number="10">  <span class="dt">label =</span> <span class="st">&quot;p.format&quot;</span>,</a>
<a class="sourceLine" id="cb89-11" data-line-number="11">  <span class="dt">hjust =</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb89-12" data-line-number="12">)</a></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">cowplot<span class="op">::</span><span class="kw">plot_grid</span>(<span class="dt">plotlist =</span> plot.cnv<span class="op">$</span>ca, <span class="dt">align =</span> <span class="st">&quot;hv&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-74-1.png" width="2700" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1">cowplot<span class="op">::</span><span class="kw">plot_grid</span>(<span class="dt">plotlist =</span> plot.cnv<span class="op">$</span>co, <span class="dt">align =</span> <span class="st">&quot;hv&quot;</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-75-1.png" width="3600" /></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1">df.seqz2<span class="op">$</span>snv_enrich_sig =<span class="st"> </span><span class="kw">ifelse</span>(</a>
<a class="sourceLine" id="cb92-2" data-line-number="2">  <span class="op">!</span><span class="kw">is.na</span>(df.seqz2<span class="op">$</span>snv_enrich_sig),</a>
<a class="sourceLine" id="cb92-3" data-line-number="3">  <span class="kw">paste</span>(df.seqz2<span class="op">$</span>snv_enrich_sig, <span class="st">&quot;enriched&quot;</span>),</a>
<a class="sourceLine" id="cb92-4" data-line-number="4">  <span class="ot">NA</span></a>
<a class="sourceLine" id="cb92-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb92-6" data-line-number="6"></a>
<a class="sourceLine" id="cb92-7" data-line-number="7">grp.snv &lt;-<span class="st"> </span><span class="kw">get_group_comparison</span>(</a>
<a class="sourceLine" id="cb92-8" data-line-number="8">  df.seqz2,</a>
<a class="sourceLine" id="cb92-9" data-line-number="9">  <span class="dt">col_group =</span> <span class="st">&quot;snv_enrich_sig&quot;</span>, <span class="co"># or &quot;snv_group&quot;</span></a>
<a class="sourceLine" id="cb92-10" data-line-number="10">  <span class="dt">cols_to_compare =</span> cols_to_features,</a>
<a class="sourceLine" id="cb92-11" data-line-number="11">  <span class="dt">type =</span> feature_type</a>
<a class="sourceLine" id="cb92-12" data-line-number="12">)</a></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">plot.snv &lt;-<span class="st"> </span><span class="kw">show_group_comparison</span>(</a>
<a class="sourceLine" id="cb93-2" data-line-number="2">  grp.snv,</a>
<a class="sourceLine" id="cb93-3" data-line-number="3">  <span class="dt">xlab =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb93-4" data-line-number="4">  <span class="dt">method =</span> <span class="st">&quot;anova&quot;</span>,</a>
<a class="sourceLine" id="cb93-5" data-line-number="5">  <span class="dt">text_angle_x =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb93-6" data-line-number="6">  <span class="dt">text_hjust_x =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb93-7" data-line-number="7">  <span class="dt">legend_position_ca =</span> <span class="st">&quot;right&quot;</span>,</a>
<a class="sourceLine" id="cb93-8" data-line-number="8">  <span class="dt">label.x.npc =</span> <span class="st">&quot;center&quot;</span>, </a>
<a class="sourceLine" id="cb93-9" data-line-number="9">  <span class="dt">label.y.npc =</span> <span class="st">&quot;top&quot;</span>,</a>
<a class="sourceLine" id="cb93-10" data-line-number="10">  <span class="dt">label =</span> <span class="st">&quot;p.format&quot;</span>,</a>
<a class="sourceLine" id="cb93-11" data-line-number="11">  <span class="dt">hjust =</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb93-12" data-line-number="12">)</a></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1">cowplot<span class="op">::</span><span class="kw">plot_grid</span>(<span class="dt">plotlist =</span> plot.snv<span class="op">$</span>ca, <span class="dt">align =</span> <span class="st">&quot;hv&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-78-1.png" width="2700" /></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1">cowplot<span class="op">::</span><span class="kw">plot_grid</span>(<span class="dt">plotlist =</span> plot.snv<span class="op">$</span>co, <span class="dt">align =</span> <span class="st">&quot;hv&quot;</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-79-1.png" width="3600" /></p>
<p>What if there are 5 SBS signatures and samples are divided into 5 groups?</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="kw">load</span>(<span class="st">&quot;../output/Sig5.Maf.RData&quot;</span>)</a>
<a class="sourceLine" id="cb96-2" data-line-number="2">sbs_grp =<span class="st"> </span><span class="kw">get_groups</span>(Sig.SNV5, <span class="dt">method =</span> <span class="st">&quot;consensus&quot;</span>, <span class="dt">match_consensus =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb96-3" data-line-number="3"><span class="co">#&gt;    </span></a>
<a class="sourceLine" id="cb96-4" data-line-number="4"><span class="co">#&gt;     Sig1 Sig2 Sig3 Sig4 Sig5</span></a>
<a class="sourceLine" id="cb96-5" data-line-number="5"><span class="co">#&gt;   1    0    0    3   33    1</span></a>
<a class="sourceLine" id="cb96-6" data-line-number="6"><span class="co">#&gt;   2    0    0    0    0  198</span></a>
<a class="sourceLine" id="cb96-7" data-line-number="7"><span class="co">#&gt;   3   69   21    7    3   42</span></a>
<a class="sourceLine" id="cb96-8" data-line-number="8"><span class="co">#&gt;   4    1   14  216   13   44</span></a>
<a class="sourceLine" id="cb96-9" data-line-number="9"><span class="co">#&gt;   5    0  272    1    4   29</span></a>
<a class="sourceLine" id="cb96-10" data-line-number="10">sbs_grp<span class="op">$</span>sample =<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">startsWith</span>(sbs_grp<span class="op">$</span>sample, <span class="st">&quot;TCGA&quot;</span>),</a>
<a class="sourceLine" id="cb96-11" data-line-number="11">                        <span class="kw">substr</span>(sbs_grp<span class="op">$</span>sample, <span class="dv">1</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb96-12" data-line-number="12">                        sbs_grp<span class="op">$</span>sample)</a></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1">df.seqz3 =<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb97-2" data-line-number="2">  sbs_grp,</a>
<a class="sourceLine" id="cb97-3" data-line-number="3">  df.seqz2,</a>
<a class="sourceLine" id="cb97-4" data-line-number="4">  <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;sample&quot;</span> =<span class="st"> &quot;tumor_Run&quot;</span>)</a>
<a class="sourceLine" id="cb97-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb97-6" data-line-number="6"></a>
<a class="sourceLine" id="cb97-7" data-line-number="7">df.seqz3<span class="op">$</span>enrich_sig =<span class="st"> </span><span class="kw">ifelse</span>(</a>
<a class="sourceLine" id="cb97-8" data-line-number="8">  <span class="op">!</span><span class="kw">is.na</span>(df.seqz3<span class="op">$</span>enrich_sig),</a>
<a class="sourceLine" id="cb97-9" data-line-number="9">  <span class="kw">paste</span>(df.seqz3<span class="op">$</span>enrich_sig, <span class="st">&quot;enriched&quot;</span>),</a>
<a class="sourceLine" id="cb97-10" data-line-number="10">  <span class="ot">NA</span></a>
<a class="sourceLine" id="cb97-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb97-12" data-line-number="12"></a>
<a class="sourceLine" id="cb97-13" data-line-number="13">grp.snv2 &lt;-<span class="st"> </span><span class="kw">get_group_comparison</span>(</a>
<a class="sourceLine" id="cb97-14" data-line-number="14">  df.seqz3,</a>
<a class="sourceLine" id="cb97-15" data-line-number="15">  <span class="dt">col_group =</span> <span class="st">&quot;enrich_sig&quot;</span>, <span class="co"># or &quot;snv_group&quot;</span></a>
<a class="sourceLine" id="cb97-16" data-line-number="16">  <span class="dt">cols_to_compare =</span> cols_to_features,</a>
<a class="sourceLine" id="cb97-17" data-line-number="17">  <span class="dt">type =</span> feature_type</a>
<a class="sourceLine" id="cb97-18" data-line-number="18">)</a></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1">plot.snv2 &lt;-<span class="st"> </span><span class="kw">show_group_comparison</span>(</a>
<a class="sourceLine" id="cb98-2" data-line-number="2">  grp.snv2,</a>
<a class="sourceLine" id="cb98-3" data-line-number="3">  <span class="dt">xlab =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb98-4" data-line-number="4">  <span class="dt">method =</span> <span class="st">&quot;anova&quot;</span>,</a>
<a class="sourceLine" id="cb98-5" data-line-number="5">  <span class="dt">text_angle_x =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb98-6" data-line-number="6">  <span class="dt">text_hjust_x =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb98-7" data-line-number="7">  <span class="dt">legend_position_ca =</span> <span class="st">&quot;right&quot;</span>,</a>
<a class="sourceLine" id="cb98-8" data-line-number="8">  <span class="dt">label.x.npc =</span> <span class="st">&quot;center&quot;</span>, </a>
<a class="sourceLine" id="cb98-9" data-line-number="9">  <span class="dt">label.y.npc =</span> <span class="st">&quot;top&quot;</span>,</a>
<a class="sourceLine" id="cb98-10" data-line-number="10">  <span class="dt">label =</span> <span class="st">&quot;p.format&quot;</span>,</a>
<a class="sourceLine" id="cb98-11" data-line-number="11">  <span class="dt">hjust =</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb98-12" data-line-number="12">)</a></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1">cowplot<span class="op">::</span><span class="kw">plot_grid</span>(<span class="dt">plotlist =</span> plot.snv2<span class="op">$</span>ca, <span class="dt">align =</span> <span class="st">&quot;hv&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-83-1.png" width="2700" /></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1">cowplot<span class="op">::</span><span class="kw">plot_grid</span>(<span class="dt">plotlist =</span> plot.snv2<span class="op">$</span>co, <span class="dt">align =</span> <span class="st">&quot;hv&quot;</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-84-1.png" width="3600" /></p>
</div>
<div id="group-mapping" class="section level2">
<h2>Group mapping</h2>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1">df.map =<span class="st"> </span>df.seqz[, <span class="kw">c</span>(<span class="st">&quot;sample_type&quot;</span>,</a>
<a class="sourceLine" id="cb101-2" data-line-number="2">                     <span class="st">&quot;cnv_enrich_sig&quot;</span>,</a>
<a class="sourceLine" id="cb101-3" data-line-number="3">                     <span class="st">&quot;snv_enrich_sig&quot;</span>)] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-4" data-line-number="4"><span class="st">  </span><span class="kw">na.omit</span>()</a>
<a class="sourceLine" id="cb101-5" data-line-number="5"><span class="kw">names</span>(df.map) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Sample type&quot;</span>, <span class="st">&quot;Enriched CN signature&quot;</span>, <span class="st">&quot;Enriched SBS signature&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="kw">show_group_mapping</span>(df.map, </a>
<a class="sourceLine" id="cb102-2" data-line-number="2">                   <span class="dt">col_to_flow =</span> <span class="st">&quot;Sample type&quot;</span>, </a>
<a class="sourceLine" id="cb102-3" data-line-number="3">                   <span class="dt">cols_to_map =</span> <span class="kw">setdiff</span>(<span class="kw">colnames</span>(df.map), <span class="st">&quot;Sample type&quot;</span>),</a>
<a class="sourceLine" id="cb102-4" data-line-number="4">                   <span class="dt">fill_na =</span> <span class="st">&quot;NA&quot;</span>, <span class="dt">include_sig =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-86-1.png" width="2400" /></p>
</div>
<div id="grouped-signature-exposure-profile" class="section level2">
<h2>Grouped signature exposure profile</h2>
<p>We have showed the exposure profiles, here we add group annotation to them.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1"><span class="kw">load</span>(<span class="st">&quot;../output/Sig.PRAD_TCGA_plus_dbGap_Maf.RData&quot;</span>)</a>
<a class="sourceLine" id="cb103-2" data-line-number="2"><span class="kw">load</span>(<span class="st">&quot;../output/Sig.CNV.seqz.W.RData&quot;</span>)</a></code></pre></div>
<div id="copy-number-signatures" class="section level3">
<h3>Copy number signatures</h3>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1">map_df =<span class="st"> </span>df.seqz <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb104-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cnv_enrich_sig, CNV_ID) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb104-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(CNV_ID))</a>
<a class="sourceLine" id="cb104-4" data-line-number="4"></a>
<a class="sourceLine" id="cb104-5" data-line-number="5">groups =<span class="st"> </span>map_df<span class="op">$</span>cnv_enrich_sig</a>
<a class="sourceLine" id="cb104-6" data-line-number="6"><span class="kw">names</span>(groups) =<span class="st"> </span>map_df<span class="op">$</span>CNV_ID</a>
<a class="sourceLine" id="cb104-7" data-line-number="7"></a>
<a class="sourceLine" id="cb104-8" data-line-number="8"><span class="kw">show_sig_exposure</span>(Sig.CNV.seqz.W,</a>
<a class="sourceLine" id="cb104-9" data-line-number="9">                  <span class="dt">groups =</span> groups, </a>
<a class="sourceLine" id="cb104-10" data-line-number="10">                  <span class="co">#grp_order = , </span></a>
<a class="sourceLine" id="cb104-11" data-line-number="11">                  <span class="dt">rm_space =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb104-12" data-line-number="12">                  <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>,</a>
<a class="sourceLine" id="cb104-13" data-line-number="13">                  <span class="dt">rm_grid_line =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb104-14" data-line-number="14">                  <span class="dt">rm_panel_border =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb104-15" data-line-number="15">                  <span class="dt">grp_size =</span> <span class="dv">7</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-88-1.png" width="2400" /></p>
</div>
<div id="sbs-signatures" class="section level3">
<h3>SBS signatures</h3>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" data-line-number="1">map_df =<span class="st"> </span>df.seqz <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb105-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(tumor_Run, snv_enrich_sig) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb105-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(tumor_Run))</a>
<a class="sourceLine" id="cb105-4" data-line-number="4"></a>
<a class="sourceLine" id="cb105-5" data-line-number="5">groups =<span class="st"> </span>map_df<span class="op">$</span>snv_enrich_sig</a>
<a class="sourceLine" id="cb105-6" data-line-number="6"><span class="kw">names</span>(groups) =<span class="st"> </span>map_df<span class="op">$</span>tumor_Run</a>
<a class="sourceLine" id="cb105-7" data-line-number="7"></a>
<a class="sourceLine" id="cb105-8" data-line-number="8">Sig.SNV2 =<span class="st"> </span>Sig.SNV</a>
<a class="sourceLine" id="cb105-9" data-line-number="9"></a>
<a class="sourceLine" id="cb105-10" data-line-number="10">TCGA_INDEX =<span class="st"> </span><span class="kw">startsWith</span>(<span class="kw">colnames</span>(Sig.SNV2<span class="op">$</span>Exposure), <span class="st">&quot;TCGA&quot;</span>)</a>
<a class="sourceLine" id="cb105-11" data-line-number="11"><span class="kw">colnames</span>(Sig.SNV2<span class="op">$</span>Exposure)[TCGA_INDEX] =<span class="st"> </span><span class="kw">substr</span>(<span class="kw">colnames</span>(Sig.SNV2<span class="op">$</span>Exposure)[TCGA_INDEX], <span class="dv">1</span>, <span class="dv">15</span>)</a>
<a class="sourceLine" id="cb105-12" data-line-number="12"></a>
<a class="sourceLine" id="cb105-13" data-line-number="13"><span class="kw">show_sig_exposure</span>(Sig.SNV2,</a>
<a class="sourceLine" id="cb105-14" data-line-number="14">                  <span class="dt">groups =</span> groups,</a>
<a class="sourceLine" id="cb105-15" data-line-number="15">                  <span class="dt">cutoff =</span> <span class="dv">2000</span>,</a>
<a class="sourceLine" id="cb105-16" data-line-number="16">                  <span class="dt">rm_space =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb105-17" data-line-number="17">                  <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>,</a>
<a class="sourceLine" id="cb105-18" data-line-number="18">                  <span class="dt">rm_grid_line =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb105-19" data-line-number="19">                  <span class="dt">rm_panel_border =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-89-1.png" width="2400" /></p>
</div>
</div>
<div id="copy-number-profile-of-different-groups" class="section level2">
<h2>Copy number profile of different groups</h2>
<p>There are many differences across copy number groups. Here we go further showing some classic cases by copy number profile.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1"><span class="kw">load</span>(<span class="st">&quot;../output/CNV.seqz.RData&quot;</span>)</a>
<a class="sourceLine" id="cb106-2" data-line-number="2"><span class="kw">load</span>(<span class="st">&quot;../output/Sig.CNV.seqz.W.RData&quot;</span>)</a>
<a class="sourceLine" id="cb106-3" data-line-number="3"><span class="kw">load</span>(<span class="st">&quot;../output/CNV.seqz.tally.W.RData&quot;</span>)</a></code></pre></div>
<p>There are 5 copy number groups dominated by 4 copy number signatures.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" data-line-number="1"><span class="kw">table</span>(df.seqz<span class="op">$</span>cnv_group, df.seqz<span class="op">$</span>cnv_enrich_sig)</a>
<a class="sourceLine" id="cb107-2" data-line-number="2"><span class="co">#&gt;    </span></a>
<a class="sourceLine" id="cb107-3" data-line-number="3"><span class="co">#&gt;     Sig1 Sig2 Sig3 Sig4 Sig5</span></a>
<a class="sourceLine" id="cb107-4" data-line-number="4"><span class="co">#&gt;   1   35    0    0    0    0</span></a>
<a class="sourceLine" id="cb107-5" data-line-number="5"><span class="co">#&gt;   2    0   63    0    0    0</span></a>
<a class="sourceLine" id="cb107-6" data-line-number="6"><span class="co">#&gt;   3    0    0  224    0    0</span></a>
<a class="sourceLine" id="cb107-7" data-line-number="7"><span class="co">#&gt;   4    0    0    0  170    0</span></a>
<a class="sourceLine" id="cb107-8" data-line-number="8"><span class="co">#&gt;   5    0    0    0    0  445</span></a></code></pre></div>
<p>Get the groups and relative exposures and merge them.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1">cn_group &lt;-<span class="st"> </span><span class="kw">get_groups</span>(Sig.CNV.seqz.W, <span class="dt">method =</span> <span class="st">&quot;consensus&quot;</span>, <span class="dt">match_consensus =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="co">#&gt;    </span></a>
<a class="sourceLine" id="cb108-3" data-line-number="3"><span class="co">#&gt;     Sig1 Sig2 Sig3 Sig4 Sig5</span></a>
<a class="sourceLine" id="cb108-4" data-line-number="4"><span class="co">#&gt;   1    9    2   14   10    0</span></a>
<a class="sourceLine" id="cb108-5" data-line-number="5"><span class="co">#&gt;   2    0   60    0    3    0</span></a>
<a class="sourceLine" id="cb108-6" data-line-number="6"><span class="co">#&gt;   3    0    3  219    2    0</span></a>
<a class="sourceLine" id="cb108-7" data-line-number="7"><span class="co">#&gt;   4    0    0    0  170    0</span></a>
<a class="sourceLine" id="cb108-8" data-line-number="8"><span class="co">#&gt;   5    0    3   35  200  207</span></a>
<a class="sourceLine" id="cb108-9" data-line-number="9">cn_group<span class="op">$</span>enrich_sig[cn_group<span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;1&quot;</span>] =<span class="st"> &quot;Sig1&quot;</span></a>
<a class="sourceLine" id="cb108-10" data-line-number="10">cn_expo &lt;-<span class="st"> </span><span class="kw">get_sig_exposure</span>(Sig.CNV.seqz.W, <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>)</a>
<a class="sourceLine" id="cb108-11" data-line-number="11"></a>
<a class="sourceLine" id="cb108-12" data-line-number="12">df &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">left_join</span>(cn_group, cn_expo)</a></code></pre></div>
<p>Now we can use data to find the cases with a specific signature enriched.</p>
<div id="sig1-cases" class="section level3">
<h3>Sig1 cases</h3>
<p>The group with enriched Sig1 is dominated by Sig3, we need to take case of it.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1">samps_to_show =<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb109-2" data-line-number="2"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">filter</span>(enrich_sig <span class="op">==</span><span class="st"> &quot;Sig1&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb109-3" data-line-number="3"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(dplyr<span class="op">::</span><span class="kw">desc</span>(Sig1)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb109-4" data-line-number="4"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">pull</span>(sample)</a>
<a class="sourceLine" id="cb109-5" data-line-number="5"></a>
<a class="sourceLine" id="cb109-6" data-line-number="6">samps_to_show</a>
<a class="sourceLine" id="cb109-7" data-line-number="7"><span class="co">#&gt; [1] &quot;5115056-SRR8311885&quot; &quot;TCGA-CH-5748-01&quot;    &quot;18-SRR5876729&quot;     </span></a>
<a class="sourceLine" id="cb109-8" data-line-number="8"><span class="co">#&gt; [4] &quot;5115276-SRR8312040&quot; &quot;3-SRR4044023&quot;       &quot;5115198-SRR8311993&quot;</span></a>
<a class="sourceLine" id="cb109-9" data-line-number="9">                                                                                                                                                                                                                               </a>
<a class="sourceLine" id="cb109-10" data-line-number="10"><span class="kw">show_cn_profile</span>(</a>
<a class="sourceLine" id="cb109-11" data-line-number="11">  <span class="dt">data =</span> CNV.seqz, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">show_title =</span> T,</a>
<a class="sourceLine" id="cb109-12" data-line-number="12">  <span class="dt">samples =</span> samps_to_show </a>
<a class="sourceLine" id="cb109-13" data-line-number="13">)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-93-1.png" width="4200" /></p>
<p>Of note, only the segments with <strong>high copy number</strong> are contributed by Sig1.</p>
</div>
<div id="sig2-cases" class="section level3">
<h3>Sig2 cases</h3>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1">samps_to_show =<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-2" data-line-number="2"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">filter</span>(enrich_sig <span class="op">==</span><span class="st"> &quot;Sig2&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-3" data-line-number="3"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(dplyr<span class="op">::</span><span class="kw">desc</span>(Sig2)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-4" data-line-number="4"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">pull</span>(sample)</a>
<a class="sourceLine" id="cb110-5" data-line-number="5"></a>
<a class="sourceLine" id="cb110-6" data-line-number="6">samps_to_show</a>
<a class="sourceLine" id="cb110-7" data-line-number="7"><span class="co">#&gt; [1] &quot;5115615-SRR8311749&quot; &quot;5115406-SRR8312068&quot; &quot;45-SRR5876761&quot;     </span></a>
<a class="sourceLine" id="cb110-8" data-line-number="8"><span class="co">#&gt; [4] &quot;36-SRR5876749&quot;      &quot;1115153-SRR2404067&quot; &quot;5115152-SRR8311933&quot;</span></a>
<a class="sourceLine" id="cb110-9" data-line-number="9"></a>
<a class="sourceLine" id="cb110-10" data-line-number="10"><span class="kw">show_cn_profile</span>(</a>
<a class="sourceLine" id="cb110-11" data-line-number="11">  <span class="dt">data =</span> CNV.seqz, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">show_title =</span> T,</a>
<a class="sourceLine" id="cb110-12" data-line-number="12">  <span class="dt">samples =</span> samps_to_show</a>
<a class="sourceLine" id="cb110-13" data-line-number="13">)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-94-1.png" width="4200" /></p>
</div>
<div id="sig3-cases" class="section level3">
<h3>Sig3 cases</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" data-line-number="1">samps_to_show =<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb111-2" data-line-number="2"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">filter</span>(enrich_sig <span class="op">==</span><span class="st"> &quot;Sig3&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb111-3" data-line-number="3"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(dplyr<span class="op">::</span><span class="kw">desc</span>(Sig3)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb111-4" data-line-number="4"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">pull</span>(sample)</a>
<a class="sourceLine" id="cb111-5" data-line-number="5"></a>
<a class="sourceLine" id="cb111-6" data-line-number="6">samps_to_show</a>
<a class="sourceLine" id="cb111-7" data-line-number="7"><span class="co">#&gt; [1] &quot;TCGA-HC-7745-01&quot;    &quot;1115082-SRR8304741&quot; &quot;TCGA-KK-A7B4-01&quot;   </span></a>
<a class="sourceLine" id="cb111-8" data-line-number="8"><span class="co">#&gt; [4] &quot;TCGA-ZG-A9L0-01&quot;    &quot;6115317-SRR8307505&quot; &quot;1115091-SRR8304759&quot;</span></a>
<a class="sourceLine" id="cb111-9" data-line-number="9"></a>
<a class="sourceLine" id="cb111-10" data-line-number="10"><span class="kw">show_cn_profile</span>(</a>
<a class="sourceLine" id="cb111-11" data-line-number="11">  <span class="dt">data =</span> CNV.seqz, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">show_title =</span> T,</a>
<a class="sourceLine" id="cb111-12" data-line-number="12">  <span class="dt">samples =</span> samps_to_show</a>
<a class="sourceLine" id="cb111-13" data-line-number="13">)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-95-1.png" width="4200" /></p>
</div>
<div id="sig4-cases" class="section level3">
<h3>Sig4 cases</h3>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1">samps_to_show =<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb112-2" data-line-number="2"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">filter</span>(enrich_sig <span class="op">==</span><span class="st"> &quot;Sig4&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb112-3" data-line-number="3"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(dplyr<span class="op">::</span><span class="kw">desc</span>(Sig4)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb112-4" data-line-number="4"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">pull</span>(sample)</a>
<a class="sourceLine" id="cb112-5" data-line-number="5"></a>
<a class="sourceLine" id="cb112-6" data-line-number="6">samps_to_show</a>
<a class="sourceLine" id="cb112-7" data-line-number="7"><span class="co">#&gt; [1] &quot;TCGA-KK-A59X-01&quot;   &quot;06-1749-SRR472297&quot; &quot;TCGA-XK-AAJA-01&quot;  </span></a>
<a class="sourceLine" id="cb112-8" data-line-number="8"><span class="co">#&gt; [4] &quot;05-3852-SRR472039&quot; &quot;03-1426-SRR465855&quot; &quot;TCGA-J4-A67N-01&quot;</span></a>
<a class="sourceLine" id="cb112-9" data-line-number="9"></a>
<a class="sourceLine" id="cb112-10" data-line-number="10"><span class="kw">show_cn_profile</span>(</a>
<a class="sourceLine" id="cb112-11" data-line-number="11">  <span class="dt">data =</span> CNV.seqz, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">show_title =</span> T,</a>
<a class="sourceLine" id="cb112-12" data-line-number="12">  <span class="dt">samples =</span> samps_to_show</a>
<a class="sourceLine" id="cb112-13" data-line-number="13">)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-96-1.png" width="4200" /></p>
</div>
<div id="sig5-cases" class="section level3">
<h3>Sig5 cases</h3>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1">samps_to_show =<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb113-2" data-line-number="2"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">filter</span>(enrich_sig <span class="op">==</span><span class="st"> &quot;Sig5&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb113-3" data-line-number="3"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(dplyr<span class="op">::</span><span class="kw">desc</span>(Sig5)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb113-4" data-line-number="4"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">pull</span>(sample)</a>
<a class="sourceLine" id="cb113-5" data-line-number="5"></a>
<a class="sourceLine" id="cb113-6" data-line-number="6">samps_to_show</a>
<a class="sourceLine" id="cb113-7" data-line-number="7"><span class="co">#&gt; [1] &quot;TCGA-KC-A7FE-01&quot;  &quot;TCGA-J4-AATV-01&quot;  &quot;TCGA-HI-7169-01&quot;  &quot;TCGA-FC-A66V-01&quot; </span></a>
<a class="sourceLine" id="cb113-8" data-line-number="8"><span class="co">#&gt; [5] &quot;TCGA-EJ-7791-01&quot;  &quot;09-120-SRR460104&quot;</span></a>
<a class="sourceLine" id="cb113-9" data-line-number="9"></a>
<a class="sourceLine" id="cb113-10" data-line-number="10"><span class="kw">show_cn_profile</span>(</a>
<a class="sourceLine" id="cb113-11" data-line-number="11">  <span class="dt">data =</span> CNV.seqz, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">show_title =</span> T,</a>
<a class="sourceLine" id="cb113-12" data-line-number="12">  <span class="dt">samples =</span> samps_to_show</a>
<a class="sourceLine" id="cb113-13" data-line-number="13">)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-97-1.png" width="4200" /></p>
<p>Sig5 enriched case with alterations.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1">samps_to_show =<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb114-2" data-line-number="2"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">filter</span>(enrich_sig <span class="op">==</span><span class="st"> &quot;Sig5&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb114-3" data-line-number="3"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">left_join</span>(<span class="kw">as.data.frame</span>(CNV.seqz.tally.W<span class="op">$</span>nmf_matrix) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb114-4" data-line-number="4"><span class="st">                </span>tibble<span class="op">::</span><span class="kw">rownames_to_column</span>(<span class="st">&quot;sample&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb114-5" data-line-number="5"><span class="st">                </span>dplyr<span class="op">::</span><span class="kw">select</span>(sample, <span class="st">`</span><span class="dt">BPArm[2]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">BPArm[1]</span><span class="st">`</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb114-6" data-line-number="6"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">BK =</span> <span class="st">`</span><span class="dt">BPArm[2]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">BPArm[1]</span><span class="st">`</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb114-7" data-line-number="7"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(BK)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb114-8" data-line-number="8"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">pull</span>(sample)</a>
<a class="sourceLine" id="cb114-9" data-line-number="9"></a>
<a class="sourceLine" id="cb114-10" data-line-number="10">samps_to_show</a>
<a class="sourceLine" id="cb114-11" data-line-number="11"><span class="co">#&gt; [1] &quot;TCGA-EJ-5515-01&quot;    &quot;32-SRR4043905&quot;      &quot;TCGA-EJ-5509-01&quot;   </span></a>
<a class="sourceLine" id="cb114-12" data-line-number="12"><span class="co">#&gt; [4] &quot;6115124-SRR8307108&quot; &quot;1115265-SRR8304838&quot; &quot;TCGA-EJ-5532-01&quot;</span></a>
<a class="sourceLine" id="cb114-13" data-line-number="13"></a>
<a class="sourceLine" id="cb114-14" data-line-number="14"><span class="kw">show_cn_profile</span>(</a>
<a class="sourceLine" id="cb114-15" data-line-number="15">  <span class="dt">data =</span> CNV.seqz, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">show_title =</span> T,</a>
<a class="sourceLine" id="cb114-16" data-line-number="16">  <span class="dt">samples =</span> samps_to_show</a>
<a class="sourceLine" id="cb114-17" data-line-number="17">)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-98-1.png" width="4200" /></p>
</div>
<div id="selected-cases" class="section level3">
<h3>Selected cases</h3>
<p>Select one sample for one case above.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1"><span class="kw">show_cn_profile</span>(</a>
<a class="sourceLine" id="cb115-2" data-line-number="2">  <span class="dt">data =</span> CNV.seqz, <span class="dt">nrow =</span> <span class="dv">6</span>, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">show_title =</span> T,</a>
<a class="sourceLine" id="cb115-3" data-line-number="3">  <span class="dt">samples =</span> <span class="kw">c</span>(<span class="st">&quot;5115056-SRR8311885&quot;</span>, <span class="st">&quot;5115615-SRR8311749&quot;</span>, <span class="st">&quot;TCGA-KK-A7B4-01&quot;</span>, <span class="st">&quot;TCGA-KK-A59X-01&quot;</span>, <span class="st">&quot;TCGA-KC-A7FE-01&quot;</span>)</a>
<a class="sourceLine" id="cb115-4" data-line-number="4">)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-99-1.png" width="2100" /></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" data-line-number="1"><span class="kw">pdf</span>(<span class="st">&quot;Selected_cases_circos_heatmap.pdf&quot;</span>, <span class="dt">width =</span> <span class="fl">2.5</span>, <span class="dt">height =</span> <span class="dv">13</span>)</a>
<a class="sourceLine" id="cb116-2" data-line-number="2">samps =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5115056-SRR8311885&quot;</span>, <span class="st">&quot;5115615-SRR8311749&quot;</span>, <span class="st">&quot;TCGA-KK-A7B4-01&quot;</span>, <span class="st">&quot;TCGA-KK-A59X-01&quot;</span>, <span class="st">&quot;TCGA-KC-A7FE-01&quot;</span>)</a>
<a class="sourceLine" id="cb116-3" data-line-number="3"></a>
<a class="sourceLine" id="cb116-4" data-line-number="4">opar =<span class="st"> </span><span class="kw">par</span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb116-5" data-line-number="5"><span class="kw">print</span>(<span class="kw">par</span>(<span class="st">&quot;mar&quot;</span>))</a>
<a class="sourceLine" id="cb116-6" data-line-number="6"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb116-7" data-line-number="7"></a>
<a class="sourceLine" id="cb116-8" data-line-number="8"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">ncol =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb116-9" data-line-number="9"><span class="cf">for</span> (samp <span class="cf">in</span> samps) {</a>
<a class="sourceLine" id="cb116-10" data-line-number="10">  circlize<span class="op">::</span><span class="kw">circos.par</span>(<span class="dt">track.margin=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) </a>
<a class="sourceLine" id="cb116-11" data-line-number="11">  <span class="kw">show_cn_circos</span>(CNV.seqz, <span class="dt">samples =</span> samp, <span class="dt">show_title =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb116-12" data-line-number="12">               <span class="dt">col =</span> circlize<span class="op">::</span><span class="kw">colorRamp2</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>)),</a>
<a class="sourceLine" id="cb116-13" data-line-number="13">               <span class="dt">line_lwd =</span> <span class="kw">par</span>(<span class="st">&quot;lwd&quot;</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb116-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb116-15" data-line-number="15"><span class="kw">layout</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb116-16" data-line-number="16"><span class="kw">par</span>(opar)</a>
<a class="sourceLine" id="cb116-17" data-line-number="17"><span class="kw">dev.off</span>()</a></code></pre></div>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1"><span class="co"># p_gg = show_cn_profile(</span></a>
<a class="sourceLine" id="cb117-2" data-line-number="2"><span class="co">#   data = CNV.seqz, nrow = 6, ncol = 1, show_title = T,</span></a>
<a class="sourceLine" id="cb117-3" data-line-number="3"><span class="co">#   samples = samps</span></a>
<a class="sourceLine" id="cb117-4" data-line-number="4"><span class="co"># )</span></a>
<a class="sourceLine" id="cb117-5" data-line-number="5"><span class="co"># </span></a>
<a class="sourceLine" id="cb117-6" data-line-number="6"><span class="co"># p_base = function() {</span></a>
<a class="sourceLine" id="cb117-7" data-line-number="7"><span class="co">#   opar = par(no.readonly = TRUE)</span></a>
<a class="sourceLine" id="cb117-8" data-line-number="8"><span class="co">#   par(mar = c(0, 0, 0, 0))</span></a>
<a class="sourceLine" id="cb117-9" data-line-number="9"><span class="co">#   on.exit(par(opar))</span></a>
<a class="sourceLine" id="cb117-10" data-line-number="10"><span class="co">#   </span></a>
<a class="sourceLine" id="cb117-11" data-line-number="11"><span class="co">#   layout(matrix(1:5, ncol = 1))</span></a>
<a class="sourceLine" id="cb117-12" data-line-number="12"><span class="co">#   show_cn_circos(CNV.seqz, samples = samps, show_title = FALSE, line_lwd = par(&quot;lwd&quot;) / 4)</span></a>
<a class="sourceLine" id="cb117-13" data-line-number="13"><span class="co">#   layout(1)</span></a>
<a class="sourceLine" id="cb117-14" data-line-number="14"><span class="co"># }</span></a>
<a class="sourceLine" id="cb117-15" data-line-number="15"></a>
<a class="sourceLine" id="cb117-16" data-line-number="16"><span class="co"># cowplot::plot_grid(</span></a>
<a class="sourceLine" id="cb117-17" data-line-number="17"><span class="co">#   p_gg,</span></a>
<a class="sourceLine" id="cb117-18" data-line-number="18"><span class="co">#   p_base,</span></a>
<a class="sourceLine" id="cb117-19" data-line-number="19"><span class="co">#   rel_widths = c(3, 1),</span></a>
<a class="sourceLine" id="cb117-20" data-line-number="20"><span class="co">#   scale = c(1.0, 0.9)</span></a>
<a class="sourceLine" id="cb117-21" data-line-number="21"><span class="co"># )</span></a></code></pre></div>
</div>
</div>
</div>
<div id="survival-analysis" class="section level1">
<h1>Survival Analysis</h1>
<p>To check the clinical relavance of signatures, this part we do survival analysis with Cox model.</p>
<div id="prepare-1" class="section level2">
<h2>Prepare</h2>
<p>Load package <strong>ezcox</strong> for batch Cox analysis.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1"><span class="kw">library</span>(ezcox)</a></code></pre></div>
<p>Load the data.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1">df.seqz =<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;../output/df.seqz.RDS&quot;</span>)</a>
<a class="sourceLine" id="cb119-2" data-line-number="2">surv_df &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;../data/PRAD_Survival.rds&quot;</span>)</a></code></pre></div>
<p>Clean the data to generate a data table for survival analysis.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1">range01 &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...) {</a>
<a class="sourceLine" id="cb120-2" data-line-number="2">  (x <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x, ...)) <span class="op">/</span><span class="st"> </span>(<span class="kw">max</span>(x, ...) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x, ...))</a>
<a class="sourceLine" id="cb120-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb120-4" data-line-number="4"></a>
<a class="sourceLine" id="cb120-5" data-line-number="5">cols_to_sigs.seqz &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;CN-Sig&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>), <span class="kw">paste0</span>(<span class="st">&quot;SBS-Sig&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb120-6" data-line-number="6"></a>
<a class="sourceLine" id="cb120-7" data-line-number="7"></a>
<a class="sourceLine" id="cb120-8" data-line-number="8">surv_dt &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">inner_join</span>(df.seqz <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-9" data-line-number="9"><span class="st">                               </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(<span class="st">&quot;Study&quot;</span>, <span class="st">&quot;subject_id&quot;</span>, <span class="st">&quot;tumor_body_site&quot;</span>,</a>
<a class="sourceLine" id="cb120-10" data-line-number="10">                                                <span class="st">&quot;tumor_Run&quot;</span>, <span class="st">&quot;normal_Run&quot;</span>, <span class="st">&quot;CNV_ID&quot;</span>,</a>
<a class="sourceLine" id="cb120-11" data-line-number="11">                                                <span class="st">&quot;Fusion&quot;</span>, <span class="st">&quot;sample_type&quot;</span>)),</a>
<a class="sourceLine" id="cb120-12" data-line-number="12">                             surv_df, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;PatientID&quot;</span> =<span class="st"> &quot;sample&quot;</span>))</a>
<a class="sourceLine" id="cb120-13" data-line-number="13"></a>
<a class="sourceLine" id="cb120-14" data-line-number="14">dup_ids =<span class="st"> </span><span class="kw">which</span>(<span class="kw">duplicated</span>(surv_dt<span class="op">$</span>PatientID))</a>
<a class="sourceLine" id="cb120-15" data-line-number="15"><span class="co"># Remove duplicated records</span></a>
<a class="sourceLine" id="cb120-16" data-line-number="16">surv_dt =<span class="st"> </span>surv_dt[<span class="op">-</span>dup_ids, ]</a>
<a class="sourceLine" id="cb120-17" data-line-number="17"></a>
<a class="sourceLine" id="cb120-18" data-line-number="18"><span class="co"># Scale the signature exposure to 0-20.</span></a>
<a class="sourceLine" id="cb120-19" data-line-number="19"><span class="co"># To better understand the effect of signature exposure on clinical events,</span></a>
<a class="sourceLine" id="cb120-20" data-line-number="20"><span class="co"># here we scale them into range 0-20. 1 increase means 5% increase of signature exposure.</span></a>
<a class="sourceLine" id="cb120-21" data-line-number="21"><span class="co">#</span></a>
<a class="sourceLine" id="cb120-22" data-line-number="22"><span class="co"># Scale the CNA burden to 0-20.</span></a>
<a class="sourceLine" id="cb120-23" data-line-number="23">surv_dt =<span class="st"> </span>surv_dt <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-24" data-line-number="24"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">cnaBurden =</span> <span class="dv">20</span> <span class="op">*</span><span class="st"> </span>cnaBurden,</a>
<a class="sourceLine" id="cb120-25" data-line-number="25">                <span class="dt">Stage =</span> <span class="kw">as.character</span>(Stage) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;T2&quot;</span>, <span class="st">&quot;T3&quot;</span>, <span class="st">&quot;T4&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-26" data-line-number="26"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(cols_to_sigs.seqz, <span class="op">~</span><span class="st"> </span><span class="dv">20</span> <span class="op">*</span><span class="st"> </span><span class="kw">range01</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb120-27" data-line-number="27"></a>
<a class="sourceLine" id="cb120-28" data-line-number="28"><span class="kw">saveRDS</span>(surv_dt, <span class="dt">file =</span> <span class="st">&quot;../output/PRAD_merged_survival_dt_seqz.rds&quot;</span>)</a></code></pre></div>
</div>
<div id="os-analysis-fo-signatures" class="section level2">
<h2>OS analysis fo signatures</h2>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1"><span class="co">############</span></a>
<a class="sourceLine" id="cb121-2" data-line-number="2">surv_dt &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;../output/PRAD_merged_survival_dt_seqz.rds&quot;</span>)</a>
<a class="sourceLine" id="cb121-3" data-line-number="3">cols_to_sigs.seqz &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;CN-Sig&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>), <span class="kw">paste0</span>(<span class="st">&quot;SBS-Sig&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb121-4" data-line-number="4"></a>
<a class="sourceLine" id="cb121-5" data-line-number="5"><span class="co"># Unvariable analysis</span></a>
<a class="sourceLine" id="cb121-6" data-line-number="6"><span class="kw">show_forest</span>(surv_dt, <span class="dt">covariates =</span> cols_to_sigs.seqz,</a>
<a class="sourceLine" id="cb121-7" data-line-number="7">            <span class="dt">time =</span> <span class="st">&quot;OS.time&quot;</span>, <span class="dt">status =</span> <span class="st">&quot;OS&quot;</span>, <span class="dt">merge_models =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-105-1.png" width="2400" /></p>
</div>
<div id="pfs-analysis-for-signatures" class="section level2">
<h2>PFS analysis for signatures</h2>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1"><span class="kw">show_forest</span>(surv_dt, <span class="dt">covariates =</span> cols_to_sigs.seqz,</a>
<a class="sourceLine" id="cb122-2" data-line-number="2">            <span class="dt">time =</span> <span class="st">&quot;PFI.time&quot;</span>, <span class="dt">status =</span> <span class="st">&quot;PFI&quot;</span>, <span class="dt">merge_models =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-106-1.png" width="2400" /></p>
</div>
<div id="os-analysis-for-features" class="section level2">
<h2>OS analysis for features</h2>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" data-line-number="1">cols_to_features &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb123-2" data-line-number="2">  <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Stage&quot;</span>, <span class="st">&quot;GleasonScore&quot;</span>,</a>
<a class="sourceLine" id="cb123-3" data-line-number="3">  <span class="st">&quot;n_SNV&quot;</span>, <span class="st">&quot;n_driver&quot;</span>, </a>
<a class="sourceLine" id="cb123-4" data-line-number="4">  <span class="co"># &quot;n_INDEL&quot;,</span></a>
<a class="sourceLine" id="cb123-5" data-line-number="5">  <span class="st">&quot;Ti_fraction&quot;</span>, <span class="st">&quot;Tv_fraction&quot;</span>,</a>
<a class="sourceLine" id="cb123-6" data-line-number="6">  <span class="st">&quot;cnaBurden&quot;</span>, <span class="st">&quot;n_CNV&quot;</span>, <span class="st">&quot;n_Amp&quot;</span>, <span class="st">&quot;n_Del&quot;</span>, <span class="st">&quot;ploidy&quot;</span>,</a>
<a class="sourceLine" id="cb123-7" data-line-number="7">  <span class="st">&quot;TD score&quot;</span>,</a>
<a class="sourceLine" id="cb123-8" data-line-number="8">  <span class="co"># &quot;sTD score&quot;, &quot;lTD score&quot;, </span></a>
<a class="sourceLine" id="cb123-9" data-line-number="9">  <span class="st">&quot;Chromothripisis score&quot;</span>, <span class="st">&quot;MACN score&quot;</span>,</a>
<a class="sourceLine" id="cb123-10" data-line-number="10">  <span class="st">&quot;MATH&quot;</span>, <span class="st">&quot;n_mutation_cluster&quot;</span>, <span class="st">&quot;purity&quot;</span></a>
<a class="sourceLine" id="cb123-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb123-12" data-line-number="12"></a>
<a class="sourceLine" id="cb123-13" data-line-number="13"><span class="kw">show_forest</span>(surv_dt,</a>
<a class="sourceLine" id="cb123-14" data-line-number="14">            <span class="dt">covariates =</span> cols_to_features, <span class="dt">controls =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb123-15" data-line-number="15">            <span class="dt">time =</span> <span class="st">&quot;OS.time&quot;</span>, <span class="dt">status =</span> <span class="st">&quot;OS&quot;</span>, <span class="dt">merge_models =</span> <span class="ot">TRUE</span>, <span class="dt">limits =</span> <span class="kw">log</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">10</span>)))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-107-1.png" width="2400" /></p>
</div>
<div id="pfs-analysis-for-features" class="section level2">
<h2>PFS analysis for features</h2>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" data-line-number="1"><span class="kw">show_forest</span>(surv_dt,</a>
<a class="sourceLine" id="cb124-2" data-line-number="2">            <span class="dt">covariates =</span> cols_to_features, <span class="dt">controls =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb124-3" data-line-number="3">            <span class="dt">time =</span> <span class="st">&quot;PFI.time&quot;</span>, <span class="dt">status =</span> <span class="st">&quot;PFI&quot;</span>, <span class="dt">merge_models =</span> <span class="ot">TRUE</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="kw">log</span>(<span class="fl">0.5</span>), <span class="kw">log</span>(<span class="dv">5</span>)))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-108-1.png" width="2400" /></p>
</div>
</div>
<div id="variation-summary" class="section level1">
<h1>Variation Summary</h1>
<p>This part discribes some big pictures of genomic variations in prostate cancers. They are not directly related to the core analyses previously reported.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" data-line-number="1"><span class="kw">library</span>(sigminer)</a>
<a class="sourceLine" id="cb125-2" data-line-number="2"><span class="kw">library</span>(maftools)</a>
<a class="sourceLine" id="cb125-3" data-line-number="3"></a>
<a class="sourceLine" id="cb125-4" data-line-number="4"><span class="kw">load</span>(<span class="st">&quot;../output/CNV.seqz.RData&quot;</span>)</a>
<a class="sourceLine" id="cb125-5" data-line-number="5"><span class="kw">load</span>(<span class="st">&quot;../output/CNV.seqz.tally.W.RData&quot;</span>)</a>
<a class="sourceLine" id="cb125-6" data-line-number="6"><span class="kw">load</span>(<span class="st">&quot;../output/PRAD_TCGA_plus_dbGap_Maf.RData&quot;</span>)</a></code></pre></div>
<div id="oncoplot" class="section level2">
<h2>Oncoplot</h2>
<p>A simple oncoplot.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" data-line-number="1"><span class="kw">oncoplot</span>(<span class="dt">maf =</span> Maf, <span class="dt">top =</span> <span class="dv">10</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-110-1.png" width="2400" /></p>
<blockquote>
<p>Refernce Maftools vignette: <a href="http://bioconductor.org/packages/release/bioc/vignettes/maftools/inst/doc/oncoplots.html" class="uri">http://bioconductor.org/packages/release/bioc/vignettes/maftools/inst/doc/oncoplots.html</a></p>
</blockquote>
<p>To get a comprehensive and meaningful oncoplot (not affected by passagers), here we include GISTIC2, MutSig and MAF information together.</p>
<p>Before plotting, I will go to modify a result file from GISTIC2, this file uses a different sample ID system as MAF, so we must keep them same.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" data-line-number="1">all.lesions &lt;-<span class="st"> &quot;../data/all_lesions.conf_99.txt&quot;</span></a>
<a class="sourceLine" id="cb127-2" data-line-number="2">dt =<span class="st"> </span>data.table<span class="op">::</span><span class="kw">fread</span>(all.lesions)</a>
<a class="sourceLine" id="cb127-3" data-line-number="3">dt_names =<span class="st"> </span><span class="kw">colnames</span>(dt)</a>
<a class="sourceLine" id="cb127-4" data-line-number="4"></a>
<a class="sourceLine" id="cb127-5" data-line-number="5">dt_names2 =<span class="st"> </span>dt_names</a>
<a class="sourceLine" id="cb127-6" data-line-number="6">dt_names =<span class="st"> </span><span class="kw">ifelse</span>(</a>
<a class="sourceLine" id="cb127-7" data-line-number="7">  stringr<span class="op">::</span><span class="kw">str_detect</span>(dt_names, <span class="st">&quot;SRR&quot;</span>),</a>
<a class="sourceLine" id="cb127-8" data-line-number="8">  stringr<span class="op">::</span><span class="kw">str_extract</span>(dt_names, <span class="st">&quot;SRR[0-9]+$&quot;</span>),</a>
<a class="sourceLine" id="cb127-9" data-line-number="9">  dt_names</a>
<a class="sourceLine" id="cb127-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb127-11" data-line-number="11"><span class="kw">names</span>(dt_names) =<span class="st"> </span>dt_names2</a>
<a class="sourceLine" id="cb127-12" data-line-number="12"></a>
<a class="sourceLine" id="cb127-13" data-line-number="13">maf_names =<span class="st"> </span>maftools<span class="op">::</span><span class="kw">getSampleSummary</span>(Maf)<span class="op">$</span>Tumor_Sample_Barcode <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()</a>
<a class="sourceLine" id="cb127-14" data-line-number="14">tcga_names =<span class="st"> </span>maf_names[<span class="kw">startsWith</span>(maf_names, <span class="st">&quot;TCGA&quot;</span>)]</a>
<a class="sourceLine" id="cb127-15" data-line-number="15"><span class="kw">names</span>(tcga_names) =<span class="st"> </span><span class="kw">substr</span>(tcga_names, <span class="dv">1</span>, <span class="dv">15</span>)</a>
<a class="sourceLine" id="cb127-16" data-line-number="16"></a>
<a class="sourceLine" id="cb127-17" data-line-number="17">dt_names[<span class="kw">startsWith</span>(dt_names, <span class="st">&quot;TCGA&quot;</span>)] =<span class="st"> </span>tcga_names[dt_names[<span class="kw">startsWith</span>(dt_names, <span class="st">&quot;TCGA&quot;</span>)]]</a>
<a class="sourceLine" id="cb127-18" data-line-number="18">dt_names[<span class="kw">is.na</span>(dt_names)] =<span class="st"> </span><span class="kw">names</span>(dt_names[<span class="kw">is.na</span>(dt_names)])</a>
<a class="sourceLine" id="cb127-19" data-line-number="19"></a>
<a class="sourceLine" id="cb127-20" data-line-number="20"></a>
<a class="sourceLine" id="cb127-21" data-line-number="21"><span class="kw">colnames</span>(dt) =<span class="st"> </span>dt_names <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()</a>
<a class="sourceLine" id="cb127-22" data-line-number="22">data.table<span class="op">::</span><span class="kw">fwrite</span>(dt, <span class="dt">file =</span> <span class="st">&quot;../data/all_lesions.conf_99_v2.txt&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" data-line-number="1"><span class="co"># GISTIC2 data</span></a>
<a class="sourceLine" id="cb128-2" data-line-number="2">all.lesions &lt;-<span class="st"> &quot;../data/all_lesions.conf_99_v2.txt&quot;</span></a>
<a class="sourceLine" id="cb128-3" data-line-number="3">amp.genes &lt;-<span class="st"> &quot;../data/amp_genes.conf_99.txt&quot;</span></a>
<a class="sourceLine" id="cb128-4" data-line-number="4">del.genes &lt;-<span class="st"> &quot;../data/del_genes.conf_99.txt&quot;</span></a>
<a class="sourceLine" id="cb128-5" data-line-number="5">scores.gis &lt;-<span class="st"> &quot;../data/scores.gistic&quot;</span></a>
<a class="sourceLine" id="cb128-6" data-line-number="6"></a>
<a class="sourceLine" id="cb128-7" data-line-number="7"><span class="co"># MutSig2CV data</span></a>
<a class="sourceLine" id="cb128-8" data-line-number="8">mutsig &lt;-<span class="st"> &quot;../data/PRAD.sig_genes.txt&quot;</span></a>
<a class="sourceLine" id="cb128-9" data-line-number="9"></a>
<a class="sourceLine" id="cb128-10" data-line-number="10">maf_plus_gistic &lt;-<span class="st"> </span><span class="kw">read.maf</span>(</a>
<a class="sourceLine" id="cb128-11" data-line-number="11">  <span class="dt">maf =</span> <span class="kw">rbind</span>(Maf<span class="op">@</span>data, Maf<span class="op">@</span>maf.silent),</a>
<a class="sourceLine" id="cb128-12" data-line-number="12">  <span class="dt">gisticAllLesionsFile =</span> all.lesions,</a>
<a class="sourceLine" id="cb128-13" data-line-number="13">  <span class="dt">gisticAmpGenesFile =</span> amp.genes, <span class="dt">gisticDelGenesFile =</span> del.genes,</a>
<a class="sourceLine" id="cb128-14" data-line-number="14">  <span class="dt">gisticScoresFile =</span> scores.gis, <span class="dt">isTCGA =</span> <span class="ot">FALSE</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb128-15" data-line-number="15">)</a></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1"><span class="kw">oncoplot</span>(maf_plus_gistic,</a>
<a class="sourceLine" id="cb129-2" data-line-number="2">  <span class="dt">mutsig =</span> mutsig, <span class="dt">mutsigQval =</span> <span class="fl">0.05</span>, <span class="dt">sortByMutation =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb129-3" data-line-number="3">  <span class="dt">logColBar =</span> <span class="ot">TRUE</span>, <span class="dt">sepwd_samples =</span> <span class="dv">0</span>, <span class="dt">draw_titv =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb129-4" data-line-number="4">)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-113-1.png" width="2400" /></p>
<p>Remove GISTIC2 data from oncoplot.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" data-line-number="1"><span class="kw">oncoplot</span>(Maf,</a>
<a class="sourceLine" id="cb130-2" data-line-number="2">  <span class="dt">mutsig =</span> mutsig, <span class="dt">mutsigQval =</span> <span class="fl">0.05</span>, <span class="dt">sortByMutation =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb130-3" data-line-number="3">  <span class="dt">logColBar =</span> <span class="ot">TRUE</span>, <span class="dt">sepwd_samples =</span> <span class="dv">0</span>, <span class="dt">draw_titv =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb130-4" data-line-number="4">)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-114-1.png" width="2400" /></p>
</div>
<div id="sample-summary" class="section level2">
<h2>Sample summary</h2>
<p>Here we summarize variations for each sample with table.</p>
<div id="copy-number-data" class="section level3">
<h3>Copy number data</h3>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" data-line-number="1">DT<span class="op">::</span><span class="kw">datatable</span>(CNV.seqz<span class="op">@</span>summary.per.sample)</a></code></pre></div>
<div id="htmlwidget-eaae6ca894d4b4f8c904" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-eaae6ca894d4b4f8c904">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937"],["TCGA-HI-7169-01","TCGA-CH-5743-01","TCGA-EJ-7791-01","TCGA-FC-A66V-01","TCGA-J4-AATV-01","TCGA-KC-A7FE-01","TCGA-YL-A8SI-01","09-120-SRR460104","TCGA-EJ-7793-01","TCGA-EJ-A65G-01","TCGA-J4-A83L-01","TCGA-J4-AAU2-01","TCGA-XJ-A9DQ-01","TCGA-G9-7519-01","TCGA-HC-8258-01","TCGA-HC-A8D1-01","TCGA-J4-A67T-01","TCGA-J4-A6G3-01","TCGA-J9-A52C-01","TCGA-KK-A8IL-01","TCGA-ZG-A8QZ-01","TCGA-ZG-A9L4-01","3-SRR5876742","TCGA-CH-5763-01","TCGA-EJ-5508-01","TCGA-EJ-7785-01","TCGA-EJ-A46E-01","TCGA-EJ-A7NG-01","TCGA-EJ-A7NJ-01","TCGA-EJ-A8FO-01","TCGA-EJ-AB20-01","TCGA-G9-6356-01","TCGA-HC-7817-01","TCGA-V1-A9ZG-01","TCGA-VP-A87E-01","TCGA-X4-A8KS-01","TCGA-XK-AAJU-01","03-2620-SRR463012","04-594-SRR459996","06-1696-SRR458657","08-2516-SRR464805","STID0000002872-SRR477710","TCGA-EJ-7331-01","TCGA-EJ-A8FP-01","TCGA-EJ-A8FU-01","TCGA-G9-6347-01","TCGA-H9-A6BX-01","TCGA-HC-7079-01","TCGA-J4-8198-01","TCGA-VN-A88I-01","TCGA-XA-A8JR-01","TCGA-XK-AAIR-01","TCGA-XK-AAIW-01","TCGA-YL-A8HJ-01","08-590-SRR460086","TCGA-CH-5769-01","TCGA-EJ-7125-01","TCGA-EJ-7218-01","TCGA-EJ-A46B-01","TCGA-EJ-A6RA-01","TCGA-G9-6336-01","TCGA-G9-6353-01","TCGA-G9-6365-01","TCGA-G9-6367-01","TCGA-G9-6385-01","TCGA-G9-6498-01","TCGA-HC-A6AQ-01","TCGA-HC-A76X-01","TCGA-KK-A8IM-01","TCGA-V1-A8ML-01","TCGA-V1-A8WN-01","03-3391-SRR462988","04-2666-SRR458519","06-2325-SRR473245","STID0000002761-SRR478063","TCGA-EJ-7797-01","TCGA-FC-A6HD-01","TCGA-FC-A8O0-01","TCGA-G9-7522-01","TCGA-HC-7820-01","TCGA-J4-8200-01","TCGA-J4-A83N-01","TCGA-KC-A4BR-01","TCGA-QU-A6IP-01","TCGA-V1-A8MK-01","TCGA-V1-A8MU-01","TCGA-V1-A9OQ-01","TCGA-VN-A88O-01","TCGA-XJ-A9DK-01","TCGA-ZG-A8QW-01","03-595-SRR473840","03-871-SRR473816","07-5036-SRR464787","09-1372-SRR474935","1-SRR5876699","TCGA-2A-A8VO-01","TCGA-EJ-A46I-01","TCGA-G9-6351-01","TCGA-H9-7775-01","TCGA-HC-8213-01","TCGA-HC-A6AL-01","TCGA-HC-A6AS-01","TCGA-J4-A83M-01","TCGA-XJ-A83H-01","TCGA-XK-AAJR-01","WCMC21014-SRR3146936","05-3440-SRR461561","05-3829-SRR472015","21510-SRR3146833","STID0000003026-SRR477172","TCGA-CH-5746-01","TCGA-EJ-5498-01","TCGA-EJ-5512-01","TCGA-EJ-A7NF-01","TCGA-G9-7510-01","TCGA-H9-A6BY-01","TCGA-HC-7075-01","TCGA-HC-7818-01","TCGA-HC-8256-01","TCGA-J4-A67K-01","TCGA-KC-A7F3-01","TCGA-KC-A7FD-01","TCGA-KK-A6E2-01","TCGA-M7-A723-01","TCGA-VN-A88M-01","TCGA-VP-A879-01","TCGA-Y6-A8TL-01","02-169-SRR471289","02-2480-SRR462128","1115349-SRR8304843","12730-SRR3146839","STID0000002762-SRR477947","TCGA-CH-5738-01","TCGA-EJ-5505-01","TCGA-EJ-5522-01","TCGA-EJ-8468-01","TCGA-G9-6384-01","TCGA-G9-6494-01","TCGA-G9-A9S7-01","TCGA-HC-A6AP-01","TCGA-KK-A8I9-01","TCGA-QU-A6IO-01","TCGA-V1-A9OH-01","TCGA-V1-A9OY-01","TCGA-V1-A9Z8-01","TCGA-VN-A88N-01","TCGA-VN-A943-01","TCGA-VP-A878-01","04-194-SRR468361","20990-SRR3146978","TCGA-2A-A8VL-01","TCGA-2A-AAYF-01","TCGA-EJ-7321-01","TCGA-EJ-7786-01","TCGA-EJ-A65E-01","TCGA-EJ-A8FN-01","TCGA-G9-6339-01","TCGA-G9-6364-01","TCGA-J4-A67L-01","TCGA-J4-A67S-01","TCGA-J4-A6M7-01","TCGA-KC-A4BO-01","TCGA-KC-A7F6-01","TCGA-KK-A6E3-01","TCGA-KK-A6E5-01","TCGA-M7-A720-01","TCGA-QU-A6IM-01","TCGA-V1-A9O9-01","TCGA-V1-A9OX-01","TCGA-VP-A87H-01","04-1367-SRR468685","04-3113-SRR468985","05-2212-SRR472129","TCGA-2A-A8W3-01","TCGA-EJ-5499-01","TCGA-EJ-7317-01","TCGA-EJ-A46H-01","TCGA-G9-7509-01","TCGA-HC-7210-01","TCGA-KK-A7B1-01","TCGA-KK-A8IG-01","TCGA-V1-A8WL-01","TCGA-V1-A9ZK-01","TCGA-ZG-A8QY-01","WCMC10-SRR3146888","03-2345-SRR465789","TCGA-2A-AAYO-01","TCGA-EJ-5517-01","TCGA-EJ-7318-01","TCGA-EJ-7328-01","TCGA-EJ-A65J-01","TCGA-FC-A5OB-01","TCGA-G9-6342-01","TCGA-G9-6348-01","TCGA-G9-6362-01","TCGA-G9-6371-01","TCGA-HC-8266-01","TCGA-J4-A6G1-01","TCGA-J4-A83J-01","TCGA-KC-A4BN-01","TCGA-TK-A8OK-01","TCGA-V1-A8X3-01","TCGA-YL-A8HK-01","TCGA-ZG-A9L2-01","TCGA-ZG-A9L6-01","03-1906-SRR465813","04-1790-SRR468313","05-3859-SRR465129","STID0000002661-SRR477829","TCGA-EJ-5503-01","TCGA-EJ-7314-01","TCGA-EJ-A6RC-01","TCGA-G9-6343-01","TCGA-G9-6361-01","TCGA-HC-A76W-01","TCGA-HC-A8D0-01","TCGA-J9-A8CK-01","TCGA-KK-A59V-01","TCGA-KK-A8I6-01","TCGA-KK-A8IJ-01","TCGA-M7-A722-01","TCGA-SU-A7E7-01","TCGA-XJ-A83G-01","00-1165-SRR461844","01-2382-SRR471433","02-2072-SRR462267","04-2641-SRR458543","12729-SRR3146834","2-SRR5876731","STID0000001043-SRR477408","STID0000003034-SRR478241","TCGA-G9-6370-01","TCGA-HC-8262-01","TCGA-J4-A67R-01","TCGA-KK-A6E0-01","TCGA-KK-A7AY-01","TCGA-KK-A7B2-01","TCGA-V1-A9Z9-01","TCGA-VP-A872-01","TCGA-YL-A8SH-01","TCGA-ZG-A9LY-01","06-1125-SRR458633","07-360-SRR461489","07-684-SRR466841","07-718-SRR466557","22171-SRR3146955","TCGA-2A-A8VX-01","TCGA-CH-5737-01","TCGA-CH-5764-01","TCGA-EJ-7788-01","TCGA-EJ-7792-01","TCGA-EJ-8470-01","TCGA-EJ-A65M-01","TCGA-EJ-AB27-01","TCGA-G9-6333-01","TCGA-G9-6378-01","TCGA-HC-7081-01","TCGA-HC-7209-01","TCGA-HC-7232-01","TCGA-J4-A83K-01","TCGA-M7-A721-01","TCGA-V1-A8MJ-01","TCGA-YL-A8SC-01","06-4428-SRR461441","09-2497-SRR474977","STID0000002740-SRR477889","TCGA-CH-5752-01","TCGA-EJ-5497-01","TCGA-EJ-7327-01","TCGA-EJ-A65F-01","TCGA-EJ-A7NK-01","TCGA-EJ-A8FS-01","TCGA-G9-6379-01","TCGA-HC-7819-01","TCGA-HC-8260-01","TCGA-HC-8261-01","TCGA-KK-A7AW-01","TCGA-M7-A71Y-01","TCGA-V1-A8MF-01","TCGA-V1-A9OT-01","TCGA-VN-A88Q-01","TCGA-VP-A87C-01","TCGA-YL-A8SB-01","TCGA-YL-A9WJ-01","TCGA-ZG-A9LS-01","05-3595-SRR472882","1115245-SRR8304830","20630-SRR3146915","STID0000003023-SRR477114","TCGA-2A-A8VV-01","TCGA-2A-AAYU-01","TCGA-CH-5765-01","TCGA-EJ-5530-01","TCGA-G9-7525-01","TCGA-HC-7230-01","TCGA-J4-A67M-01","TCGA-J4-A67O-01","TCGA-KC-A4BL-01","TCGA-KK-A8I5-01","TCGA-V1-A8MG-01","TCGA-X4-A8KQ-01","TCGA-XJ-A9DI-01","TCGA-XK-AAJP-01","TCGA-XK-AAK1-01","TCGA-YL-A8HL-01","05-2594-SRR472153","06-3676-SRR458681","STID0000003127-SRR486768","TCGA-EJ-5496-01","TCGA-EJ-A46D-01","TCGA-EJ-A65B-01","TCGA-G9-6366-01","TCGA-G9-A9S0-01","TCGA-J4-A67Q-01","TCGA-KK-A7B0-01","TCGA-KK-A8IA-01","TCGA-QU-A6IL-01","TCGA-V1-A9Z7-01","TCGA-YL-A8S9-01","TCGA-YL-A8SF-01","TCGA-YL-A8SR-01","WCMC7951-SRR3146812","STID0000002916-SRR477650","TCGA-CH-5739-01","TCGA-EJ-5501-01","TCGA-EJ-A7NN-01","TCGA-G9-6329-01","TCGA-G9-6338-01","TCGA-HC-7231-01","TCGA-HC-8264-01","TCGA-HC-A6HX-01","TCGA-HC-A6HY-01","TCGA-MG-AAMC-01","TCGA-V1-A9O5-01","TCGA-V1-A9ZI-01","TCGA-YL-A8SK-01","TCGA-ZG-A9ND-01","TCGA-ZG-A9NI-01","00-000450-SRR474658","09-5702-SRR485302","09-649-SRR460152","TCGA-CH-5750-01","TCGA-EJ-5502-01","TCGA-EJ-5527-01","TCGA-EJ-5542-01","TCGA-EJ-A7NM-01","TCGA-G9-6363-01","TCGA-J9-A8CM-01","TCGA-J9-A8CP-01","TCGA-KK-A8I7-01","TCGA-TP-A8TT-01","TCGA-V1-A9OA-01","TCGA-V1-A9ZR-01","TCGA-VN-A88R-01","TCGA-YL-A8SO-01","00-160-SRR471373","03-870-SRR473924","04-1421-SRR468337","STID0000000099-SRR477230","TCGA-CH-5768-01","TCGA-EJ-7325-01","TCGA-EJ-7781-01","TCGA-EJ-A46F-01","TCGA-G9-6373-01","TCGA-HC-A6AO-01","TCGA-HC-A8CY-01","TCGA-KK-A59Y-01","TCGA-QU-A6IN-01","TCGA-V1-A8MM-01","TCGA-YL-A9WX-01","TCGA-ZG-A9MC-01","TCGA-CH-5762-01","TCGA-KK-A8IH-01","02-1736-SRR472556","03-1026-SRR468565","09-5245-SRR468174","STID0000002682-SRR478005","STID0000003035-SRR478299","TCGA-CH-5744-01","TCGA-CH-5745-01","TCGA-HC-7233-01","TCGA-KC-A7F5-01","TCGA-KK-A8I8-01","TCGA-KK-A8II-01","TCGA-V1-A8WW-01","TCGA-XK-AAJ3-01","TCGA-YL-A8SA-01","TCGA-YL-A8SP-01","WCMC21010-SRR3146929","04-2740-SRR464997","04-903-SRR472177","13-SRR4043923","TCGA-CH-5767-01","TCGA-CH-5794-01","TCGA-EJ-5526-01","TCGA-EJ-5532-01","TCGA-EJ-7330-01","TCGA-G9-6496-01","TCGA-HC-A6AN-01","TCGA-KK-A7AV-01","TCGA-KK-A7AZ-01","TCGA-XK-AAJT-01","WCMC7-SRR3146725","09-2744-SRR474438","51-SRR4043795","TCGA-CH-5753-01","TCGA-CH-5771-01","TCGA-EJ-7782-01","TCGA-HC-8259-01","TCGA-J4-A83I-01","TCGA-KC-A4BV-01","TCGA-KK-A7AQ-01","TCGA-XK-AAJA-01","03-22-SRR471013","05-3852-SRR472039","06-3939-SRR461465","1115265-SRR8304838","5115025-SRR8311840","STID0000003051-SRR478181","TCGA-CH-5772-01","TCGA-EJ-5510-01","TCGA-HC-7078-01","TCGA-J9-A8CN-01","TCGA-VP-A87B-01","TCGA-VP-A87J-01","02-2035-SRR471241","07-837-SRR466629","TCGA-EJ-5506-01","TCGA-EJ-5518-01","TCGA-EJ-A65D-01","TCGA-J9-A52D-01","TCGA-YL-A8S8-01","TCGA-YL-A9WI-01","02-1082-SRR472616","05-620-SRR459972","6115119-SRR8307103","6115401-SRR8307136","TCGA-CH-5792-01","TCGA-EJ-5531-01","TCGA-EJ-7115-01","TCGA-EJ-7123-01","TCGA-G9-6369-01","TCGA-VN-A88K-01","09-3566-SRR465510","09-5446-SRR473087","54-SRR4043960","TCGA-2A-A8W1-01","TCGA-EJ-7315-01","TCGA-HC-7737-01","TCGA-KK-A7AU-01","TCGA-KK-A8I4-01","TCGA-XJ-A83F-01","55-SRR4043933","TCGA-EJ-5509-01","TCGA-G9-7523-01","TCGA-HC-7080-01","TCGA-HC-A48F-01","TCGA-M7-A724-01","WCMC26731-SRR3146951","6115116-SRR8307101","TCGA-EJ-5504-01","TCGA-EJ-5521-01","TCGA-HC-8257-01","04-1084-SRR470000","06-1651-SRR472417","TCGA-EJ-5519-01","TCGA-EJ-5524-01","TCGA-EJ-8474-01","TCGA-HC-A4ZV-01","04-3222-SRR468925","09-5630-SRR485163","1115244-SRR2404302","45-SRR4043909","6115124-SRR8307108","TCGA-J4-A67N-01","01-1934-SRR471793","02-1899-SRR462188","03-1426-SRR465855","21011-SRR3146793","STID0000000415-SRR477466","TCGA-XQ-A8TB-01","TCGA-YL-A9WH-01","WCMC10362-SRR3146940","WCMC21017-SRR3146755","00-1823-SRR471613","TCGA-4L-AA1F-01","TCGA-EJ-A46G-01","TCGA-KK-A59X-01","TCGA-V1-A9OF-01","TCGA-YL-A8HO-01","TCGA-ZG-A9L1-01","TCGA-ZG-A9LM-01","TCGA-ZG-A9LU-01","01-2554-SRR471673","06-1999-SRR472357","1115311-SRR8307498","6115321-SRR8316704","TCGA-EJ-5494-01","TCGA-EJ-5495-01","TCGA-HC-7752-01","TCGA-KK-A7AP-01","TCGA-KK-A7B3-01","WCMC11040-SRR3146815","09-2517-SRR474359","09-5094-SRR473166","1115343-SRR8304837","2746-SRR3146821","TCGA-G9-6354-01","TCGA-G9-A9S4-01","TCGA-HC-7211-01","TCGA-V1-A9O7-01","37-SRR4043990","STID0000002858-SRR477592","TCGA-CH-5788-01","TCGA-KK-A6E8-01","1115150-SRR8304824","38-SRR4043964","TCGA-CH-5789-01","TCGA-CH-5791-01","TCGA-EJ-5511-01","TCGA-HC-A9TE-01","TCGA-KK-A6E7-01","TCGA-VN-A88L-01","TCGA-ZG-A9LB-01","21020-SRR3146741","24-SRR4043997","TCGA-EJ-5507-01","TCGA-VP-AA1N-01","TCGA-YL-A8SQ-01","06-1749-SRR472297","1115305-SRR8324618","40-SRR4043957","TCGA-CH-5741-01","TCGA-CH-5748-01","TCGA-J9-A52B-01","TCGA-KK-A6DY-01","TCGA-KK-A6E1-01","TCGA-M7-A725-01","05-839-SRR465021","TCGA-EJ-8469-01","TCGA-HC-A631-01","TCGA-KK-A8IB-01","WCMC20870-SRR3146776","1115085-SRR8304748","TCGA-EJ-5515-01","TCGA-EJ-7784-01","TCGA-EJ-7794-01","TCGA-Y6-A9XI-01","TCGA-YL-A8SJ-01","03-1334-SRR474068","TCGA-G9-7521-01","TCGA-HC-7748-01","TCGA-J9-A52E-01","TCGA-WW-A8ZI-01","30-SRR5876743","TCGA-CH-5790-01","TCGA-EJ-A7NH-01","TCGA-FC-7708-01","TCGA-KK-A59Z-01","WCMC1-SRR3146926","04-2599-SRR458567","05-3436-SRR472063","16-SRR4043929","6115236-SRR8307106","74-SRR4043949","TCGA-KK-A8IC-01","TCGA-V1-A8WV-01","TCGA-YL-A8HM-01","32-SRR4043905","TCGA-CH-5754-01","TCGA-J4-AATZ-01","TCGA-KK-A6E6-01","TCGA-VN-A88P-01","TCGA-YL-A8SL-01","TCGA-YL-A9WL-01","TCGA-ZG-A9L5-01","5115027-SRR8311849","73-SRR4043902","TCGA-2A-A8VT-01","TCGA-G9-6377-01","TCGA-XK-AAIV-01","09-1580-SRR474953","09-3421-SRR465213","41-SRR5876755","STID0000003048-SRR478121","TCGA-CH-5740-01","TCGA-KK-A8IK-01","TCGA-V1-A8WS-01","STID0000003036-SRR478357","TCGA-EJ-7783-01","TCGA-HC-8265-01","TCGA-TP-A8TV-01","TCGA-ZG-A9M4-01","02-254-SRR474116","1115089-SRR8304758","1115092-SRR8304757","TCGA-EJ-5525-01","TCGA-EJ-7312-01","TCGA-KK-A8IF-01","TCGA-VP-A876-01","01-28-SRR471073","02-1562-SRR472853","5-SRR4043876","65-SRR4043910","9-SRR5876808","TCGA-HC-7742-01","TCGA-HC-A632-01","TCGA-YL-A9WK-01","TCGA-ZG-A9LN-01","07-144-SRR466865","09-2767-SRR465371","TCGA-V1-A9OL-01","6115323-SRR8316709","80-SRR4043845","TCGA-EJ-7789-01","TCGA-HI-7170-01","TCGA-ZG-A8QX-01","WCMC14-SRR3146844","1115264-SRR8304839","39-SRR4043962","6115285-SRR8307112","TCGA-ZG-A9L9-01","6115381-SRR8316705","TCGA-HC-7077-01","TCGA-KC-A7FA-01","TCGA-YL-A9WY-01","WCMC24854-SRR3146789","WCMC7520-SRR3146871","TCGA-G9-6499-01","TCGA-HC-7213-01","66-SRR4043848","7-SRR5876786","TCGA-FC-7961-01","TCGA-HC-A9TH-01","WCMC10361-SRR3146801","WCMC7520-SRR3146865","04-1243-SRR469952","46-SRR5876762","TCGA-G9-6332-01","TCGA-HI-7171-01","TCGA-VP-A87K-01","20-SRR5876732","44-SRR4043981","56-SRR4043868","63-SRR4043826","71-SRR4044024","TCGA-CH-5761-01","1115284-SRR8304834","5115024-SRR8311838","6115402-SRR8307128","8-SRR5876797","STID0000002915-SRR477768","TCGA-KK-A6E4-01","28-SRR4043875","TCGA-FC-A4JI-01","1115088-SRR8304754","1115126-SRR8304763","33-SRR5876746","6115286-SRR8307113","STID0000001024-SRR477288","01-2492-SRR471733","50-SRR4044012","6-SRR5876775","09-3687-SRR467858","34-SRR4043809","51-SRR5876768","TCGA-HC-7740-01","WCMC15-SRR3146810","1115303-SRR8307441","4-SRR5876753","TCGA-HC-8216-01","TCGA-M7-A71Z-01","WCMC24290-SRR3146937","36-SRR4044001","TCGA-EJ-5514-01","04-47-SRR460038","5115192-SRR8311924","TCGA-ZG-A9LZ-01","TCGA-CH-5766-01","TCGA-HC-7212-01","04-3347-SRR472945","22-SRR4043904","TCGA-XJ-A9DX-01","TCGA-ZG-A9KY-01","04-639-SRR464829","TCGA-VP-A87D-01","09-5700-SRR485381","21181-SRR3146979","72-SRR4043800","TCGA-HC-7821-01","TCGA-EJ-8472-01","WCMC10680-SRR3146721","10-SRR4043970","42-SRR5876756","STID0000000427-SRR477348","TCGA-VP-A875-01","1115081-SRR8304753","1115156-SRR2404024","TCGA-KK-A7B4-01","TCGA-ZG-A9L0-01","TCGA-EJ-5516-01","1115082-SRR8304741","5115075-SRR8311909","5115199-SRR8311935","77-SRR4043941","WCMC12688-SRR3146788","35-SRR5876748","TCGA-HC-7744-01","WCMC4240-SRR3146850","1115091-SRR8304759","6115383-SRR8316753","TCGA-YJ-A8SW-01","1115086-SRR8304740","5115026-SRR8311846","5115203-SRR8311968","WCMC10363-SRR3146919","26-SRR5876738","41-SRR4043820","6115393-SRR8316920","1115200-SRR8304826","6115120-SRR8307109","81-SRR4043890","TCGA-ZG-A9N3-01","1115308-SRR8321662","76-SRR4043852","TCGA-KK-A8ID-01","22-SRR5876734","6115400-SRR8307126","TCGA-HC-7747-01","1115183-SRR2407078","62-SRR4043822","5115077-SRR8311916","TCGA-HI-7168-01","43-SRR4043837","19-SRR5876730","20-SRR4043814","28-SRR5876740","5115029-SRR8311857","58-SRR4043892","TCGA-J9-A8CL-01","WCMC10364-SRR3146932","26-SRR4043811","6115295-SRR8307105","53-SRR5876770","6115250-SRR8307110","10-SRR5876700","24-SRR5876736","40-SRR5876754","7-SRR4043840","TCGA-CH-5751-01","TCGA-XQ-A8TA-01","WCMC0-SRR3146906","WCMC12728-SRR3146836","WCMC7520-SRR3146855","5115076-SRR8311911","6115320-SRR8307502","6115288-SRR8307119","6115319-SRR8307501","8-SRR4044014","TCGA-HC-7736-01","31-SRR5876744","5115057-SRR8311891","5115256-SRR8312012","58-SRR5876776","TCGA-HC-7745-01","11-SRR5876711","6115386-SRR8316758","6115391-SRR8316923","9-SRR4043806","23-SRR5876735","5115034-SRR8311896","15-SRR4043919","WCMC0-SRR3146886","4-SRR4043948","5115028-SRR8311852","WCMC0-SRR3146750","25-SRR5876737","6115395-SRR8316910","5115276-SRR8312040","52-SRR5876769","WCMC18248-SRR3146883","47-SRR4044004","5115023-SRR3018013","79-SRR4043977","46-SRR4043793","14-SRR4043959","6115387-SRR8316755","6115392-SRR8316915","5-SRR5876764","5115547-SRR8311623","21-SRR5876733","6115396-SRR8316924","68-SRR4043825","32-SRR5876745","5115098-SRR8311874","5115258-SRR8311905","53-SRR4044006","3-SRR4044023","35-SRR4043810","52-SRR4043939","86-SRR4044009","5115078-SRR8311926","TCGA-HC-7750-01","6115014-SRR3018200","12-SRR5876722","57-SRR5876774","44-SRR5876760","5115130-SRR8311953","11-SRR4044013","43-SRR5876757","6115397-SRR8316922","WCMC0-SRR3146784","6115390-SRR8316918","1115161-SRR2404095","5115187-SRR8311991","59-SRR4043832","69-SRR4043866","5115186-SRR8311944","6115013-SRR3018198","TCGA-KK-A5A1-01","29-SRR5876741","6115317-SRR8307505","42-SRR4044002","61-SRR4043934","44-SRR5876758","5115260-SRR8312022","59-SRR5876777","1115153-SRR2404067","5115409-SRR8311598","6115012-SRR3018193","6115403-SRR8307258","1115090-SRR8307132","14-SRR5876725","1115157-SRR2404185","21-SRR4043856","38-SRR5876751","TCGA-HC-7749-01","39-SRR5876752","2-SRR4043877","54-SRR5876771","56-SRR5876773","44-SRR5876759","6115389-SRR8316757","5115128-SRR8311958","64-SRR4043931","5115056-SRR8311885","WCMC9-SRR3146731","49-SRR5876766","55-SRR5876772","1115257-SRR8304832","13-SRR5876724","19-SRR4043878","5115030-SRR8311864","67-SRR4043989","48-SRR5876765","15-SRR5876726","5115255-SRR8312028","25-SRR4043920","TCGA-HC-7738-01","5115359-SRR8312049","5115327-SRR8312045","5115058-SRR8311907","50-SRR5876767","5115129-SRR8311946","6-SRR4043956","6115322-SRR8316710","WCMC21016-SRR3146962","5115261-SRR8312001","5115031-SRR8311868","60-SRR4043953","5115198-SRR8311993","6115388-SRR8316756","6115398-SRR8316925","87-SRR4043918","5115254-SRR8312004","1115154-SRR2404230","5115160-SRR8311978","5115259-SRR8311931","83-SRR4043830","23-SRR4043895","47-SRR5876763","5115608-SRR8311694","5115611-SRR8311716","5115193-SRR8311999","5115501-SRR8311580","6115394-SRR8316919","5115648-SRR8311751","49-SRR4043907","5115032-SRR8311872","75-SRR4043799","17-SRR4043874","5115127-SRR8311930","88-SRR4043791","34-SRR5876747","6115385-SRR8316754","5115410-SRR8311600","84-SRR4043988","5115612-SRR8311718","5115197-SRR8311986","17-SRR5876728","5115196-SRR8311984","27-SRR5876739","5115158-SRR8311962","5115408-SRR8312096","78-SRR4043993","5115528-SRR8311652","5115033-SRR8311876","5115291-SRR8312042","5115650-SRR8311791","16-SRR5876727","5115152-SRR8311933","5115194-SRR8311970","5115613-SRR8311720","45-SRR5876761","5115405-SRR8312075","1115202-SRR2404278","5115506-SRR8311667","5115195-SRR8311974","5115610-SRR8311714","5115614-SRR8311745","6115399-SRR8316921","5115290-SRR8312030","57-SRR4043833","18-SRR5876729","5115651-SRR8311795","5115505-SRR8311644","5115411-SRR8311619","5115548-SRR8311692","5115073-SRR8311904","37-SRR5876750","5115407-SRR8312070","27-SRR4043858","5115609-SRR8311697","5115412-SRR8311627","5115406-SRR8312068","36-SRR5876749","5115615-SRR8311749"],[2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,34,34,34,34,35,35,35,35,35,35,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,39,39,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,42,42,42,42,43,43,43,43,43,43,43,43,43,44,44,44,44,44,45,45,45,45,45,45,45,45,45,46,46,46,46,46,47,47,47,47,47,47,48,48,48,48,48,49,49,49,49,49,49,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,52,52,52,52,52,53,53,53,53,53,53,53,54,54,54,54,54,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,57,57,57,58,58,58,58,58,58,59,59,59,59,60,60,60,60,60,60,61,61,62,62,62,62,62,62,63,63,63,63,63,64,64,64,64,64,64,65,65,65,65,65,65,66,66,67,67,67,67,67,68,68,68,69,69,69,69,69,70,70,70,70,70,71,71,72,72,72,73,73,74,74,74,74,75,75,76,76,76,76,77,77,78,78,79,79,80,80,80,80,81,82,82,82,82,82,83,83,83,84,84,84,85,85,85,85,86,86,86,87,87,87,87,89,89,89,90,90,90,91,91,92,92,94,95,95,95,95,95,95,95,96,96,97,97,98,98,98,100,100,101,101,101,101,102,102,103,104,104,104,105,105,105,105,106,107,107,107,107,108,108,109,110,111,111,112,113,113,114,114,114,115,116,117,118,119,119,119,120,120,121,121,121,122,122,122,122,123,123,123,124,125,125,126,127,127,128,128,129,129,129,129,130,131,131,132,132,133,134,134,135,135,136,137,139,139,139,140,140,140,140,141,141,143,143,143,143,144,145,145,145,146,146,147,147,148,148,149,150,152,152,152,152,152,153,156,156,157,157,158,159,160,161,162,162,162,162,166,167,168,169,170,171,173,174,177,179,179,180,181,181,181,182,183,184,184,185,187,187,187,189,190,193,194,195,199,199,201,203,204,207,209,211,211,211,212,213,215,215,216,216,217,217,227,227,228,234,237,238,240,241,243,243,245,245,254,259,261,262,264,264,277,303,356,367,393,420],[2,2,3,3,3,3,3,4,4,4,3,3,4,5,5,4,4,5,3,3,3,2,3,5,5,3,3,6,6,5,4,6,5,4,6,6,6,4,2,6,7,6,3,7,7,7,7,7,5,6,6,4,5,6,4,6,7,3,8,8,8,8,5,7,6,7,8,5,3,6,5,8,8,9,6,5,5,9,9,4,7,3,8,6,9,3,4,6,9,6,8,4,5,7,6,5,8,6,5,5,6,8,6,7,3,9,11,11,7,8,7,5,3,5,7,8,7,11,6,5,5,10,7,7,6,5,6,12,9,11,4,6,11,6,7,6,4,5,2,5,4,3,7,7,8,8,5,3,12,6,5,6,5,8,8,10,7,6,6,7,11,10,5,13,5,12,6,5,6,11,2,11,5,6,4,13,14,9,7,7,6,6,6,2,5,6,11,6,6,6,7,7,6,8,7,14,7,7,3,12,5,9,3,6,11,8,6,11,16,16,7,15,11,7,8,11,3,8,9,11,11,11,5,13,5,6,12,3,6,15,17,16,10,17,4,7,13,7,5,7,13,12,11,5,16,17,5,13,6,9,16,3,6,13,11,12,7,6,7,16,9,13,4,6,13,19,6,10,10,11,19,10,8,10,19,12,7,12,12,8,5,12,10,15,10,6,14,20,17,14,10,10,6,6,9,13,14,14,4,11,5,13,6,9,6,16,14,11,13,21,15,12,8,18,15,5,10,9,12,8,12,11,17,10,17,5,14,8,11,8,21,18,9,13,12,14,7,14,6,9,19,7,23,12,10,13,11,14,9,17,4,10,8,10,13,13,21,15,19,8,7,10,10,15,13,13,9,7,8,9,16,13,4,21,19,19,10,17,9,7,17,20,12,7,13,7,6,8,20,16,7,13,15,8,9,20,12,17,11,16,12,13,10,6,19,11,9,14,19,11,7,8,3,13,9,21,24,26,14,23,10,14,13,13,9,25,20,12,13,16,9,20,21,27,19,31,30,21,24,22,26,16,12,12,15,17,14,12,18,14,25,11,19,26,25,18,10,10,14,30,19,24,9,14,11,19,11,27,19,18,10,21,23,29,8,15,17,10,36,17,24,36,36,17,23,35,36,7,38,37,25,37,32,21,31,8,12,32,31,34,21,40,25,36,17,20,20,41,40,29,37,41,36,20,42,42,16,24,17,35,42,43,43,43,38,41,44,42,43,14,18,41,10,43,45,45,45,40,32,25,45,46,20,26,36,47,31,47,47,48,46,39,48,12,32,39,48,49,49,37,50,50,27,31,49,50,47,50,48,32,51,47,51,50,50,51,32,49,52,52,51,51,44,18,43,12,52,52,43,42,41,53,53,51,52,36,41,33,55,55,53,56,37,42,36,46,53,56,35,57,57,57,58,37,30,45,49,54,58,29,48,56,53,60,60,60,39,53,59,60,32,47,62,62,32,50,54,62,62,63,63,30,57,50,38,30,64,48,45,43,47,65,65,38,63,57,67,66,64,65,65,66,47,61,33,27,69,61,70,43,64,69,70,51,71,40,71,71,73,73,73,40,67,71,71,74,72,72,40,76,75,75,52,43,66,71,47,66,77,80,65,82,53,55,80,80,82,70,82,81,80,80,82,37,69,81,52,61,49,85,84,85,83,82,88,87,47,86,78,87,68,82,92,55,60,76,70,49,73,87,88,92,93,90,93,56,66,88,95,99,101,97,84,86,92,101,96,94,57,95,62,102,103,98,105,106,97,107,105,59,78,103,104,110,96,100,102,108,96,108,110,111,102,110,63,112,118,119,68,90,70,117,108,121,118,70,114,113,107,109,117,93,123,113,119,123,127,94,122,124,126,124,75,121,105,120,131,132,125,126,121,131,114,127,138,132,126,112,100,135,140,96,126,141,138,135,142,144,134,139,132,146,139,143,140,140,113,148,137,149,143,151,148,148,142,123,97,115,154,153,150,157,160,159,92,156,136,163,150,160,167,162,163,168,174,172,161,176,176,167,176,176,181,177,182,183,171,174,166,168,180,173,177,178,195,192,189,200,193,190,204,200,209,207,201,210,204,200,160,182,200,213,206,214,220,225,234,227,230,235,239,229,242,240,234,251,256,261,253,250,263,273,291,354,337,392,406],[0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0,2,2,2,3,3,1,1,3,3,0,0,1,2,0,1,2,0,0,0,3,5,1,0,1,4,0,0,0,0,0,2,1,1,3,2,1,4,2,1,5,0,0,0,0,3,1,2,1,0,3,5,2,3,1,1,0,3,4,4,0,0,5,2,6,1,3,0,6,5,3,0,3,2,6,5,3,4,5,2,4,5,5,4,2,4,3,7,1,0,0,4,3,4,6,8,6,4,3,4,0,5,6,6,1,4,4,5,6,5,0,3,1,8,6,1,6,5,6,8,7,10,7,8,9,5,5,4,4,7,9,1,7,8,7,8,5,5,3,6,7,7,6,2,3,8,0,8,1,7,8,7,2,12,3,9,8,10,1,0,5,7,7,8,8,8,12,9,9,4,9,9,9,8,8,9,7,8,1,8,8,12,3,10,6,12,9,4,8,10,5,0,0,9,1,5,9,8,5,13,8,7,5,5,5,11,4,12,11,5,14,11,2,0,1,7,0,13,10,4,10,12,10,4,6,7,13,2,1,13,5,12,9,2,15,12,5,7,6,11,12,11,2,9,5,14,13,6,0,13,9,9,8,0,9,11,9,0,7,12,7,7,11,14,7,9,4,9,14,6,0,3,6,10,10,14,14,11,7,6,6,16,9,15,7,14,11,14,5,7,10,8,0,6,9,13,3,6,16,11,12,9,13,9,10,5,12,5,17,8,14,11,14,1,4,13,9,10,8,15,8,17,14,4,16,0,11,13,10,12,9,14,6,19,13,15,13,10,11,3,9,5,16,17,14,14,9,11,11,15,17,16,15,8,12,21,5,7,7,16,9,17,19,9,6,14,19,13,19,20,18,6,11,20,14,12,19,18,7,15,10,16,11,15,14,17,22,9,17,19,14,9,17,21,20,25,16,20,8,5,3,15,6,19,15,16,16,20,5,10,18,17,14,21,10,9,4,12,0,1,10,7,9,5,15,19,20,17,15,18,20,14,18,7,21,14,7,8,15,23,23,19,4,15,10,25,21,24,16,24,8,16,18,26,15,13,7,28,22,20,27,1,20,13,1,1,20,15,3,2,31,0,1,13,2,7,19,9,32,28,8,9,6,19,0,15,5,24,21,21,0,1,12,4,1,6,22,0,1,27,19,26,8,1,0,0,0,6,3,0,2,1,31,27,4,35,2,0,0,0,5,14,21,1,0,26,21,11,0,16,0,0,0,2,9,0,36,17,10,1,0,0,12,0,0,23,19,1,0,3,0,3,19,0,4,0,1,1,0,20,3,0,0,1,2,9,35,10,41,1,1,11,12,13,1,1,4,3,19,14,22,0,0,3,0,19,14,20,10,3,0,21,0,0,0,0,21,28,13,9,4,1,30,11,3,7,0,0,0,21,7,2,1,30,15,0,0,30,12,9,1,1,0,0,34,7,14,26,34,0,17,20,22,18,0,0,28,3,10,0,1,3,2,3,2,21,8,36,42,0,8,0,27,6,1,0,20,0,32,1,1,0,0,1,34,7,3,4,1,4,4,36,0,2,2,26,35,13,8,33,14,3,0,16,0,29,27,2,2,1,13,1,3,4,4,3,48,16,4,34,25,37,2,3,2,4,7,1,2,43,4,12,4,23,10,0,39,35,19,25,46,22,8,7,4,3,7,4,42,32,10,5,1,0,4,17,15,10,1,7,10,47,9,43,3,2,7,1,1,10,0,2,49,30,6,6,1,15,12,11,5,18,6,4,4,14,7,55,7,1,0,52,30,51,4,13,1,4,52,8,10,16,14,7,32,2,13,8,4,1,34,7,5,3,5,55,10,26,12,1,1,9,8,14,4,22,10,1,7,13,28,40,5,0,45,15,2,5,8,1,0,11,6,13,0,7,4,7,8,35,1,13,3,9,1,4,4,11,33,59,42,3,5,9,3,1,3,70,6,26,3,17,8,2,8,8,5,0,5,18,3,4,14,5,5,1,6,2,1,14,13,21,19,9,17,16,16,0,7,10,1,10,14,3,9,2,4,10,2,9,15,55,34,16,4,11,13,7,3,0,10,8,5,2,14,1,5,11,3,3,0,9,14,1,4,12,2,30,1,14],[0,1,1,1,0,0,1,2,2,2,2,2,2,3,2,2,3,3,2,2,3,3,4,2,3,4,3,3,3,4,3,4,4,4,2,3,3,5,5,4,3,5,4,3,5,3,4,3,5,5,5,4,5,3,6,5,6,3,4,5,5,6,6,4,4,4,5,6,4,4,6,5,5,7,6,7,6,6,6,7,5,6,6,6,4,7,6,6,5,7,5,7,7,8,4,6,6,5,8,7,5,7,8,7,7,5,6,8,9,8,5,7,7,8,6,7,8,8,6,7,9,7,7,7,6,8,7,8,10,7,8,8,8,8,6,7,10,7,8,9,7,7,7,6,6,7,8,8,9,9,7,10,8,9,10,7,8,8,9,8,10,8,9,10,10,8,10,8,9,8,11,7,10,8,11,10,10,8,9,10,9,9,10,9,10,10,8,8,11,8,8,7,10,12,10,10,10,8,12,11,10,9,10,11,11,8,11,6,9,11,12,11,13,10,6,10,11,10,11,9,11,10,11,11,12,9,12,8,12,11,13,9,11,10,10,10,12,11,10,9,9,12,10,10,11,10,8,10,8,11,9,11,11,12,11,11,13,9,10,14,10,13,11,13,12,12,13,11,10,14,13,13,11,12,13,11,9,13,8,13,13,11,9,9,13,11,10,11,11,10,11,13,12,8,12,12,14,13,12,10,14,15,11,13,11,13,11,12,12,12,13,11,14,15,12,14,10,12,11,11,14,13,15,14,12,13,12,12,14,12,11,12,13,13,9,10,13,13,11,13,10,13,13,14,11,13,11,13,12,14,13,12,13,11,12,13,14,13,15,13,12,13,11,14,12,12,16,11,10,18,13,16,12,16,14,17,14,15,15,14,13,14,14,12,9,13,13,12,11,16,15,17,12,14,13,15,17,10,14,14,10,14,14,16,16,15,15,13,13,14,14,9,14,12,17,15,16,16,14,14,13,15,14,14,14,19,13,14,16,14,12,16,13,16,15,15,15,18,17,17,15,14,18,15,17,15,15,17,16,15,14,15,20,18,15,15,20,16,14,14,14,15,10,13,17,16,16,17,15,16,16,22,16,17,15,15,17,15,21,16,14,21,22,18,16,16,15,14,22,22,17,19,20,16,17,17,16,17,17,15,16,22,18,17,19,15,22,22,21,19,18,19,21,15,22,18,19,19,14,19,20,22,22,22,20,19,21,22,22,17,15,19,19,20,22,22,22,22,18,16,22,21,18,21,20,22,20,22,22,22,22,20,22,17,21,18,22,22,22,18,22,22,20,19,20,22,20,22,19,18,22,22,22,22,22,22,19,20,22,22,22,22,19,21,19,18,22,22,20,20,19,22,22,22,22,21,18,19,22,22,17,22,20,18,22,21,22,22,22,22,22,22,22,20,16,22,22,21,21,20,18,22,21,22,21,22,19,22,21,22,18,21,22,22,19,21,21,21,22,22,22,20,18,22,21,20,21,20,21,19,18,22,22,21,21,21,22,20,21,22,22,22,22,22,21,22,19,22,22,22,22,22,22,20,22,19,20,22,22,22,22,19,19,20,22,22,22,21,18,22,22,21,20,21,22,22,18,21,22,22,22,22,21,22,22,22,22,21,22,21,22,20,22,20,22,22,21,20,19,22,22,22,22,22,22,21,20,22,21,22,21,21,22,20,21,22,20,20,21,21,22,22,22,22,21,22,22,22,22,22,22,22,21,22,22,21,22,22,22,21,21,22,22,20,22,22,22,22,21,22,22,21,22,22,22,22,22,22,22,22,22,22,22,21,21,22,22,22,22,22,22,21,22,21,22,21,22,22,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,20,22,22,22,22,22,22,22,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,21,21,22,22,21,22,22,22,22,22,22,22,22,22,22,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,21,22,22,22,22,22,22,22],[0,0,0,0,0,0,0,0,0.001,0,0.008,0.001,0.001,0,0.001,0.006,0.001,0.001,0.018,0.009,0.066,0.067,0.057,0,0.007,0.015,0.001,0,0,0.012,0.058,0.02,0.002,0.02,0.001,0.044,0,0.023,0.025,0,0.036,0.002,0.026,0,0.001,0.002,0.001,0.001,0.076,0,0.019,0.05,0.028,0.008,0.028,0,0.062,0.044,0.002,0.001,0,0.002,0.015,0,0,0.011,0.008,0.003,0.037,0.005,0.01,0.001,0.007,0.001,0.046,0.017,0.011,0.001,0.001,0.039,0.034,0.035,0.002,0.002,0.001,0.056,0.051,0.057,0.001,0.045,0.017,0.122,0.026,0.031,0.005,0.016,0.023,0.049,0.028,0.011,0.064,0.02,0.007,0.096,0.081,0.011,0.004,0.002,0.058,0.008,0.002,0.022,0.026,0.013,0.118,0.02,0.005,0.012,0.062,0.013,0.057,0.025,0.014,0.007,0.057,0.012,0.032,0.001,0.062,0.01,0.07,0.018,0.002,0.04,0.016,0.08,0.059,0.11,0.048,0.057,0.077,0.052,0.097,0.013,0.099,0.019,0.027,0.074,0.016,0.181,0.026,0.022,0.02,0.093,0.038,0.086,0.032,0.036,0.061,0.066,0.004,0.006,0.044,0.007,0.074,0.002,0.085,0.036,0.138,0.322,0.046,0.008,0.045,0.065,0.04,0.027,0.011,0.071,0.053,0.023,0.177,0.037,0.108,0.112,0.028,0.034,0.023,0.029,0.037,0.043,0.07,0.033,0.051,0.096,0.075,0.076,0.306,0.104,0.106,0.007,0.093,0.067,0.144,0.119,0.085,0.083,0.137,0.029,0.008,0.004,0.092,0.052,0.093,0.084,0.025,0.055,0.05,0.027,0.056,0.044,0.05,0.089,0.083,0.057,0.061,0.112,0.044,0.067,0.135,0.005,0.002,0.005,0.047,0.005,0.147,0.068,0.147,0.063,0.142,0.056,0.198,0.038,0.102,0.063,0.01,0.013,0.075,0.056,0.06,0.028,0.044,0.092,0.071,0.155,0.045,0.074,0.027,0.038,0.13,0.056,0.08,0.176,0.15,0.031,0.099,0.011,0.03,0.031,0.204,0.161,0.015,0.097,0.129,0.052,0.012,0.031,0.077,0.092,0.092,0.048,0.064,0.054,0.093,0.089,0.255,0.019,0.092,0.008,0.046,0.088,0.033,0.054,0.033,0.039,0.054,0.129,0.113,0.119,0.095,0.203,0.174,0.223,0.096,0.075,0.068,0.13,0.024,0.03,0.082,0.015,0.147,0.13,0.173,0.079,0.188,0.144,0.105,0.102,0.108,0.138,0.153,0.211,0.202,0.086,0.07,0.176,0.118,0.112,0.054,0.064,0.134,0.053,0.065,0.26,0.212,0.177,0.168,0.205,0.069,0.098,0.165,0.021,0.012,0.121,0.121,0.072,0.095,0.162,0.122,0.15,0.066,0.174,0.065,0.1,0.223,0.055,0.107,0.128,0.103,0.037,0.049,0.08,0.145,0.151,0.11,0.115,0.107,0.037,0.124,0.174,0.162,0.153,0.068,0.128,0.102,0.198,0.19,0.073,0.049,0.045,0.282,0.109,0.105,0.042,0.103,0.116,0.078,0.076,0.058,0.067,0.095,0.015,0.084,0.04,0.134,0.086,0.261,0.091,0.076,0.138,0.114,0.208,0.397,0.034,0.009,0.149,0.101,0.131,0.195,0.083,0.122,0.107,0.066,0.058,0.09,0.267,0.103,0.004,0.125,0.037,0.108,0.239,0.063,0.119,0.065,0.298,0.369,0.009,0.193,0.049,0.087,0.39,0.391,0.062,0.279,0.012,0.005,0.096,0.022,0.142,0.283,0.085,0.136,0.09,0.026,0.013,0.105,0.095,0.148,0.124,0.379,0.08,0.015,0.15,0.343,0.102,0.186,0.127,0.248,0.216,0.174,0.088,0.078,0.076,0.059,0.144,0.093,0.164,0.3,0.213,0.041,0.266,0.01,0.014,0.105,0.096,0.061,0.055,0.901,0.185,0.208,0.748,0.905,0.216,0.153,0.639,0.124,0.148,1,0.996,0.344,0.793,0.797,0.081,0.117,0.205,0.104,0.31,0.203,0.155,0.195,0.958,0.498,0.065,0.095,0.218,0.059,1,0.896,0.07,0.787,0.031,0.313,0.263,0.927,0.013,0.153,0.013,0.079,0.168,0.777,0.948,0.968,0.998,0.263,0.006,0.852,0.927,0.912,0.217,0.141,0.004,0.067,0.016,0.987,1,0.832,0.938,0.355,0.181,0.943,0.916,0.237,0.532,0.581,0.975,0.438,1,1,1,0.922,0.425,0.999,0.089,0.276,0.046,0.996,1,0.936,0.264,0.938,1,0.39,0.307,0.027,1,0.738,0.948,0.034,0.207,0.96,0.88,0.96,0.891,0.864,0.966,0.156,0.1,0.984,1,0.982,0.998,0.05,0.485,0.21,0.088,0.92,0.989,0.278,0.657,0.614,1,0.982,0.944,0.906,0.537,0.231,0.162,0.939,1,0.661,1,0.212,0.208,0.166,0.417,0.91,0.987,0.647,0.961,0.868,0.906,0.992,0.341,0.348,1,0.784,0.87,0.864,0.157,0.481,0.889,0.715,1,0.971,1,0.257,0.867,0.861,1,0.233,0.166,0.976,1,0.287,0.863,0.836,0.823,1,1,1,0.086,0.023,0.284,0.356,0.309,0.804,0.279,0.323,0.224,0.028,1,0.954,0.254,0.783,0.798,0.022,0.829,0.884,1,0.924,0.021,0.082,1,0.288,0.207,0.26,0.873,0.978,0.212,0.938,1,0.82,0.475,0.997,0.011,0.021,0.984,0.973,1,1,0.281,0.205,0.82,0.966,1,1,0.868,0.327,0.998,0.928,0.896,0.189,0.219,0.955,0.984,0.615,0.826,1,0.984,0.897,0.998,0.335,0.262,0.868,0.805,0.942,0.44,0.967,0.877,0.884,0.248,0.989,0.131,0.432,0.953,0.194,0.476,0.153,0.957,0.919,0.836,0.954,0.902,0.929,0.169,0.245,0.964,0.717,0.908,0.228,0.122,0.998,0.202,0.199,0.127,0.255,0.227,0.44,0.957,0.958,0.795,0.86,0.872,0.084,0.146,0.206,0.927,0.976,0.972,0.824,0.654,0.283,0.733,0.11,0.88,0.842,0.849,0.253,0.624,0.228,0.835,0.913,0.79,1,0.892,0.797,0.831,0.953,0.278,0.335,0.898,0.62,0.856,0.181,0.64,0.739,0.891,0.222,0.84,0.902,0.834,0.833,0.821,0.369,0.803,0.965,1,0.307,0.2,0.335,0.246,0.222,0.724,0.859,0.235,0.793,0.786,0.866,0.905,0.921,0.261,0.541,0.893,0.748,0.939,0.918,0.345,0.849,0.855,0.884,0.667,0.397,0.272,0.107,0.733,0.981,0.893,0.729,0.841,0.792,0.992,0.547,0.806,0.929,0.86,0.802,0.024,0.12,0.774,0.965,0.708,0.944,0.975,0.955,0.822,0.572,0.995,0.951,0.948,0.778,0.919,0.873,0.86,0.843,0.06,0.087,0.985,0.879,0.962,0.926,0.964,0.937,0.978,0.716,0.45,0.273,0.69,0.64,0.74,0.667,0.771,0.981,0.755,0.406,0.284,0.311,0.84,0.848,0.915,0.993,0.948,0.91,0.919,0.914,0.856,0.707,0.84,0.858,0.887,0.857,0.77,0.927,0.963,0.862,0.974,0.682,0.193,0.811,0.22,0.953,0.916,0.809,0.779,0.945,0.91,0.769,0.876,0.858,0.902,0.806,0.763,0.994,0.828,0.767,0.777,0.927,0.692,0.148,0.537,0.311,0.877,0.81,0.338,0.93,0.966,0.841,0.766,0.956,0.856,0.993,0.718,0.955,0.923,0.796,0.947,0.908,0.886,0.798,0.801,0.953,0.966,0.856,0.948,0.297,0.926,0.36]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sample<\/th>\n      <th>n_of_cnv<\/th>\n      <th>n_of_amp<\/th>\n      <th>n_of_del<\/th>\n      <th>n_of_vchr<\/th>\n      <th>cna_burden<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb132-2" data-line-number="2"></a>
<a class="sourceLine" id="cb132-3" data-line-number="3">tb_cnv =<span class="st"> </span>CNV.seqz<span class="op">@</span>summary.per.sample <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb132-4" data-line-number="4"><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>sample) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb132-5" data-line-number="5"><span class="st"> </span>psych<span class="op">::</span><span class="kw">describe</span>(<span class="dt">quant=</span><span class="kw">c</span>(.<span class="dv">25</span>,.<span class="dv">75</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb132-6" data-line-number="6"><span class="st"> </span><span class="kw">as_tibble</span>(<span class="dt">rownames=</span><span class="st">&quot;rowname&quot;</span>)   </a>
<a class="sourceLine" id="cb132-7" data-line-number="7"></a>
<a class="sourceLine" id="cb132-8" data-line-number="8">DT<span class="op">::</span><span class="kw">datatable</span>(tb_cnv)</a></code></pre></div>
<div id="htmlwidget-2cf45155c0fb5d1e4229" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2cf45155c0fb5d1e4229">{"x":{"filter":"none","data":[["1","2","3","4","5"],["n_of_cnv","n_of_amp","n_of_del","n_of_vchr","cna_burden"],[1,2,3,4,5],[937,937,937,937,937],[59.5016008537887,50.1205976520811,9.38100320170758,15.4364994663821,0.360027748132337],[61.3707056533636,60.6959052927012,9.96108785297737,6.35879427692465,0.376226432204128],[35,20,7,16,0.153],[48.1904127829561,37.91344873502,7.67376830892144,16.0545938748336,0.326776298268975],[34.0998,22.239,7.413,8.8956,0.2031162],[2,2,0,0,0],[420,406,70,22,1],[418,404,70,22,1],[1.85947022973606,1.95320812213865,1.96504698240751,-0.478321408165776,0.671929885719615],[4.13555285606539,4.47653817195581,5.16928323983012,-1.08285589556025,-1.31003708088139],[2.00489356299131,1.9828487961112,0.32541455575932,0.207732754226422,0.012290781800908],[17,8,2,10,0.053],[82,70,13,22,0.806]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>rowname<\/th>\n      <th>vars<\/th>\n      <th>n<\/th>\n      <th>mean<\/th>\n      <th>sd<\/th>\n      <th>median<\/th>\n      <th>trimmed<\/th>\n      <th>mad<\/th>\n      <th>min<\/th>\n      <th>max<\/th>\n      <th>range<\/th>\n      <th>skew<\/th>\n      <th>kurtosis<\/th>\n      <th>se<\/th>\n      <th>Q0.25<\/th>\n      <th>Q0.75<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="maf-data" class="section level3">
<h3>MAF data</h3>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1">DT<span class="op">::</span><span class="kw">datatable</span>(Maf<span class="op">@</span>variant.type.summary)</a></code></pre></div>
<div id="htmlwidget-853939f34688f06a6622" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-853939f34688f06a6622">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965"],["TCGA-XK-AAIW-01A-11D-A41K-08","SRR8316704","SRR3018193","SRR3146888","SRR5876732","TCGA-KK-A59V-01A-11D-A29Q-08","SRR3146812","SRR3146978","SRR8307136","SRR4043910","TCGA-J9-A52C-01A-11D-A26M-08","SRR4043814","SRR3146929","SRR3146834","SRR461844","SRR3146940","TCGA-EJ-7782-01A-11D-2114-08","SRR3146936","SRR5876763","SRR5876772","SRR4043939","SRR3146932","SRR3146755","SRR3018198","SRR8311974","SRR4044013","SRR5876773","SRR5876766","SRR8311718","SRR8311692","SRR5876749","SRR5876741","SRR8312004","SRR5876750","SRR4043918","SRR4044006","SRR8311953","SRR3146855","SRR8312075","SRR8311962","SRR4043845","SRR8307109","TCGA-XQ-A8TA-01A-11D-A364-08","SRR3018200","SRR8316921","SRR3146850","SRR5876751","SRR8311644","SRR8312096","SRR5876737","SRR8316918","TCGA-HC-A4ZV-01A-11D-A26M-08","SRR3146871","SRR8311749","SRR8316754","SRR8316923","SRR8307113","TCGA-CH-5769-01A-11D-1576-08","SRR3146883","SRR5876761","SRR3146937","SRR8307258","SRR8311720","SRR8311885","TCGA-KK-A5A1-01A-11D-A29Q-08","SRR4043799","SRR8312040","SRR5876743","TCGA-HC-8216-01A-11D-A29Q-08","SRR4043993","SRR4043875","SRR8321662","SRR5876727","SRR8311896","SRR3146865","SRR5876725","SRR5876734","TCGA-ZG-A9NI-01A-11D-A41K-08","SRR8311667","SRR8311795","TCGA-CH-5754-01A-11D-1576-08","SRR8311600","SRR8311944","SRR4043931","SRR8311907","SRR3146951","SRR4043989","SRR5876759","SRR8304832","SRR8316925","SRR5876758","SRR8307101","SRR8316756","TCGA-EJ-A65F-01A-21D-A30X-08","SRR4043825","SRR4043892","SRR8307119","SRR8307505","SRR2404095","SRR3146793","SRR5876726","SRR5876755","SRR8312049","SRR8316922","SRR2404302","SRR3146919","SRR8311933","SRR2404278","SRR4043791","SRR8311627","SRR8316755","SRR3146788","SRR5876735","SRR5876738","SRR8311978","SRR3146810","SRR8307501","SRR8311694","SRR8311991","SRR8312022","TCGA-EJ-5519-01A-01D-1576-08","TCGA-J9-A8CM-01A-11D-A34U-08","SRR4043793","SRR8307105","SRR8311924","SRR8311986","SRR8316757","SRR8316758","TCGA-QU-A6IM-01A-11D-A31L-08","SRR3146886","SRR4043941","SRR4043948","SRR8311857","SRR8311864","TCGA-EJ-5495-01A-01D-1576-08","SRR5876757","SRR5876747","SRR8304826","SRR8307110","SRR8311993","SRR8312030","SRR3146836","SRR4043810","SRR8311946","SRR4043830","SRR5876729","TCGA-XJ-A9DX-01A-11D-A377-08","TCGA-ZG-A9KY-01A-11D-A41K-08","SRR4043833","SRR4043877","SRR4043895","SRR5876740","SRR8311904","SRR8311999","SRR8312042","SRR8312070","TCGA-V1-A9OH-01A-11D-A41K-08","SRR4043848","SRR4043962","SRR4044024","SRR5876760","SRR8311931","SRR8316924","TCGA-YJ-A8SW-01A-11D-A377-08","SRR8312012","SRR8316753","TCGA-EJ-5525-01A-01D-1576-08","SRR4043907","SRR5876728","SRR8304830","SRR8311714","TCGA-ZG-A8QY-01A-11D-A377-08","SRR3146979","SRR4043953","SRR5876752","SRR5876767","SRR8311838","SRR8316910","TCGA-HC-8265-01A-11D-2260-08","SRR3146750","SRR4043809","SRR477650","SRR5876744","SRR8311935","SRR8312001","TCGA-HC-7077-01A-11D-1961-08","SRR2404185","SRR4043826","SRR5876756","SRR8311926","SRR8312045","TCGA-EJ-7781-01A-11D-2114-08","TCGA-HC-A9TE-01A-11D-A41K-08","TCGA-V1-A9OQ-01A-11D-A41K-08","TCGA-XK-AAJ3-01A-11D-A41K-08","SRR3146962","SRR4043878","SRR474116","SRR5876771","SRR8304754","SRR8311619","SRR8311872","SRR8311874","TCGA-KK-A59Z-01A-12D-A26M-08","SRR3018013","SRR4043820","SRR4043959","SRR5876722","SRR8304740","SRR8311905","TCGA-VP-A87D-01A-11D-A34U-08","SRR3146915","SRR4043811","SRR4043934","SRR4044004","SRR5876724","SRR5876753","SRR8307502","SRR8311716","TCGA-EJ-A7NM-01A-21D-A33T-08","TCGA-YL-A9WH-01A-11D-A377-08","TCGA-ZG-A9N3-01A-11D-A41K-08","SRR3146721","SRR4043876","SRR4043904","SRR8311652","SRR8312028","SRR8316919","SRR2404230","SRR3146801","SRR4043866","SRR4043890","SRR4043929","SRR4043970","SRR464805","SRR5876700","SRR5876770","SRR8312068","TCGA-HC-7749-01A-11D-2114-08","SRR3146906","SRR4044001","SRR5876711","SRR5876730","SRR5876733","SRR8307441","SRR8311916","TCGA-KK-A8ID-01A-11D-A364-08","TCGA-XK-AAIV-01A-11D-A41K-08","SRR3146776","SRR3146839","SRR4043856","SRR5876754","SRR5876769","SRR8304839","SRR8311751","SRR8311984","SRR4043868","SRR5876774","SRR8311849","SRR8324618","TCGA-CH-5762-01A-11D-1576-08","TCGA-VP-A87B-01A-11D-A34U-08","TCGA-ZG-A9L5-01A-12D-A41K-08","TCGA-ZG-A9LB-01A-11D-A41K-08","SRR3146844","SRR4043977","SRR477592","SRR5876746","SRR8304837","SRR8311623","SRR8311697","SRR8311791","TCGA-FC-7961-01A-11D-A29Q-08","TCGA-HC-8259-01A-11D-2260-08","TCGA-HC-A6AL-01A-11D-A30E-08","TCGA-HC-A9TH-01A-11D-A41K-08","TCGA-KC-A7FA-01A-21D-A33T-08","TCGA-KK-A8IB-01A-11D-A364-08","TCGA-TK-A8OK-01A-22D-A364-08","TCGA-X4-A8KQ-01A-12D-A364-08","TCGA-XK-AAJA-01A-11D-A41K-08","SRR477288","SRR5876736","SRR8304834","SRR8307132","SRR8311909","SRR8316710","SRR8316920","TCGA-CH-5753-01A-11D-1576-08","TCGA-EJ-8472-01A-11D-2395-08","TCGA-EJ-8474-01A-11D-2395-08","TCGA-EJ-A46G-01A-31D-A26M-08","TCGA-J9-A8CL-01A-11D-A34U-08","TCGA-YL-A8S8-01A-11D-A377-08","SRR4043874","SRR5876745","SRR5876808","SRR8304838","SRR8307112","SRR8311846","SRR8311970","TCGA-CH-5761-01A-11D-1576-08","TCGA-V1-A8WV-01A-11D-A377-08","SRR2404024","SRR3146784","SRR4043806","SRR4043822","SRR4043837","SRR5876768","SRR5876775","SRR5876776","SRR8316709","TCGA-EJ-7123-01A-11D-1961-08","TCGA-G9-6339-01A-12D-A30X-08","TCGA-HC-8257-01A-11D-2260-08","TCGA-J4-A83J-01A-11D-A364-08","TCGA-KK-A59X-01A-11D-A29Q-08","TCGA-YL-A8SC-01A-11D-A377-08","TCGA-YL-A9WI-01A-11D-A377-08","SRR4043858","SRR4043919","SRR4043988","SRR459972","SRR471073","SRR5876748","SRR8311580","SRR8311868","SRR8311930","SRR8316915","TCGA-CH-5752-01A-11D-1576-08","TCGA-EJ-5521-01A-01D-1576-08","TCGA-G9-6363-01A-21D-1786-08","TCGA-KK-A7AY-01A-11D-A33T-08","TCGA-KK-A8I5-01A-11D-A364-08","TCGA-VP-A879-01A-11D-A34U-08","TCGA-Y6-A9XI-01A-11D-A41K-08","TCGA-YL-A9WY-01A-11D-A41K-08","SRR2407078","SRR4043964","SRR473166","SRR477466","SRR5876739","SRR5876765","SRR5876777","SRR8316705","TCGA-CH-5737-01A-11D-1576-08","TCGA-KC-A7FD-01A-11D-A33T-08","TCGA-KK-A6E2-01A-11D-A30X-08","TCGA-VN-A88P-01A-11D-A34U-08","TCGA-YL-A8SL-01B-21D-A377-08","SRR4043800","SRR474068","SRR474953","TCGA-2A-A8VT-01A-11D-A377-08","TCGA-EJ-5511-01A-01D-1576-08","TCGA-EJ-7115-01A-11D-2114-08","TCGA-EJ-7784-01A-11D-2114-08","TCGA-KK-A6E8-01A-11D-A31L-08","TCGA-TP-A8TV-01A-11D-A41K-08","TCGA-VN-A88Q-01A-11D-A34U-08","TCGA-YL-A8SO-01B-31D-A377-08","SRR4043852","SRR4044014","SRR477172","SRR8311598","SRR8311958","TCGA-2A-A8VX-01A-11D-A377-08","TCGA-CH-5768-01A-11D-1576-08","TCGA-EJ-5504-01A-01D-1576-08","TCGA-G9-6496-01A-11D-1786-08","TCGA-HC-A631-01A-11D-A29Q-08","TCGA-J9-A52D-01A-11D-A29Q-08","TCGA-KK-A6E3-01A-21D-A30E-08","TCGA-KK-A8I9-01A-11D-A364-08","TCGA-KK-A8IL-01A-11D-A364-08","TCGA-XK-AAK1-01A-11D-A41K-08","TCGA-ZG-A9LZ-01A-11D-A41K-08","SRR4043832","SRR465213","SRR466865","SRR477768","SRR8304741","SRR8307126","SRR8307128","TCGA-2A-A8W3-01A-11D-A377-08","TCGA-EJ-5530-01A-01D-1576-08","TCGA-HC-7820-01A-11D-2114-08","TCGA-HC-8264-01B-11D-2395-08","TCGA-KK-A8IA-01A-11D-A364-08","TCGA-M7-A722-01A-12D-A364-08","TCGA-YL-A8HM-01A-11D-A364-08","TCGA-ZG-A9L0-01A-11D-A41K-08","SRR4043840","SRR459996","SRR470000","SRR8304758","TCGA-CH-5764-01A-21D-1576-08","TCGA-CH-5767-01A-11D-1786-08","TCGA-EJ-7330-01A-11D-2114-08","TCGA-G9-6499-01A-12D-1961-08","TCGA-HC-7213-01A-11D-2114-08","TCGA-HC-7738-01A-11D-2114-08","TCGA-HC-7752-01A-11D-2114-08","TCGA-HC-A632-01A-11D-A29Q-08","TCGA-HC-A6AN-01A-11D-A30E-08","TCGA-J4-AAU2-01A-11D-A41K-08","TCGA-KK-A7AP-01A-12D-A33T-08","TCGA-V1-A9Z9-01A-21D-A41K-08","TCGA-V1-A9ZR-01A-11D-A41K-08","TCGA-XJ-A83H-01A-11D-A34U-08","TCGA-ZG-A9M4-01A-11D-A41K-08","SRR3146833","SRR471733","SRR472177","SRR474359","SRR474658","SRR485302","SRR8311891","TCGA-CH-5750-01A-11D-1576-08","TCGA-HI-7168-01A-11D-2114-08","TCGA-J4-AATZ-01A-11D-A41K-08","TCGA-KK-A7AW-01A-11D-A32B-08","TCGA-XJ-A83F-01A-11D-A34U-08","TCGA-YL-A8S9-01A-11D-A377-08","TCGA-ZG-A9L9-01A-11D-A41K-08","SRR4044002","SRR469952","SRR8304757","SRR8307106","SRR8307498","TCGA-CH-5772-01A-11D-1576-08","TCGA-EJ-A8FN-01A-11D-A34U-08","TCGA-G9-6361-01A-21D-1961-08","TCGA-G9-A9S4-01A-11D-A41K-08","TCGA-HC-7210-01A-11D-2114-08","TCGA-HC-A6AO-01A-11D-A30E-08","TCGA-KC-A7F5-01A-11D-A33T-08","TCGA-KK-A8II-01A-11D-A364-08","TCGA-V1-A8MF-01A-11D-A364-08","TCGA-YL-A8HO-01A-11D-A364-08","TCGA-YL-A8SQ-01B-11D-A377-08","TCGA-ZG-A9LY-01A-11D-A41K-08","SRR458567","SRR468337","SRR471673","SRR472297","SRR472357","SRR473816","SRR477947","TCGA-CH-5791-01A-11D-1576-08","TCGA-EJ-5499-01A-01D-1576-08","TCGA-EJ-5524-01A-01D-1576-08","TCGA-EJ-7314-01A-31D-2114-08","TCGA-EJ-A46F-01A-31D-A257-08","TCGA-EJ-A65B-01A-12D-A30E-08","TCGA-EJ-A65D-01A-11D-A30E-08","TCGA-EJ-A65J-01A-11D-A30X-08","TCGA-G9-7510-01A-11D-2260-08","TCGA-G9-7525-01A-31D-2260-08","TCGA-HC-8262-01A-11D-2260-08","TCGA-HC-A76W-01A-11D-A33T-08","TCGA-HC-A76X-01A-11D-A33T-08","TCGA-J9-A52B-01A-11D-A26M-08","TCGA-KK-A6E4-01A-11D-A30E-08","TCGA-V1-A8WL-01A-11D-A377-08","TCGA-V1-A8WW-01A-11D-A377-08","TCGA-V1-A9OL-01A-11D-A41K-08","TCGA-V1-A9ZI-01A-11D-A41K-08","TCGA-XK-AAJP-01A-11D-A41K-08","TCGA-ZG-A9L6-01A-11D-A41K-08","SRR4044023","SRR461465","SRR466841","SRR472063","SRR472853","SRR478121","SRR5876731","SRR8311852","TCGA-2A-A8VO-01A-11D-A377-08","TCGA-CH-5766-01A-11D-1576-08","TCGA-CH-5788-01A-11D-1576-08","TCGA-EJ-5496-01A-01D-1576-08","TCGA-EJ-5505-01A-01D-1576-08","TCGA-EJ-A65E-01A-11D-A29Q-08","TCGA-EJ-A7NN-01A-11D-A33T-08","TCGA-HC-7078-01A-11D-2114-08","TCGA-HI-7171-01A-12D-2114-08","TCGA-J4-A67M-01A-11D-A30E-08","TCGA-KK-A7AQ-01A-11D-A33T-08","TCGA-V1-A9Z8-01A-11D-A41K-08","TCGA-VN-A88O-01A-11D-A34U-08","TCGA-WW-A8ZI-01A-11D-A377-08","TCGA-YL-A8SK-01B-21D-A377-08","TCGA-ZG-A8QW-01A-11D-A377-08","TCGA-ZG-A9LM-01A-11D-A41K-08","SRR3146921","SRR4044009","SRR468174","SRR471373","SRR5876699","SRR8311745","TCGA-CH-5739-01A-11D-1576-08","TCGA-CH-5748-01A-11D-1576-08","TCGA-EJ-5507-01A-01D-1576-08","TCGA-EJ-5518-01A-01D-1576-08","TCGA-EJ-7318-01B-11D-A32B-08","TCGA-EJ-7788-01A-11D-2114-08","TCGA-EJ-A65M-01A-11D-A29Q-08","TCGA-FC-A4JI-01A-11D-A257-08","TCGA-G9-6338-01A-12D-1961-08","TCGA-G9-6369-01A-21D-1961-08","TCGA-G9-6371-01A-11D-1786-08","TCGA-G9-6494-01A-11D-1786-08","TCGA-HC-7233-01A-11D-2114-08","TCGA-J9-A8CP-01A-11D-A34U-08","TCGA-KK-A6DY-01A-12D-A30X-08","TCGA-KK-A6E6-01A-11D-A30X-08","TCGA-KK-A7B0-01A-11D-A32B-08","TCGA-KK-A7B3-01A-11D-A33T-08","TCGA-KK-A8IG-01A-11D-A364-08","TCGA-V1-A9O5-01A-11D-A41K-08","TCGA-V1-A9ZG-01A-11D-A41K-08","TCGA-VP-A878-01A-31D-A34U-08","TCGA-X4-A8KS-01A-12D-A364-08","TCGA-Y6-A8TL-01A-21D-A377-08","TCGA-YL-A8HJ-01A-11D-A364-08","TCGA-YL-A8SH-01B-11D-A377-08","TCGA-ZG-A9LN-01A-11D-A41K-08","SRR3146725","SRR4043902","SRR472129","SRR477829","SRR5876786","SRR8311968","TCGA-2A-AAYU-01A-11D-A41K-08","TCGA-4L-AA1F-01A-11D-A41K-08","TCGA-CH-5751-01A-11D-1576-08","TCGA-CH-5792-01A-11D-1576-08","TCGA-EJ-5527-01A-01D-1576-08","TCGA-EJ-7317-01A-31D-2114-08","TCGA-EJ-7321-01A-31D-2260-08","TCGA-EJ-7783-01A-11D-2114-08","TCGA-EJ-A8FS-01A-11D-A34U-08","TCGA-G9-6348-01A-11D-1786-08","TCGA-G9-A9S0-01A-11D-A41K-08","TCGA-G9-A9S7-01A-11D-A41K-08","TCGA-HC-7742-01A-11D-2114-08","TCGA-HC-A6AP-01A-11D-A30E-08","TCGA-HI-7170-01A-11D-2114-08","TCGA-J4-A67K-01A-21D-A30E-08","TCGA-KC-A4BV-01A-31D-A26M-08","TCGA-KK-A7AZ-01A-12D-A32B-08","TCGA-KK-A8IK-01A-11D-A364-08","TCGA-M7-A721-01A-12D-A32B-08","TCGA-M7-A724-01A-12D-A32B-08","TCGA-M7-A725-01A-12D-A32B-08","TCGA-MG-AAMC-01A-11D-A41K-08","TCGA-V1-A9Z7-01A-11D-A41K-08","TCGA-VN-A88K-01A-11D-A34U-08","TCGA-VP-A875-01A-31D-A34U-08","TCGA-VP-A87C-01A-11D-A34U-08","TCGA-VP-A87J-01A-11D-A34U-08","TCGA-YL-A8SR-01B-11D-A377-08","SRR467858","SRR478005","SRR485381","SRR8311911","TCGA-EJ-5514-01A-01D-1576-08","TCGA-EJ-5526-01A-01D-1576-08","TCGA-EJ-7218-01B-11D-A32B-08","TCGA-EJ-7789-01A-11D-2114-08","TCGA-G9-6333-01A-12D-1961-08","TCGA-G9-6362-01A-11D-1786-08","TCGA-G9-6377-01A-11D-1961-08","TCGA-HC-7744-01A-11D-2114-08","TCGA-HC-A8CY-01A-11D-A364-08","TCGA-J4-A67L-01A-11D-A30E-08","TCGA-J4-A83M-01A-11D-A34U-08","TCGA-VP-AA1N-01A-31D-A41K-08","TCGA-XK-AAJR-01A-11D-A41K-08","TCGA-YL-A8SA-01A-21D-A377-08","SRR464829","SRR465129","SRR468985","SRR471013","SRR5876797","TCGA-CH-5771-01A-21D-1576-08","TCGA-G9-6356-01A-11D-1786-08","TCGA-G9-6366-01A-11D-2114-08","TCGA-H9-7775-01A-11D-2114-08","TCGA-HC-7080-01A-11D-1961-08","TCGA-HC-7081-01A-11D-1961-08","TCGA-KK-A6E7-01A-11D-A31L-08","TCGA-KK-A7B4-01A-11D-A32B-08","TCGA-KK-A8IF-01A-11D-A364-08","TCGA-TP-A8TT-01A-12D-A41K-08","TCGA-V1-A8WS-01A-11D-A377-08","TCGA-V1-A9O9-01A-11D-A41K-08","TCGA-VN-A943-01A-11D-A41K-08","TCGA-VP-A87H-01A-11D-A34U-08","TCGA-VP-A87K-01A-11D-A34U-08","TCGA-XK-AAJT-01A-11D-A41K-08","TCGA-YL-A8SJ-01B-11D-A377-08","TCGA-YL-A8SP-01B-11D-A377-08","TCGA-ZG-A9L2-01A-31D-A41K-08","TCGA-ZG-A9ND-01A-11D-A41K-08","SRR458633","SRR462267","SRR464997","SRR465021","SRR468925","SRR473924","SRR478181","TCGA-CH-5765-01A-11D-1576-08","TCGA-EJ-7125-01A-11D-1961-08","TCGA-EJ-7328-01A-31D-2114-08","TCGA-FC-A6HD-01A-11D-A31L-08","TCGA-G9-7521-01A-11D-2260-08","TCGA-H9-A6BY-01A-11D-A30E-08","TCGA-HC-7747-01A-11D-2114-08","TCGA-HC-A8D0-01A-11D-A364-08","TCGA-J9-A52E-01A-11D-A26M-08","TCGA-KK-A6E0-01A-11D-A30X-08","TCGA-KK-A6E5-01A-11D-A30X-08","TCGA-KK-A8I6-01A-11D-A364-08","TCGA-KK-A8IM-01A-11D-A364-08","TCGA-QU-A6IL-01A-11D-A31L-08","TCGA-V1-A8MU-01A-11D-A377-08","TCGA-VP-A872-01A-11D-A34U-08","TCGA-YL-A8SB-01A-31D-A377-08","TCGA-YL-A8SI-01A-11D-A41K-08","TCGA-ZG-A8QX-01A-11D-A377-08","TCGA-ZG-A8QZ-01A-11D-A377-08","TCGA-ZG-A9L4-01A-11D-A41K-08","SRR3146821","SRR461561","SRR465813","SRR471241","SRR471793","SRR478063","SRR8304759","SRR8311876","TCGA-2A-A8W1-01A-11D-A377-08","TCGA-2A-AAYO-01A-11D-A41K-08","TCGA-EJ-5494-01A-01D-1576-08","TCGA-EJ-A65G-01A-21D-A29Q-08","TCGA-FC-7708-01A-11D-2114-08","TCGA-G9-6343-01A-21D-1961-08","TCGA-G9-6354-01A-11D-A30X-08","TCGA-G9-6379-01A-11D-A31L-08","TCGA-G9-6498-01A-12D-A30X-08","TCGA-G9-7519-01A-11D-2260-08","TCGA-HC-7075-01A-11D-1961-08","TCGA-HC-7231-01A-11D-2114-08","TCGA-HC-7232-01A-11D-2114-08","TCGA-J4-8198-01A-11D-2260-08","TCGA-KK-A6E1-01A-11D-A30X-08","TCGA-KK-A8IH-01A-11D-A364-08","TCGA-KK-A8IJ-01A-11D-A34U-08","TCGA-M7-A71Z-01A-12D-A32B-08","TCGA-QU-A6IO-01A-11D-A31L-08","TCGA-V1-A8X3-01A-11D-A377-08","TCGA-YL-A9WK-01A-11D-A377-08","TCGA-YL-A9WL-01A-11D-A41K-08","TCGA-ZG-A9MC-01A-31D-A41K-08","SRR458543","SRR461489","SRR462188","SRR463012","SRR465371","SRR465510","SRR465855","SRR471613","SRR477230","TCGA-2A-A8VV-01A-11D-A377-08","TCGA-2A-AAYF-01A-11D-A41K-08","TCGA-CH-5745-01A-11D-1576-08","TCGA-EJ-5498-01A-01D-1576-08","TCGA-EJ-5542-01A-01D-1576-08","TCGA-EJ-7315-01A-31D-2114-08","TCGA-EJ-7327-01A-11D-2114-08","TCGA-EJ-8469-01A-11D-2395-08","TCGA-HC-A48F-01A-11D-A257-08","TCGA-HC-A6AQ-01A-11D-A30E-08","TCGA-J4-A83K-01A-11D-A34U-08","TCGA-KC-A7F3-01A-21D-A33T-08","TCGA-KK-A7B1-01A-11D-A32B-08","TCGA-V1-A9O7-01A-21D-A41K-08","TCGA-VN-A88R-01A-11D-A364-08","TCGA-XQ-A8TB-01A-11D-A364-08","TCGA-YL-A9WJ-01A-11D-A377-08","SRR460152","SRR5876762","SRR5876764","TCGA-2A-A8VL-01A-21D-A377-08","TCGA-CH-5740-01A-11D-1576-08","TCGA-CH-5744-01A-11D-1576-08","TCGA-CH-5794-01A-11D-1576-08","TCGA-EJ-7312-01B-21D-A32B-08","TCGA-EJ-8468-01A-21D-2395-08","TCGA-G9-6332-01A-11D-1786-08","TCGA-HC-7212-01A-11D-2114-08","TCGA-HC-7818-01A-11D-2114-08","TCGA-HC-8266-01A-11D-2260-08","TCGA-HC-A6HY-01A-11D-A31L-08","TCGA-HI-7169-01A-11D-2114-08","TCGA-J4-A67N-01A-11D-A30E-08","TCGA-KK-A59Y-01A-11D-A26M-08","TCGA-V1-A9OT-01A-11D-A41K-08","TCGA-VN-A88N-01A-11D-A364-08","TCGA-XK-AAIR-01A-11D-A41K-08","TCGA-ZG-A9L1-01A-11D-A41K-08","SRR461441","SRR472039","SRR478299","SRR486768","TCGA-EJ-5532-01A-01D-1576-08","TCGA-EJ-8470-01A-11D-2395-08","TCGA-G9-6329-01A-13D-1961-08","TCGA-G9-6351-01A-21D-1961-08","TCGA-HC-7745-01A-11D-2114-08","TCGA-HC-8261-01A-11D-2260-08","TCGA-HC-A6AS-01A-11D-A30E-08","TCGA-J4-A83I-01A-11D-A364-08","TCGA-KC-A7F6-01A-11D-A33T-08","TCGA-V1-A9OX-01A-11D-A41K-08","TCGA-VP-A876-01A-11D-A34U-08","TCGA-XJ-A83G-01A-11D-A34U-08","TCGA-ZG-A9LS-01A-12D-A41K-08","TCGA-ZG-A9LU-01A-11D-A41K-08","SRR466629","SRR472417","SRR473840","SRR477114","SRR478357","SRR5876742","SRR8307108","TCGA-EJ-5510-01A-01D-1576-08","TCGA-EJ-5517-01A-01D-1576-08","TCGA-EJ-7331-01A-11D-2114-08","TCGA-EJ-7792-01A-11D-2114-08","TCGA-G9-6365-01A-11D-1786-08","TCGA-G9-6384-01A-11D-1786-08","TCGA-G9-7509-01A-11D-A41K-08","TCGA-HC-7209-01A-11D-2114-08","TCGA-HC-7230-01A-11D-2114-08","TCGA-HC-7736-01A-11D-2114-08","TCGA-HC-7748-01A-11D-2114-08","TCGA-HC-A8D1-01A-11D-A364-08","TCGA-J4-A6G3-01A-11D-A30X-08","TCGA-J9-A8CK-01A-11D-A34U-08","TCGA-KK-A7B2-01A-12D-A32B-08","TCGA-KK-A8I4-01A-11D-A364-08","TCGA-KK-A8IC-01A-11D-A364-08","TCGA-V1-A8MG-01A-11D-A364-08","TCGA-V1-A8MM-01A-11D-A377-08","TCGA-V1-A9OA-01A-11D-A41K-08","TCGA-V1-A9ZK-01A-11D-A41K-08","SRR4043933","SRR466557","SRR468313","SRR472945","SRR474438","TCGA-CH-5741-01A-11D-1576-08","TCGA-EJ-7325-01B-11D-A32B-08","TCGA-EJ-7797-01A-11D-2260-08","TCGA-EJ-A7NH-01A-12D-A33T-08","TCGA-FC-A5OB-01A-11D-A29Q-08","TCGA-G9-6342-01A-11D-1961-08","TCGA-G9-6373-01A-11D-1786-08","TCGA-G9-6378-01A-11D-1786-08","TCGA-HC-A6HX-01A-11D-A31L-08","TCGA-J4-8200-01A-11D-A29Q-08","TCGA-J4-A6G1-01A-11D-A30X-08","TCGA-J9-A8CN-01A-11D-A34U-08","TCGA-QU-A6IN-01A-11D-A31L-08","SRR4044012","SRR460086","SRR465789","SRR471433","SRR472882","TCGA-EJ-7786-01A-11D-2114-08","TCGA-EJ-A6RC-01A-11D-A32B-08","TCGA-G9-6347-01A-11D-A31L-08","TCGA-G9-6364-01A-21D-1786-08","TCGA-HC-7211-01A-11D-2114-08","TCGA-HC-7821-01A-12D-2114-08","TCGA-HC-8213-01A-11D-A29Q-08","TCGA-J4-A67O-01A-11D-A30E-08","TCGA-KK-A7AU-01A-11D-A32B-08","TCGA-KK-A8I7-01A-21D-A364-08","TCGA-YL-A8HL-01A-11D-A364-08","TCGA-YL-A8SF-01A-11D-A377-08","SRR468361","SRR468685","SRR8304753","TCGA-CH-5743-01A-21D-1576-08","TCGA-EJ-5501-01A-01D-1576-08","TCGA-EJ-5522-01A-01D-1576-08","TCGA-EJ-A7NF-01A-11D-A33T-08","TCGA-FC-A8O0-01A-41D-A377-08","TCGA-G9-6336-01A-11D-1786-08","TCGA-HC-7750-01A-11D-2114-08","TCGA-HC-7819-01A-11D-2114-08","TCGA-M7-A71Y-01A-22D-A32B-08","TCGA-QU-A6IP-01A-11D-A31L-08","TCGA-SU-A7E7-01A-22D-A33T-08","TCGA-VP-A87E-01A-31D-A34U-08","SRR3146955","SRR464787","SRR472556","SRR474935","SRR477889","TCGA-EJ-7785-01A-11D-2114-08","TCGA-EJ-AB20-01A-12D-A41K-08","TCGA-HC-7740-01A-11D-2114-08","TCGA-HC-8256-01A-11D-2260-08","TCGA-V1-A8WN-01A-11D-A377-08","TCGA-XA-A8JR-01A-11D-A364-08","TCGA-CH-5790-01A-11D-1576-08","TCGA-EJ-5509-01A-01D-1576-08","TCGA-HC-8258-01A-11D-2260-08","TCGA-J4-A67S-01A-11D-A30E-08","TCGA-J4-A67T-01A-11D-A30X-08","TCGA-J4-A6M7-01A-11D-A31L-08","TCGA-J4-A83L-01A-11D-A34U-08","TCGA-J4-A83N-01A-11D-A34U-08","TCGA-V1-A9OY-01A-11D-A41K-08","TCGA-VN-A88I-01A-11D-A34U-08","TCGA-YL-A8HK-01A-11D-A364-08","SRR3146925","SRR468565","SRR477348","SRR477408","SRR477710","SRR485163","TCGA-CH-5738-01A-11D-1576-08","TCGA-EJ-5508-01A-02D-1576-08","TCGA-EJ-5512-01A-01D-1576-08","TCGA-EJ-5531-01A-01D-1576-08","TCGA-HC-7817-01B-11D-A29Q-08","TCGA-J4-A67Q-01A-21D-A30E-08","TCGA-J4-A67R-01A-21D-A30E-08","TCGA-KC-A7FE-01A-12D-A33T-08","TCGA-KK-A7AV-01A-11D-A32B-08","TCGA-KK-A8I8-01A-11D-A364-08","TCGA-XJ-A9DI-01A-11D-A377-08","SRR473087","TCGA-EJ-5497-01A-02D-1576-08","TCGA-EJ-7794-01A-11D-2114-08","TCGA-EJ-A46B-01A-31D-A257-08","TCGA-G9-7523-01A-11D-2260-08","TCGA-HC-7737-01A-11D-2114-08","TCGA-KC-A4BL-01A-31D-A257-08","TCGA-KC-A4BN-01A-61D-A257-08","TCGA-V1-A8MJ-01A-11D-A364-08","TCGA-V1-A8ML-01A-11D-A377-08","TCGA-V1-A9OF-01A-11D-A41K-08","TCGA-VN-A88L-01A-11D-A34U-08","TCGA-VN-A88M-01A-11D-A34U-08","SRR3146773","SRR4043909","SRR460038","TCGA-EJ-5516-01A-01D-1576-08","TCGA-EJ-A6RA-01A-11D-A33T-08","TCGA-EJ-AB27-01A-11D-A41K-08","SRR4043990","SRR458681","SRR478241","SRR8304748","TCGA-EJ-7791-01A-11D-2114-08","TCGA-EJ-A8FO-01A-21D-A364-08","TCGA-G9-7522-01A-11D-2260-08","SRR2404067","SRR3146741","SRR3146926","SRR4043960","SRR474977","TCGA-CH-5746-01A-11D-1576-08","TCGA-EJ-5515-01A-01D-1576-08","TCGA-EJ-A46D-01A-21D-A257-08","TCGA-EJ-A8FU-01A-11D-A364-08","SRR460104","SRR462128","SRR472153","SRR472616","TCGA-EJ-5502-01A-01D-1576-08","TCGA-EJ-A7NJ-01A-22D-A34U-08","TCGA-HC-8260-01A-11D-2260-08","TCGA-XJ-A9DK-01A-11D-A377-08","SRR3146761","SRR3146809","SRR4043981","SRR462988","SRR473245","SRR8307103","TCGA-EJ-5503-01A-01D-1576-08","SRR3146972","SRR4043905","SRR458657","TCGA-CH-5763-01A-11D-1576-08","TCGA-EJ-7793-01A-31D-2260-08","TCGA-M7-A720-01A-12D-A32B-08","SRR3146717","SRR3146731","SRR3146778","SRR3146922","TCGA-EJ-5506-01A-01D-1576-08","TCGA-EJ-A8FP-01A-21D-A364-08","TCGA-G9-6353-01A-11D-1961-08","TCGA-G9-6385-01A-11D-1786-08","TCGA-V1-A8MK-01A-11D-A364-08","TCGA-XJ-A9DQ-01A-11D-A377-08","TCGA-YL-A9WX-01A-21D-A41K-08","SRR3146869","SRR3146896","SRR3146923","SRR458519","SRR471289","SRR472015","TCGA-EJ-A7NK-01A-12D-A34U-08","TCGA-H9-A6BX-01A-31D-A30X-08","TCGA-KC-A4BR-01A-32D-A257-08","SRR3146720","SRR3146738","SRR3146753","SRR3146890","SRR3146968","SRR4043795","SRR4043920","SRR4043997","TCGA-G9-6367-01A-11D-1786-08","TCGA-J4-AATV-01A-11D-A41K-08","SRR3146715","SRR3146727","SRR3146763","SRR3146765","SRR3146768","SRR3146775","SRR3146811","SRR3146815","SRR3146825","SRR3146827","SRR3146831","SRR3146846","SRR3146853","SRR3146874","SRR3146879","SRR3146887","SRR3146903","SRR3146904","SRR3146909","SRR3146912","SRR3146916","SRR3146933","SRR3146943","SRR3146967","SRR3146969","SRR3146971","SRR8304843","SRR8311840","TCGA-EJ-A46H-01A-31D-A26M-08","TCGA-FC-A66V-01A-21D-A30E-08","TCGA-G9-6370-01A-11D-1786-08","TCGA-HC-7079-01A-11D-1961-08"],[57,236,265,29,156,237,262,143,95,18,76,89,54,44,6,60,61,46,44,46,38,24,16,22,16,24,12,4,9,18,4,3,16,17,6,12,13,13,10,18,12,2,3,13,8,8,4,3,10,8,16,10,20,9,7,2,11,14,13,10,14,17,2,12,10,5,10,9,4,1,9,4,4,10,9,16,13,7,19,12,8,19,14,12,14,25,9,1,8,4,1,2,2,8,2,5,8,8,2,15,7,6,7,7,7,3,5,3,6,3,3,5,15,4,14,3,4,5,4,6,4,7,4,0,5,6,3,2,5,6,4,1,8,8,8,5,3,4,25,5,3,3,8,3,7,5,3,5,1,6,1,8,15,4,3,1,12,2,1,5,2,3,5,3,2,6,6,5,6,3,0,7,7,5,4,0,5,5,6,5,4,6,6,3,4,4,3,8,8,7,6,3,4,5,3,3,7,2,2,3,4,2,4,3,3,3,2,1,4,10,3,0,8,2,4,3,8,1,1,2,1,5,4,3,2,5,4,4,2,4,1,1,3,2,6,2,4,2,1,5,3,4,4,7,1,2,7,2,2,5,2,5,2,4,7,2,1,2,10,3,4,1,2,1,2,3,4,2,3,7,6,3,2,3,4,2,1,2,4,4,6,4,4,0,5,1,6,5,4,2,2,1,0,3,4,4,1,2,4,2,1,2,5,3,6,7,6,5,1,1,4,5,3,0,5,5,2,1,4,1,2,4,3,1,1,3,3,0,6,6,2,2,5,2,2,2,2,3,3,5,5,4,0,1,3,4,5,0,6,3,4,1,3,0,3,6,1,3,2,1,4,1,2,2,2,1,3,0,0,2,0,5,3,2,2,2,0,0,1,3,4,4,2,4,2,0,4,3,2,2,4,3,2,2,4,1,1,0,2,5,2,3,0,0,2,1,4,6,1,4,5,1,7,3,5,2,0,2,4,0,2,0,2,2,1,2,2,3,2,0,2,1,1,4,4,2,5,2,0,1,4,1,0,1,3,2,1,2,0,3,3,1,5,4,2,2,1,3,3,1,2,3,3,1,1,1,0,7,1,2,2,2,2,1,4,3,1,2,3,0,1,0,1,1,0,0,0,2,0,5,1,0,2,0,3,0,2,3,4,0,3,1,1,2,0,1,2,3,2,1,1,3,3,2,2,2,1,1,2,1,5,2,5,0,2,0,1,2,0,3,3,5,3,1,1,3,1,3,4,2,2,1,2,2,1,0,2,0,2,4,0,1,4,3,4,1,2,3,0,1,3,0,2,3,3,0,2,2,4,2,2,0,0,1,0,1,0,0,3,4,2,2,1,3,0,4,4,1,2,1,3,2,1,1,4,2,0,4,1,2,1,0,1,0,3,4,2,1,3,1,2,0,3,1,0,0,2,3,2,1,2,2,7,5,1,4,3,4,1,4,2,1,1,1,2,1,1,2,0,0,5,0,0,3,1,2,2,2,0,4,1,2,2,1,1,2,1,4,3,1,1,0,1,0,1,2,3,1,2,2,1,1,0,1,0,1,1,0,1,3,4,1,0,1,2,1,2,2,1,2,1,2,0,1,0,2,1,1,1,0,1,1,2,0,0,1,1,1,1,1,2,2,0,1,2,0,3,1,0,0,0,0,0,1,1,2,1,3,4,3,0,2,2,2,4,2,2,1,5,3,1,2,1,2,1,0,3,2,1,4,2,1,3,1,3,7,1,2,1,1,2,3,3,1,2,1,0,1,1,0,1,0,0,1,0,1,0,2,0,0,0,1,0,0,2,0,0,1,2,0,0,0,0,0,1,3,1,2,0,2,0,1,2,3,3,2,1,0,0,0,0,1,2,1,1,1,2,1,3,0,1,2,0,3,0,2,1,1,1,0,0,0,0,1,3,0,1,2,0,0,1,1,0,3,1,1,0,1,3,1,2,0,1,2,0,0,2,3,0,0,0,0,3,0,0,0,0,1,0,1,0,0,1,0,1,0,0,1,0,0,0,1,1,0,0,2,0,2,0,0,1,0,0,1,0,0,0,0,1,0,1,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,0,1,0,0,0,0,0,2,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1],[7,4,4,2,2,3,95,65,3,1,0,1,12,3,0,43,1,3,4,1,3,0,19,1,4,2,2,0,1,2,2,1,2,0,2,1,0,4,1,0,2,1,6,0,0,1,0,2,3,3,2,1,1,1,2,2,4,1,1,0,0,1,0,1,0,1,1,2,3,1,2,1,0,2,1,1,0,3,3,1,2,1,2,2,1,0,0,1,1,1,1,0,0,2,0,0,0,3,0,7,1,2,2,0,3,1,0,0,1,0,1,0,1,2,0,0,3,0,1,1,0,1,1,2,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,0,1,1,1,0,2,0,0,1,0,2,0,2,0,2,1,1,0,0,0,2,1,0,0,0,2,1,0,2,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,0,0,3,0,1,0,1,0,1,0,1,1,0,1,0,2,2,0,1,0,1,0,1,0,0,1,1,0,1,1,0,0,1,0,2,0,0,1,1,1,0,0,2,0,1,0,0,1,0,0,0,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,2,0,0,2,2,0,1,1,0,0,0,2,0,0,0,2,1,0,1,0,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,1,0,0,0,0,1,0,0,0,2,0,1,0,1,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,0,0,1,0,0,0,0,1,3,1,0,0,0,2,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0,1,0,1,1,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,0,1,1,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,1,0,0,0,2,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,0,1,0,1,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,1,1,0,1,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[50,31,62,17,34,38,14,59,19,9,10,12,16,18,5,31,14,6,2,6,1,2,12,1,2,3,2,5,1,1,1,5,3,1,1,0,3,1,1,2,0,0,1,2,2,2,0,2,0,0,2,3,2,2,1,1,1,3,1,5,1,4,1,15,3,1,0,3,0,3,0,0,2,1,0,2,2,1,2,1,1,2,1,3,1,12,1,1,6,2,1,1,1,3,3,3,1,1,2,4,4,2,0,1,0,2,1,1,2,1,1,7,2,3,1,2,1,6,1,2,4,2,1,1,1,2,1,2,0,2,0,0,1,1,1,2,2,2,1,1,2,3,2,2,1,1,4,4,1,0,0,0,1,2,0,2,0,3,1,2,2,2,1,0,0,1,0,4,2,1,0,2,1,1,2,1,0,3,1,1,2,4,2,1,0,1,0,1,1,0,1,2,2,2,2,0,1,2,1,0,4,2,3,1,1,1,2,3,1,4,0,1,2,0,0,1,2,1,1,0,0,0,0,2,1,1,1,3,1,3,0,0,4,2,0,1,0,0,2,1,1,0,1,0,0,2,2,1,3,1,2,0,3,0,2,4,3,2,0,1,1,1,2,2,0,1,1,3,1,0,1,1,4,2,1,0,2,0,1,1,0,0,1,0,2,3,1,1,3,0,2,1,0,2,2,3,2,2,1,3,0,2,2,2,1,0,0,1,2,2,1,0,2,1,0,0,1,0,1,2,3,3,0,0,0,0,2,0,0,3,3,0,0,0,0,1,0,2,2,3,0,0,0,0,1,1,0,1,0,0,0,0,0,0,3,0,3,0,0,0,1,2,0,1,3,1,2,0,0,2,1,1,1,0,1,2,0,1,1,0,1,2,0,0,3,0,0,0,2,1,1,0,0,0,1,0,0,1,1,1,1,0,2,1,1,2,0,1,0,0,0,1,0,3,0,2,0,0,2,1,1,0,0,1,0,1,1,4,1,0,1,1,0,0,0,0,1,1,1,2,1,0,2,0,2,0,0,0,1,0,0,0,1,0,0,1,2,0,2,0,0,0,1,0,0,1,0,1,0,0,0,0,1,0,0,1,2,2,0,1,0,0,0,0,1,1,0,0,0,1,1,1,0,2,0,0,0,0,2,3,3,0,0,0,1,0,0,0,0,2,0,0,1,0,1,0,1,2,0,1,0,0,0,2,1,0,0,0,0,0,0,0,2,0,0,0,2,0,1,0,0,0,1,0,0,0,0,2,2,1,3,2,0,0,1,0,0,2,1,0,2,2,1,1,2,0,3,0,0,0,1,1,1,1,1,1,0,1,0,1,0,1,1,0,1,1,0,1,0,0,1,0,3,1,0,0,0,0,0,2,0,2,1,1,3,1,3,1,1,1,0,4,1,0,1,1,0,0,1,1,0,0,0,0,0,0,0,3,3,0,0,0,2,0,0,1,1,0,0,2,0,0,0,1,0,0,1,1,0,2,1,1,0,1,0,0,2,0,0,1,0,0,0,0,0,2,2,0,1,0,1,1,0,0,1,0,1,0,1,1,1,1,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0,2,2,1,0,0,0,0,0,0,1,1,1,0,1,1,0,0,0,0,0,0,0,0,1,0,0,2,0,0,0,0,0,1,3,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,1,0,0,1,0,0,0,1,2,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,1,1,5,0,1,1,2,1,0,0,0,0,1,0,1,0,2,1,1,0,0,0,0,0,0,1,0,0,2,0,1,1,0,0,0,2,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],[6532,841,778,914,727,607,357,395,429,486,424,373,388,394,380,226,286,281,279,177,174,181,141,164,163,151,155,125,121,108,120,113,100,102,108,102,98,95,101,89,94,105,98,92,97,95,100,97,91,92,83,89,79,90,91,96,83,81,82,82,81,72,90,65,80,85,80,75,80,81,74,80,78,71,73,62,66,70,56,66,69,57,62,61,62,40,66,72,60,66,67,67,67,57,64,61,60,57,64,41,56,58,59,60,57,61,61,62,57,62,61,53,47,56,50,59,56,53,58,55,56,54,57,60,57,54,58,59,58,54,58,61,53,53,53,54,55,53,33,53,54,52,48,53,49,51,50,48,54,50,55,48,39,50,52,52,44,50,53,47,50,49,49,50,52,47,47,44,43,49,51,44,42,45,45,51,47,44,43,44,45,41,43,45,46,46,45,41,41,42,43,45,43,43,45,45,41,45,46,46,41,44,42,45,43,44,44,44,43,31,45,45,37,44,43,42,37,44,44,45,45,42,40,39,43,39,41,38,42,37,44,44,37,40,39,41,40,43,42,37,40,38,39,37,42,39,34,41,38,35,39,37,38,39,33,37,38,38,30,38,37,40,38,38,39,37,36,36,37,34,34,37,35,36,35,38,38,39,36,36,35,36,35,40,32,36,33,34,33,38,36,37,39,35,33,32,36,33,34,34,36,33,32,32,30,31,32,32,33,35,33,33,31,36,33,32,35,36,31,33,32,30,34,36,36,34,32,37,31,28,32,35,32,33,34,34,35,30,31,28,31,32,35,35,32,31,29,35,29,33,30,34,32,35,29,29,31,32,32,34,29,31,32,30,29,32,29,34,33,30,33,28,30,31,28,29,34,32,31,28,28,27,31,29,28,33,29,29,29,29,28,30,29,30,27,31,31,31,29,26,29,28,30,31,28,29,28,24,31,28,27,29,24,25,26,27,31,28,25,30,28,31,29,27,30,27,27,23,26,30,27,27,29,26,26,28,24,27,29,26,25,28,27,27,23,27,28,27,28,26,26,27,23,25,27,25,26,26,23,28,27,26,25,27,28,27,29,21,28,27,25,24,25,25,24,24,25,24,25,27,27,28,27,27,27,27,28,26,28,22,26,25,25,26,25,27,24,23,21,24,20,26,26,25,26,26,24,23,25,24,26,24,23,24,24,25,24,24,25,25,22,24,22,25,24,27,26,25,26,23,23,21,21,25,24,22,23,22,21,23,24,25,23,22,25,26,24,23,22,21,23,22,22,23,21,25,24,21,24,25,21,23,22,21,20,25,20,23,21,23,21,24,23,23,24,22,24,24,22,20,22,21,22,21,23,19,20,22,22,22,20,22,19,21,20,21,24,20,23,19,22,22,22,22,17,19,18,21,19,21,21,19,18,22,22,22,21,20,20,20,21,21,16,18,22,19,19,16,19,19,21,22,20,22,20,20,20,20,22,20,17,22,22,18,20,18,19,19,22,16,20,19,20,19,21,20,19,18,19,20,21,22,21,21,21,17,16,20,16,19,19,19,21,20,19,20,19,21,19,17,16,19,20,20,19,18,19,19,19,19,19,18,19,18,19,18,19,17,17,19,19,19,18,20,20,19,18,18,18,19,17,17,19,18,17,19,16,18,19,19,18,19,19,15,17,17,18,16,14,14,15,16,16,16,14,16,15,16,13,14,17,15,17,15,17,18,15,16,16,14,16,17,15,17,15,11,16,15,16,16,15,13,14,15,14,15,17,15,15,17,16,16,15,16,17,16,16,14,16,16,15,14,14,15,13,15,16,15,14,16,15,16,16,14,13,6,14,12,14,11,14,13,13,12,12,12,14,13,14,12,13,12,12,13,12,13,12,13,10,13,12,8,13,8,12,11,12,11,10,13,12,10,12,10,9,11,11,10,11,12,11,11,12,9,11,11,12,10,7,9,9,11,9,9,11,11,8,8,11,11,9,9,7,10,10,9,9,7,9,8,8,9,8,8,7,7,8,7,8,8,8,7,6,7,6,5,7,5,7,6,5,5,6,5,6,6,6,5,4,5,4,4,4,4,3,4,2,4,4,3,4,4,4,4,3,3,2,3,3,3,3,1,3,1,2,0,2,2,2,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1,0],[0,0,0,1,0,0,9,8,0,0,0,0,2,1,0,3,0,0,1,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[6646,1112,1109,963,919,885,737,670,546,514,510,475,472,460,391,363,362,336,330,230,216,207,191,188,185,180,171,134,132,129,127,122,121,120,117,115,114,113,113,109,108,108,108,107,107,106,104,104,104,103,103,103,102,102,101,101,99,99,97,97,96,94,93,93,93,92,91,89,87,86,85,85,84,84,83,81,81,81,80,80,80,79,79,78,78,77,76,75,75,73,70,70,70,70,69,69,69,69,68,68,68,68,68,68,67,67,67,66,66,66,66,65,65,65,65,64,64,64,64,64,64,64,63,63,63,63,63,63,63,62,62,62,62,62,62,61,60,59,59,59,59,58,58,58,57,57,57,57,56,56,56,56,56,56,56,56,56,55,55,55,55,55,55,55,54,54,54,53,53,53,53,53,52,52,52,52,52,52,52,51,51,51,51,51,51,51,50,50,50,50,50,50,50,50,50,49,49,49,49,49,49,49,49,49,48,48,48,48,48,48,48,47,47,47,47,47,47,47,47,47,47,47,46,46,46,46,46,46,45,45,45,45,45,45,45,45,45,45,45,44,44,44,44,44,44,44,44,44,43,43,43,43,43,43,43,43,42,42,42,42,42,42,42,42,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,40,40,40,40,40,40,40,40,40,40,40,40,40,39,39,39,39,39,39,39,39,39,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,36,36,36,36,36,36,36,36,36,36,36,36,36,35,35,35,35,35,35,35,35,35,35,35,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,31,31,31,31,31,31,31,31,31,31,31,31,31,31,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,14,14,14,14,14,14,14,14,14,14,14,13,13,13,13,13,13,13,13,13,13,13,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,11,11,11,11,11,11,11,11,11,11,11,11,11,10,10,10,10,10,10,9,9,9,9,9,9,9,8,8,8,8,8,8,8,8,8,7,7,7,7,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Tumor_Sample_Barcode<\/th>\n      <th>DEL<\/th>\n      <th>DNP<\/th>\n      <th>INS<\/th>\n      <th>SNP<\/th>\n      <th>TNP<\/th>\n      <th>total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb134-2" data-line-number="2"></a>
<a class="sourceLine" id="cb134-3" data-line-number="3">tb_maf =<span class="st"> </span>Maf<span class="op">@</span>variant.type.summary <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb134-4" data-line-number="4"><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Tumor_Sample_Barcode) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb134-5" data-line-number="5"><span class="st"> </span>psych<span class="op">::</span><span class="kw">describe</span>(<span class="dt">quant=</span><span class="kw">c</span>(.<span class="dv">25</span>,.<span class="dv">75</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb134-6" data-line-number="6"><span class="st"> </span><span class="kw">as_tibble</span>(<span class="dt">rownames=</span><span class="st">&quot;rowname&quot;</span>)   </a>
<a class="sourceLine" id="cb134-7" data-line-number="7"></a>
<a class="sourceLine" id="cb134-8" data-line-number="8">DT<span class="op">::</span><span class="kw">datatable</span>(tb_maf)</a></code></pre></div>
<div id="htmlwidget-051f55049102b1f2e8c6" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-051f55049102b1f2e8c6">{"x":{"filter":"none","data":[["1","2","3","4","5","6"],["DEL","DNP","INS","SNP","TNP","total"],[1,2,3,4,5,6],[965,965,965,965,965,965],[4.8880829015544,0.637305699481865,1.30362694300518,45.4932642487047,0.0321243523316062,52.3544041450777],[18.7377044873085,4.07031774056375,4.19222226218254,220.567800864573,0.422406837524769,231.189022001403],[2,0,1,25,0,28],[2.24579560155239,0.22509702457956,0.66882276843467,27.7658473479948,0,31.3583441138422],[1.4826,0,1.4826,14.826,0,17.7912],[0,0,0,0,0,1],[265,95,62,6532,9,6646],[265,95,62,6532,9,6645],[10.7370363642893,18.3112279263528,9.80243145807353,26.5990841312692,17.7694482147829,24.5095848652523],[129.615650281407,373.797839562045,115.143263136306,772.844913905661,344.432654161125,684.431117819273],[0.603188049672807,0.131028164156512,0.134952409556547,7.10032873633138,0.0135977572208805,7.44223794228599],[1,0,0,17,0,19],[4,1,1,39,0,44]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>rowname<\/th>\n      <th>vars<\/th>\n      <th>n<\/th>\n      <th>mean<\/th>\n      <th>sd<\/th>\n      <th>median<\/th>\n      <th>trimmed<\/th>\n      <th>mad<\/th>\n      <th>min<\/th>\n      <th>max<\/th>\n      <th>range<\/th>\n      <th>skew<\/th>\n      <th>kurtosis<\/th>\n      <th>se<\/th>\n      <th>Q0.25<\/th>\n      <th>Q0.75<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="summary-plots" class="section level2">
<h2>Summary plots</h2>
<div id="maf" class="section level3">
<h3>MAF</h3>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1"><span class="kw">library</span>(maftools)</a></code></pre></div>
<div id="maf-summary" class="section level4">
<h4>MAF summary</h4>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1"><span class="kw">plotmafSummary</span>(<span class="dt">maf =</span> Maf, <span class="dt">rmOutlier =</span> <span class="ot">TRUE</span>, <span class="dt">addStat =</span> <span class="st">&#39;median&#39;</span>, <span class="dt">dashboard =</span> <span class="ot">TRUE</span>, <span class="dt">titvRaw =</span> <span class="ot">FALSE</span>, <span class="dt">log_scale =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-120-1.png" width="2400" /></p>
</div>
<div id="transition-and-transversions" class="section level4">
<h4>Transition and Transversions</h4>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" data-line-number="1">maf.titv =<span class="st"> </span><span class="kw">titv</span>(<span class="dt">maf =</span> Maf, <span class="dt">plot =</span> <span class="ot">FALSE</span>, <span class="dt">useSyn =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb137-2" data-line-number="2"><span class="co">#plot titv summary</span></a>
<a class="sourceLine" id="cb137-3" data-line-number="3"><span class="kw">plotTiTv</span>(<span class="dt">res =</span> maf.titv)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-121-1.png" width="2400" /></p>
</div>
<div id="somatic-interactions" class="section level4">
<h4>Somatic Interactions</h4>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1"><span class="kw">somaticInteractions</span>(<span class="dt">maf =</span> Maf, <span class="dt">top =</span> <span class="dv">25</span>, <span class="dt">pvalue =</span> <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-122-1.png" width="2400" /></p>
<pre><code>#&gt;       gene1  gene2       pValue  oddsRatio  00 11 01 10              Event
#&gt;   1: ABCA13  KMT2C 5.107880e-08 10.2128843 896 13 42 27       Co_Occurence
#&gt;   2:   RYR3 ABCA13 1.510688e-05  9.8852463 915  8 32 23       Co_Occurence
#&gt;   3:  OBSCN    TTN 2.087377e-05  4.7803808 841 15 94 28       Co_Occurence
#&gt;   4:  KMT2C  KMT2D 3.687480e-05  5.3043820 877 12 46 43       Co_Occurence
#&gt;   5:  FOXA1  CDK12 4.320195e-05  5.8603172 873 11 23 71       Co_Occurence
#&gt;  ---                                                                      
#&gt;               pair event_ratio
#&gt;   1: ABCA13, KMT2C       13/69
#&gt;   2:  ABCA13, RYR3        8/55
#&gt;   3:    OBSCN, TTN      15/122
#&gt;   4:  KMT2C, KMT2D       12/89
#&gt;   5:  CDK12, FOXA1       11/94
#&gt;  ---                          
#&gt;  [ reached getOption(&quot;max.print&quot;) -- omitted 5 rows ]</code></pre>
</div>
</div>
<div id="copy-number-3" class="section level3">
<h3>Copy number</h3>
<div id="copy-number-segment-distribution" class="section level4">
<h4>Copy number segment distribution</h4>
<p>The distribution can be viewed as a histgram of segment length.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1"><span class="kw">show_cn_distribution</span>(CNV.seqz, <span class="dt">mode =</span> <span class="st">&quot;ld&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-123-1.png" width="2400" /></p>
<p>Length summary is:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" data-line-number="1"><span class="kw">summary</span>(CNV.seqz<span class="op">@</span>annotation<span class="op">$</span>fraction)</a>
<a class="sourceLine" id="cb141-2" data-line-number="2"><span class="co">#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></a>
<a class="sourceLine" id="cb141-3" data-line-number="3"><span class="co">#&gt; 0.0000001 0.0175022 0.1578263 0.4650056 0.8146213 1.9997271</span></a></code></pre></div>
<p>If we treat SCNA with length &gt; 0.7 as chromosome arm level or whole chromosome level alterations.</p>
<p>The fraction is:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1"><span class="kw">print</span>(<span class="kw">nrow</span>(CNV.seqz<span class="op">@</span>annotation[fraction <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.7</span> <span class="op">&amp;</span><span class="st"> </span>segVal <span class="op">!=</span><span class="st"> </span><span class="dv">2</span>]) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(CNV.seqz<span class="op">@</span>annotation[segVal <span class="op">!=</span><span class="st"> </span><span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb142-2" data-line-number="2"><span class="co">#&gt; [1] 0.1489081</span></a></code></pre></div>
<p>The distribution can also be viewed from the alteration load across chromosomes.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" data-line-number="1"><span class="kw">show_cn_distribution</span>(CNV.seqz, <span class="dt">mode =</span> <span class="st">&quot;cd&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-126-1.png" width="2400" /></p>
</div>
<div id="feature-distribution" class="section level4">
<h4>Feature distribution</h4>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" data-line-number="1"><span class="kw">show_cn_features</span>(CNV.seqz.tally.W<span class="op">$</span>features, <span class="dt">method =</span> <span class="st">&quot;W&quot;</span>, <span class="dt">log_y =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-127-1.png" width="3000" /></p>
</div>
<div id="component-distribution" class="section level4">
<h4>Component distribution</h4>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" data-line-number="1"><span class="kw">show_cn_components</span>(CNV.seqz.tally.W<span class="op">$</span>parameters, <span class="dt">method =</span> <span class="st">&quot;W&quot;</span>, <span class="dt">log_y =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-128-1.png" width="3000" /></p>
<p>Data details can be viewed as a table:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1">DT<span class="op">::</span><span class="kw">datatable</span>(CNV.seqz.tally.W<span class="op">$</span>parameters)</a></code></pre></div>
<div id="htmlwidget-245b6cf1e8eb924ee61f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-245b6cf1e8eb924ee61f">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80"],["BP10MB","BP10MB","BP10MB","BP10MB","BP10MB","BP10MB","BP10MB","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","BPArm","CN","CN","CN","CN","CN","CN","CN","CNCP","CNCP","CNCP","CNCP","CNCP","CNCP","CNCP","OsCN","OsCN","OsCN","OsCN","OsCN","OsCN","OsCN","SS","SS","SS","SS","SS","SS","SS","SS","NC50","NC50","NC50","NC50","NC50","NC50","NC50","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr","BoChr"],["BP10MB[0]","BP10MB[1]","BP10MB[2]","BP10MB[3]","BP10MB[4]","BP10MB[5]","BP10MB[&gt;5]","BPArm[0]","BPArm[1]","BPArm[2]","BPArm[3]","BPArm[4]","BPArm[5]","BPArm[6]","BPArm[7]","BPArm[8]","BPArm[9]","BPArm[10]","BPArm[&gt;10 &amp; &lt;=20]","BPArm[&gt;20 &amp; &lt;=30]","BPArm[&gt;30]","CN[0]","CN[1]","CN[2]","CN[3]","CN[4]","CN[&gt;4 &amp; &lt;=8]","CN[&gt;8]","CNCP[0]","CNCP[1]","CNCP[2]","CNCP[3]","CNCP[4]","CNCP[&gt;4 &amp; &lt;=8]","CNCP[&gt;8]","OsCN[0]","OsCN[1]","OsCN[2]","OsCN[3]","OsCN[4]","OsCN[&gt;4 &amp; &lt;=10]","OsCN[&gt;10]","SS[&lt;=2]","SS[&gt;2 &amp; &lt;=3]","SS[&gt;3 &amp; &lt;=4]","SS[&gt;4 &amp; &lt;=5]","SS[&gt;5 &amp; &lt;=6]","SS[&gt;6 &amp; &lt;=7]","SS[&gt;7 &amp; &lt;=8]","SS[&gt;8]","NC50[&lt;=2]","NC50[3]","NC50[4]","NC50[5]","NC50[6]","NC50[7]","NC50[&gt;7]","BoChr[1]","BoChr[2]","BoChr[3]","BoChr[4]","BoChr[5]","BoChr[6]","BoChr[7]","BoChr[8]","BoChr[9]","BoChr[10]","BoChr[11]","BoChr[12]","BoChr[13]","BoChr[14]","BoChr[15]","BoChr[16]","BoChr[17]","BoChr[18]","BoChr[19]","BoChr[20]","BoChr[21]","BoChr[22]","BoChr[23]"],["point","point","point","point","point","point","range","point","point","point","point","point","point","point","point","point","point","point","range","range","range","point","point","point","point","point","range","range","point","point","point","point","point","range","range","point","point","point","point","point","range","range","range","range","range","range","range","range","range","range","range","point","point","point","point","point","range","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point","point"],[0,1,2,3,4,5,5,0,1,2,3,4,5,6,7,8,9,10,10,20,30,0,1,2,3,4,4,8,0,1,2,3,4,4,8,0,1,2,3,4,4,10,null,2,3,4,5,6,7,8,null,3,4,5,6,7,7,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],[0,1,2,3,4,5,null,0,1,2,3,4,5,6,7,8,9,10,20,30,null,0,1,2,3,4,8,null,0,1,2,3,4,8,null,0,1,2,3,4,10,null,2,3,4,5,6,7,8,null,2,3,4,5,6,7,null,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],[262755,22436,12074,2349,1277,374,449,27296,4763,5737,1896,1836,901,824,432,358,226,186,466,50,5,1464,7431,31755,11911,13087,15272,5372,8350,29323,15725,5661,3477,5024,4594,31108,7283,834,601,129,174,6,202,1995,2478,4829,10672,22165,36157,7794,89,111,141,163,160,207,66,4303,2673,2991,2359,2485,3587,3805,2969,2299,2654,2531,2294,1405,1563,1175,2515,3060,1291,2210,1853,1209,1443,816]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>feature<\/th>\n      <th>component<\/th>\n      <th>label<\/th>\n      <th>min<\/th>\n      <th>max<\/th>\n      <th>n_obs<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<blockquote>
<p><code>n_obs</code> column indicates the number of event of corresponding copy number component.</p>
</blockquote>
</div>
</div>
</div>
</div>
<div id="supplementary-analysis-and-visualization" class="section level1">
<h1>Supplementary Analysis and Visualization</h1>
<p>This part shows some supplementary analyses and descriptions.</p>
<div id="facets-results" class="section level2">
<h2>FACETS results</h2>
<p>We used 2 methods (Sequenza and FACETS) for copy number calling. However, only Sequenza was used for previous downstream analyses due to the fact that FACETS generated some unreasonable copy number profile for a few samples. We will talk it here.</p>
<p>Let’s load the packages and signature data from FACETS and Sequenza.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" data-line-number="1"><span class="kw">library</span>(sigminer)</a>
<a class="sourceLine" id="cb147-2" data-line-number="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb147-3" data-line-number="3"></a>
<a class="sourceLine" id="cb147-4" data-line-number="4"><span class="kw">load</span>(<span class="st">&quot;../output/Sig.CNV.facets.W.RData&quot;</span>)</a>
<a class="sourceLine" id="cb147-5" data-line-number="5"><span class="kw">load</span>(<span class="st">&quot;../output/Sig.CNV.seqz.W.RData&quot;</span>)</a>
<a class="sourceLine" id="cb147-6" data-line-number="6"><span class="kw">load</span>(<span class="st">&quot;../output/EST.facets.W.all.RData&quot;</span>)</a></code></pre></div>
<p>According to the estimation of signature number, 6 signatures were extracted.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1">p &lt;-<span class="st"> </span><span class="kw">show_sig_number_survey</span>(EST.facets.W.all, <span class="dt">right_y =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb148-2" data-line-number="2"><span class="kw">add_h_arrow</span>(p, <span class="dt">x =</span> <span class="fl">6.2</span>, <span class="dt">y =</span> <span class="fl">0.986</span>, <span class="dt">seg_len =</span> <span class="fl">0.5</span>, <span class="dt">space =</span> <span class="fl">0.2</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-131-1.png" width="1200" /></p>
<p>The result signatures are shown as the below.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" data-line-number="1"><span class="kw">show_sig_profile</span>(Sig.CNV.facets.W, <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;W&quot;</span>, <span class="dt">normalize =</span> <span class="st">&quot;feature&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb149-2" data-line-number="2"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">caption =</span> <span class="st">&quot;Signatures from FACETS&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-132-1.png" width="3600" /></p>
<p>FACETS result has one special and extra signature (<strong>Sig1</strong>) when compared to <a href="#copy-number-signature-profile">Sequenza result</a>. The <strong>Sig1</strong> shows copy number segments with high percentage of component “copy number value = 0”.</p>
<blockquote>
<p>Other signatures are not identical but very similar in most features beteween FACETS and Sequenza results.</p>
</blockquote>
<p>We check some samples with <strong>Sig1</strong> enriched.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1">cn_groups =<span class="st"> </span><span class="kw">get_groups</span>(Sig.CNV.facets.W, <span class="dt">method =</span> <span class="st">&quot;consensus&quot;</span>, <span class="dt">match_consensus =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb150-2" data-line-number="2"><span class="co">#&gt; =&gt; Obtaining clusters from the hierarchical clustering of the consensus matrix...</span></a>
<a class="sourceLine" id="cb150-3" data-line-number="3"><span class="co">#&gt; =&gt; Finding the dominant signature of each group...</span></a>
<a class="sourceLine" id="cb150-4" data-line-number="4"><span class="co">#&gt; =&gt; Generating a table of group and dominant signature:</span></a>
<a class="sourceLine" id="cb150-5" data-line-number="5"><span class="co">#&gt;    </span></a>
<a class="sourceLine" id="cb150-6" data-line-number="6"><span class="co">#&gt;     Sig1 Sig2 Sig3 Sig4 Sig5 Sig6</span></a>
<a class="sourceLine" id="cb150-7" data-line-number="7"><span class="co">#&gt;   1    0    0   27    1    0    0</span></a>
<a class="sourceLine" id="cb150-8" data-line-number="8"><span class="co">#&gt;   2   19    2    0    7    0    0</span></a>
<a class="sourceLine" id="cb150-9" data-line-number="9"><span class="co">#&gt;   3    0   92    1    2    0    0</span></a>
<a class="sourceLine" id="cb150-10" data-line-number="10"><span class="co">#&gt;   4    7   52    8   59    9    5</span></a>
<a class="sourceLine" id="cb150-11" data-line-number="11"><span class="co">#&gt;   5    0    0    0  188    0    0</span></a>
<a class="sourceLine" id="cb150-12" data-line-number="12"><span class="co">#&gt;   6    5    2    0  155    0  292</span></a>
<a class="sourceLine" id="cb150-13" data-line-number="13"><span class="co">#&gt; =&gt; Assigning a group to a signature with the maxium fraction (stored in &#39;map_table&#39; attr)...</span></a>
<a class="sourceLine" id="cb150-14" data-line-number="14"><span class="co">#&gt; =&gt; Summarizing...</span></a>
<a class="sourceLine" id="cb150-15" data-line-number="15"><span class="co">#&gt;  group #1: 28 samples with Sig3 enriched.</span></a>
<a class="sourceLine" id="cb150-16" data-line-number="16"><span class="co">#&gt;  group #2: 28 samples with Sig1 enriched.</span></a>
<a class="sourceLine" id="cb150-17" data-line-number="17"><span class="co">#&gt;  group #3: 95 samples with Sig2 enriched.</span></a>
<a class="sourceLine" id="cb150-18" data-line-number="18"><span class="co">#&gt;  group #4: 140 samples with Sig4 enriched.</span></a>
<a class="sourceLine" id="cb150-19" data-line-number="19"><span class="co">#&gt;  group #5: 188 samples with Sig4 enriched.</span></a>
<a class="sourceLine" id="cb150-20" data-line-number="20"><span class="co">#&gt;  group #6: 454 samples with Sig6 enriched.</span></a>
<a class="sourceLine" id="cb150-21" data-line-number="21">cn_expo =<span class="st"> </span><span class="kw">get_sig_exposure</span>(Sig.CNV.facets.W, <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>)</a>
<a class="sourceLine" id="cb150-22" data-line-number="22"><span class="co"># Focus on Sig1</span></a>
<a class="sourceLine" id="cb150-23" data-line-number="23">df =<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">left_join</span>(cn_groups, cn_expo)</a>
<a class="sourceLine" id="cb150-24" data-line-number="24"><span class="co">#&gt; Joining, by = &quot;sample&quot;</span></a>
<a class="sourceLine" id="cb150-25" data-line-number="25"><span class="kw">load</span>(<span class="st">&quot;../output/CNV.facets.RData&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" data-line-number="1">samps_to_show &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb151-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(enrich_sig <span class="op">==</span><span class="st"> &quot;Sig1&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb151-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(dplyr<span class="op">::</span><span class="kw">desc</span>(Sig1)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb151-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb151-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">pull</span>(sample)</a>
<a class="sourceLine" id="cb151-6" data-line-number="6"></a>
<a class="sourceLine" id="cb151-7" data-line-number="7">samps_to_show</a>
<a class="sourceLine" id="cb151-8" data-line-number="8"><span class="co">#&gt; [1] &quot;915-1115081&quot;        &quot;141-6&quot;              &quot;447-STID0000003036&quot;</span></a>
<a class="sourceLine" id="cb151-9" data-line-number="9"><span class="co">#&gt; [4] &quot;915-5115031&quot;        &quot;141-25&quot;             &quot;915-1115090&quot;</span></a>
<a class="sourceLine" id="cb151-10" data-line-number="10"></a>
<a class="sourceLine" id="cb151-11" data-line-number="11"><span class="kw">show_cn_profile</span>(</a>
<a class="sourceLine" id="cb151-12" data-line-number="12">  <span class="dt">data =</span> CNV.facets, <span class="dt">chrs =</span> <span class="kw">paste0</span>(<span class="st">&quot;chr&quot;</span>, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">22</span>, <span class="st">&quot;X&quot;</span>)), <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">show_title =</span> T,</a>
<a class="sourceLine" id="cb151-13" data-line-number="13">  <span class="dt">samples =</span> samps_to_show</a>
<a class="sourceLine" id="cb151-14" data-line-number="14">)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-134-1.png" width="4200" /></p>
<p>We can observe that the samples with <strong>Sig1</strong> enriched have many homozygous deletions, this is unreasonable. I made a communication with the author of FACETS (<a href="https://github.com/mskcc/facets/issues/147">issue link</a>),</p>
<blockquote>
<p>So only logical explanation is homozygous deletion. However they are too many of them and so I believe this is assay artifact rather than real.</p>
</blockquote>
<p>This problem seems to come from the raw data. However, we checked the data and this signature cannot be found from the result of Sequenza.</p>
<p>To summary, we used result from Sequenza instead of FACETS for downstream analyses because we found there may be some unknown method problems in FACETS (in general, this method is still reliable).</p>
</div>
<div id="method-comparison-between-macintyre-et-al-and-our-study" class="section level2">
<h2>Method comparison between Macintyre et al and our study</h2>
<p>In section <a href="#tally-variation-records">“Tally variation records”</a>, I said that our method (defined as “Wang” or “W”) has some advantages over the method used in Macintyre et al (defined as “Macintyre” or “M”).</p>
<p>I will talk the details here.</p>
<p>Firsty let’s load the results from “M” method (the code to generate the data can be found <a href="https://github.com/ShixiangWang/prad_signature/blob/master/analysis/src/02-identify-copynumber-signatures.R">here</a>).</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1"><span class="kw">load</span>(<span class="st">&quot;../output/Sig.CNV.seqz.M.RData&quot;</span>)</a>
<a class="sourceLine" id="cb152-2" data-line-number="2"><span class="kw">load</span>(<span class="st">&quot;../output/EST.seqz.M.RData&quot;</span>)</a>
<a class="sourceLine" id="cb152-3" data-line-number="3"><span class="kw">load</span>(<span class="st">&quot;../output/CNV.seqz.tally.M.RData&quot;</span>)</a></code></pre></div>
<div id="sample-by-component-matrix-generation" class="section level3">
<h3>Sample-by-component matrix generation</h3>
<p>The key difference between method “W” and method “M” is the way to generate the sample-by-component matrix.</p>
<ul>
<li>Method “W” defines the components and counts them (details see section <a href="#tally-variation-records">“Tally variation records”</a>).</li>
<li>Method “M” applies mixture modeling to separate the 6 copy number features distributions into mixtures of Poisson or Gaussian distributions.</li>
</ul>
<p>Here we found that method “M” has the following drawbacks:</p>
<ol style="list-style-type: decimal">
<li>the computation needs huge computing resources. For generating the matrix used for NMF algorithm, it takes about 5100s (~1.5h) with 20 cores for method “M” while only 86s (~1.5m) with 20 cores for method “W”.</li>
<li>the number of component is dependent on the raw data. If we change the sample size or apply the method “M” to another cohort, the number of component may change. Method “W” will not be affected by this because it uses a fixed number of component.</li>
<li>the distribution parameters for each distribution are not identical for different runs. Even for the same data, the result distributions and sample-by-component matrix may change.</li>
</ol>
<p>At the start of this study, I used the method “M” for all analyses. Finally, we created method “W” based on the use and rethinking of method “M” and SBS signature extraction method from previous reports.</p>
<p>Next section, I will talk more problems raised by method “M” from the visualization view.</p>
</div>
<div id="copy-number-signatures-from-m-method" class="section level3">
<h3>Copy number signatures from “M” method</h3>
<p>We extracted 5 signatures like method “W”. Let’s see their signature profile.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" data-line-number="1"><span class="kw">show_sig_profile</span>(Sig.CNV.seqz.M, <span class="dt">normalize =</span> <span class="st">&quot;column&quot;</span>, <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>, </a>
<a class="sourceLine" id="cb153-2" data-line-number="2">                 <span class="dt">paint_axis_text =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-136-1.png" width="2400" /></p>
<p>This is a bar plot similar to the one reported by Macintyre et al.</p>
<p>This plot raises some issues.</p>
<div id="issue-1" class="section level4">
<h4>Issue 1</h4>
<p>The matrix used to generate the plot is column normalized, so <strong>the heights of bar cannot be compared with each other</strong>.</p>
<p>For example, firstly we see the <strong>Sig3</strong>, we may conclude that <strong>component “bp10MB2” has more contributions than component “bp10MB1”</strong>. But if we see the raw matrix, we can see that this is wrong!</p>
<p>We cannot compare two or more componets in a row when we normalize the data by column! The plot above may misguide the readers. For the plot above, we can only compare the same component across all signatures. For example, we can conclude that <strong>Sig5</strong> captures the majority of component <strong>“segsize12”</strong> and <strong>“segsize11”</strong>.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" data-line-number="1"><span class="kw">show_sig_profile</span>(Sig.CNV.seqz.M, <span class="dt">normalize =</span> <span class="st">&quot;raw&quot;</span>, <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>, </a>
<a class="sourceLine" id="cb154-2" data-line-number="2">                 <span class="dt">paint_axis_text =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-137-1.png" width="2400" /></p>
<p>To avoid misguiding readers, gradient colors may work. Also, we must tell readers in text that we should compare one component in a column insteads two or more componets in a row.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" data-line-number="1"><span class="kw">show_sig_profile</span>(Sig.CNV.seqz.M, <span class="dt">normalize =</span> <span class="st">&quot;column&quot;</span>, <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>, </a>
<a class="sourceLine" id="cb155-2" data-line-number="2">                 <span class="dt">paint_axis_text =</span> <span class="ot">FALSE</span>, <span class="dt">set_gradient_color =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-138-1.png" width="2400" /></p>
</div>
<div id="issue-2" class="section level4">
<h4>Issue 2</h4>
<p>From plot above, we can only see different components, but we cannot see the meaning of each component. For method “M”, each component represents a distribution.</p>
<p>For example, what’s the meaning of the component “copynumber2”? To fix this issue, we tried adding the key parameter value in the plot.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" data-line-number="1"><span class="kw">show_sig_profile</span>(Sig.CNV.seqz.M, <span class="dt">normalize =</span> <span class="st">&quot;column&quot;</span>, <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>, </a>
<a class="sourceLine" id="cb156-2" data-line-number="2">                 <span class="dt">paint_axis_text =</span> <span class="ot">FALSE</span>, <span class="dt">set_gradient_color =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb156-3" data-line-number="3">                 <span class="dt">params =</span> CNV.seqz.tally.M<span class="op">$</span>parameters, <span class="dt">y_expand =</span> <span class="fl">1.5</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-139-1.png" width="2400" /></p>
<p>According to the text just added, we can see that component “copynumber2” represents a Gaussian distribution with mean is 2; component “copynumber1” represents a Gaussian distribution with mean is 0.84.</p>
</div>
<div id="issue-3" class="section level4">
<h4>Issue 3</h4>
<p>Even with the plot above, we cannot know the dispersion of each component. All distributions with weight for each copy number feature can be viewed as the below.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1"><span class="kw">show_cn_components</span>(CNV.seqz.tally.M<span class="op">$</span>parameters, <span class="dt">show_weights =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-140-1.png" width="2400" /></p>
</div>
</div>
<div id="why-we-created-method-w" class="section level3">
<h3>Why we created method “W”</h3>
<p>Here, I want to talk something more.</p>
<p>If we take case of all available values for each features, we would notice that there are only limited choices. Let’s visualize them.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" data-line-number="1"><span class="kw">load</span>(<span class="st">&quot;../output/CNV.seqz.tally.W.RData&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" data-line-number="1"><span class="kw">show_cn_features</span>(CNV.seqz.tally.W<span class="op">$</span>features[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">method =</span> <span class="st">&quot;W&quot;</span>, <span class="dt">log_y =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-142-1.png" width="1800" /></p>
<p>Naturally we can divide them into categories and get a fixed number of components. It would be easy to read, understand and compare. Look back this part, why we choose a complicated method with many drawbacks instead of a simple one?</p>
</div>
</div>
<div id="some-validation-analysis-in-other-datasets" class="section level2">
<h2>Some validation analysis in other datasets</h2>
<p>We selected 1 PC datasets with copy number segmentation data from cBioPortal:</p>
<ul>
<li><a href="http://www.cbioportal.org/study/summary?id=prad_mskcc_2020" class="uri">http://www.cbioportal.org/study/summary?id=prad_mskcc_2020</a> (Primary and metastatic tumors)</li>
</ul>
<p>The segmentation data were converted into absolute copy number data by ABSOLUTE method <span class="citation">(Carter et al. <a href="#ref-carter2012absolute">2012</a>)</span> with <a href="https://github.com/ShixiangWang/DoAbsolute">DoAbsolute</a>. Signatures were extracted with “W” method.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" data-line-number="1"><span class="kw">library</span>(sigminer)</a>
<a class="sourceLine" id="cb160-2" data-line-number="2"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb160-3" data-line-number="3"></a>
<a class="sourceLine" id="cb160-4" data-line-number="4"><span class="kw">load</span>(<span class="st">&quot;../output/Sig.CNV.mskcc.RData&quot;</span>)</a>
<a class="sourceLine" id="cb160-5" data-line-number="5"></a>
<a class="sourceLine" id="cb160-6" data-line-number="6"><span class="co"># Switch Sig1 and Sig2</span></a>
<a class="sourceLine" id="cb160-7" data-line-number="7">Sig.CNV.mskcc =<span class="st"> </span><span class="kw">sig_modify_names</span>(Sig.CNV.mskcc, <span class="dt">new_names =</span> <span class="kw">paste0</span>(<span class="st">&quot;Sig&quot;</span>, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>)))</a></code></pre></div>
<div id="profile" class="section level3">
<h3>Profile</h3>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" data-line-number="1"><span class="kw">show_sig_profile</span>(Sig.CNV.mskcc, <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;W&quot;</span>, <span class="dt">normalize =</span> <span class="st">&quot;feature&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-144-1.png" width="3600" /></p>
</div>
<div id="exposure" class="section level3">
<h3>Exposure</h3>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" data-line-number="1"><span class="kw">show_sig_exposure</span>(Sig.CNV.mskcc, <span class="dt">rm_space =</span> <span class="ot">TRUE</span>, <span class="dt">style =</span> <span class="st">&quot;cosmic&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-145-1.png" width="2400" /></p>
</div>
<div id="similarity-matrix" class="section level3">
<h3>Similarity matrix</h3>
<p>Here show results of similarity calculation signatures.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" data-line-number="1"><span class="kw">load</span>(<span class="st">&quot;../output/Sig.CNV.seqz.W.RData&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" data-line-number="1"><span class="co">## Use major result as reference</span></a>
<a class="sourceLine" id="cb164-2" data-line-number="2"><span class="co">## BoChr feature is removed because it is variable in profile</span></a>
<a class="sourceLine" id="cb164-3" data-line-number="3"><span class="co">## and affect the judgement</span></a>
<a class="sourceLine" id="cb164-4" data-line-number="4">sim_mskcc =<span class="st"> </span><span class="kw">get_sig_similarity</span>(Sig.CNV.mskcc, Sig.CNV.seqz.W, <span class="dt">normalize =</span> <span class="st">&quot;feature&quot;</span>,  <span class="dt">pattern_to_rm =</span> <span class="st">&quot;BoChr&quot;</span>)</a>
<a class="sourceLine" id="cb164-5" data-line-number="5"></a>
<a class="sourceLine" id="cb164-6" data-line-number="6"><span class="kw">rownames</span>(sim_mskcc<span class="op">$</span>similarity) =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">rownames</span>(sim_mskcc<span class="op">$</span>similarity), <span class="st">&quot;(MSKCC)&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" data-line-number="1">pheatmap<span class="op">::</span><span class="kw">pheatmap</span>(sim_mskcc<span class="op">$</span>similarity[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>), ], <span class="dt">cluster_cols =</span> F, <span class="dt">cluster_rows =</span> F, <span class="dt">display_numbers =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-148-1.png" width="2400" /></p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" data-line-number="1">sig.seqz =<span class="st"> </span><span class="kw">sig_signature</span>(Sig.CNV.seqz.W, <span class="dt">normalize =</span> <span class="st">&quot;feature&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>()</a>
<a class="sourceLine" id="cb166-2" data-line-number="2">sig.mskcc =<span class="st"> </span><span class="kw">sig_signature</span>(Sig.CNV.mskcc, <span class="dt">normalize =</span> <span class="st">&quot;feature&quot;</span>)[, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>)] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>()</a>
<a class="sourceLine" id="cb166-3" data-line-number="3"></a>
<a class="sourceLine" id="cb166-4" data-line-number="4"></a>
<a class="sourceLine" id="cb166-5" data-line-number="5"><span class="kw">cor.test</span>(sig.seqz<span class="op">$</span>Sig1, sig.mskcc<span class="op">$</span>Sig1)</a>
<a class="sourceLine" id="cb166-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb166-7" data-line-number="7"><span class="co">#&gt;  Pearson&#39;s product-moment correlation</span></a>
<a class="sourceLine" id="cb166-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb166-9" data-line-number="9"><span class="co">#&gt; data:  sig.seqz$Sig1 and sig.mskcc$Sig1</span></a>
<a class="sourceLine" id="cb166-10" data-line-number="10"><span class="co">#&gt; t = 8.6516, df = 78, p-value = 5.122e-13</span></a>
<a class="sourceLine" id="cb166-11" data-line-number="11"><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></a>
<a class="sourceLine" id="cb166-12" data-line-number="12"><span class="co">#&gt; 95 percent confidence interval:</span></a>
<a class="sourceLine" id="cb166-13" data-line-number="13"><span class="co">#&gt;  0.5672875 0.7969625</span></a>
<a class="sourceLine" id="cb166-14" data-line-number="14"><span class="co">#&gt; sample estimates:</span></a>
<a class="sourceLine" id="cb166-15" data-line-number="15"><span class="co">#&gt;       cor </span></a>
<a class="sourceLine" id="cb166-16" data-line-number="16"><span class="co">#&gt; 0.6997817</span></a>
<a class="sourceLine" id="cb166-17" data-line-number="17"><span class="kw">cor.test</span>(sig.seqz<span class="op">$</span>Sig2, sig.mskcc<span class="op">$</span>Sig2)</a>
<a class="sourceLine" id="cb166-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb166-19" data-line-number="19"><span class="co">#&gt;  Pearson&#39;s product-moment correlation</span></a>
<a class="sourceLine" id="cb166-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb166-21" data-line-number="21"><span class="co">#&gt; data:  sig.seqz$Sig2 and sig.mskcc$Sig2</span></a>
<a class="sourceLine" id="cb166-22" data-line-number="22"><span class="co">#&gt; t = 3.3769, df = 78, p-value = 0.001146</span></a>
<a class="sourceLine" id="cb166-23" data-line-number="23"><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></a>
<a class="sourceLine" id="cb166-24" data-line-number="24"><span class="co">#&gt; 95 percent confidence interval:</span></a>
<a class="sourceLine" id="cb166-25" data-line-number="25"><span class="co">#&gt;  0.1491269 0.5348861</span></a>
<a class="sourceLine" id="cb166-26" data-line-number="26"><span class="co">#&gt; sample estimates:</span></a>
<a class="sourceLine" id="cb166-27" data-line-number="27"><span class="co">#&gt;       cor </span></a>
<a class="sourceLine" id="cb166-28" data-line-number="28"><span class="co">#&gt; 0.3571418</span></a>
<a class="sourceLine" id="cb166-29" data-line-number="29"><span class="kw">cor.test</span>(sig.seqz<span class="op">$</span>Sig3, sig.mskcc<span class="op">$</span>Sig3)</a>
<a class="sourceLine" id="cb166-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb166-31" data-line-number="31"><span class="co">#&gt;  Pearson&#39;s product-moment correlation</span></a>
<a class="sourceLine" id="cb166-32" data-line-number="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb166-33" data-line-number="33"><span class="co">#&gt; data:  sig.seqz$Sig3 and sig.mskcc$Sig3</span></a>
<a class="sourceLine" id="cb166-34" data-line-number="34"><span class="co">#&gt; t = 15.821, df = 78, p-value &lt; 2.2e-16</span></a>
<a class="sourceLine" id="cb166-35" data-line-number="35"><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></a>
<a class="sourceLine" id="cb166-36" data-line-number="36"><span class="co">#&gt; 95 percent confidence interval:</span></a>
<a class="sourceLine" id="cb166-37" data-line-number="37"><span class="co">#&gt;  0.8085723 0.9169635</span></a>
<a class="sourceLine" id="cb166-38" data-line-number="38"><span class="co">#&gt; sample estimates:</span></a>
<a class="sourceLine" id="cb166-39" data-line-number="39"><span class="co">#&gt;       cor </span></a>
<a class="sourceLine" id="cb166-40" data-line-number="40"><span class="co">#&gt; 0.8731653</span></a>
<a class="sourceLine" id="cb166-41" data-line-number="41"><span class="kw">cor.test</span>(sig.seqz<span class="op">$</span>Sig4, sig.mskcc<span class="op">$</span>Sig4)</a>
<a class="sourceLine" id="cb166-42" data-line-number="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb166-43" data-line-number="43"><span class="co">#&gt;  Pearson&#39;s product-moment correlation</span></a>
<a class="sourceLine" id="cb166-44" data-line-number="44"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb166-45" data-line-number="45"><span class="co">#&gt; data:  sig.seqz$Sig4 and sig.mskcc$Sig4</span></a>
<a class="sourceLine" id="cb166-46" data-line-number="46"><span class="co">#&gt; t = 16.486, df = 78, p-value &lt; 2.2e-16</span></a>
<a class="sourceLine" id="cb166-47" data-line-number="47"><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></a>
<a class="sourceLine" id="cb166-48" data-line-number="48"><span class="co">#&gt; 95 percent confidence interval:</span></a>
<a class="sourceLine" id="cb166-49" data-line-number="49"><span class="co">#&gt;  0.8207251 0.9225298</span></a>
<a class="sourceLine" id="cb166-50" data-line-number="50"><span class="co">#&gt; sample estimates:</span></a>
<a class="sourceLine" id="cb166-51" data-line-number="51"><span class="co">#&gt;       cor </span></a>
<a class="sourceLine" id="cb166-52" data-line-number="52"><span class="co">#&gt; 0.8814861</span></a>
<a class="sourceLine" id="cb166-53" data-line-number="53"><span class="kw">cor.test</span>(sig.seqz<span class="op">$</span>Sig5, sig.mskcc<span class="op">$</span>Sig5)</a>
<a class="sourceLine" id="cb166-54" data-line-number="54"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb166-55" data-line-number="55"><span class="co">#&gt;  Pearson&#39;s product-moment correlation</span></a>
<a class="sourceLine" id="cb166-56" data-line-number="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb166-57" data-line-number="57"><span class="co">#&gt; data:  sig.seqz$Sig5 and sig.mskcc$Sig5</span></a>
<a class="sourceLine" id="cb166-58" data-line-number="58"><span class="co">#&gt; t = 30.086, df = 78, p-value &lt; 2.2e-16</span></a>
<a class="sourceLine" id="cb166-59" data-line-number="59"><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></a>
<a class="sourceLine" id="cb166-60" data-line-number="60"><span class="co">#&gt; 95 percent confidence interval:</span></a>
<a class="sourceLine" id="cb166-61" data-line-number="61"><span class="co">#&gt;  0.9374232 0.9739083</span></a>
<a class="sourceLine" id="cb166-62" data-line-number="62"><span class="co">#&gt; sample estimates:</span></a>
<a class="sourceLine" id="cb166-63" data-line-number="63"><span class="co">#&gt;       cor </span></a>
<a class="sourceLine" id="cb166-64" data-line-number="64"><span class="co">#&gt; 0.9595117</span></a></code></pre></div>
<p>Further validate with heatmap of signature component weight.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" data-line-number="1"><span class="kw">library</span>(NMF)</a></code></pre></div>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" data-line-number="1">pheatmap<span class="op">::</span><span class="kw">pheatmap</span>(<span class="kw">sig_signature</span>(Sig.CNV.seqz.W, <span class="dt">normalize =</span> <span class="st">&quot;feature&quot;</span>),</a>
<a class="sourceLine" id="cb168-2" data-line-number="2">                   <span class="dt">cluster_rows =</span> F, <span class="dt">cluster_cols =</span> F, </a>
<a class="sourceLine" id="cb168-3" data-line-number="3">                   <span class="dt">fontsize_row =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb168-4" data-line-number="4">                   <span class="dt">color =</span> <span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dt">n =</span> <span class="dv">7</span>, <span class="dt">name =</span></a>
<a class="sourceLine" id="cb168-5" data-line-number="5">                                                         <span class="st">&quot;OrRd&quot;</span>))(<span class="dv">100</span>),</a>
<a class="sourceLine" id="cb168-6" data-line-number="6">                   <span class="dt">border_color =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb168-7" data-line-number="7">                   <span class="dt">filename =</span> <span class="st">&quot;../Heatmap_cnv_our_cohort.pdf&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" data-line-number="1">pheatmap<span class="op">::</span><span class="kw">pheatmap</span>(<span class="kw">sig_signature</span>(Sig.CNV.mskcc, <span class="dt">normalize =</span> <span class="st">&quot;feature&quot;</span>)[, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>)],</a>
<a class="sourceLine" id="cb169-2" data-line-number="2">                   <span class="dt">cluster_rows =</span> F, <span class="dt">cluster_cols =</span> F, </a>
<a class="sourceLine" id="cb169-3" data-line-number="3">                   <span class="dt">fontsize_row =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb169-4" data-line-number="4">                   <span class="dt">color =</span> <span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dt">n =</span> <span class="dv">7</span>, <span class="dt">name =</span></a>
<a class="sourceLine" id="cb169-5" data-line-number="5">                                                         <span class="st">&quot;OrRd&quot;</span>))(<span class="dv">100</span>),</a>
<a class="sourceLine" id="cb169-6" data-line-number="6">                   <span class="dt">border_color =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb169-7" data-line-number="7">                   <span class="dt">filename =</span> <span class="st">&quot;../Heatmap_cnv_mskcc_cohort.pdf&quot;</span>)</a></code></pre></div>
</div>
<div id="exposure-comparison" class="section level3">
<h3>Exposure comparison</h3>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" data-line-number="1">expo_ours =<span class="st"> </span><span class="kw">get_sig_exposure</span>(Sig.CNV.seqz.W, <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>)</a>
<a class="sourceLine" id="cb170-2" data-line-number="2">expo_mskcc =<span class="st"> </span><span class="kw">get_sig_exposure</span>(Sig.CNV.mskcc, <span class="dt">type =</span> <span class="st">&quot;relative&quot;</span>)</a>
<a class="sourceLine" id="cb170-3" data-line-number="3"></a>
<a class="sourceLine" id="cb170-4" data-line-number="4">expo =<span class="st"> </span><span class="kw">rbind</span>(expo_ours[, Cohort<span class="op">:</span><span class="er">=</span><span class="st">&quot;Our&quot;</span>],</a>
<a class="sourceLine" id="cb170-5" data-line-number="5">             expo_mskcc[, Cohort<span class="op">:</span><span class="er">=</span><span class="st">&quot;MSKCC2020&quot;</span>])</a>
<a class="sourceLine" id="cb170-6" data-line-number="6"></a>
<a class="sourceLine" id="cb170-7" data-line-number="7">expo_df =<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(expo,</a>
<a class="sourceLine" id="cb170-8" data-line-number="8">                              <span class="dt">cols =</span> dplyr<span class="op">::</span><span class="kw">starts_with</span>(<span class="st">&quot;Sig&quot;</span>),</a>
<a class="sourceLine" id="cb170-9" data-line-number="9">                              <span class="dt">names_prefix =</span> <span class="st">&quot;Sig&quot;</span>,</a>
<a class="sourceLine" id="cb170-10" data-line-number="10">                              <span class="dt">names_to =</span> <span class="st">&quot;Signature&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Exposure&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" data-line-number="1"><span class="kw">library</span>(ggpubr)</a>
<a class="sourceLine" id="cb171-2" data-line-number="2"></a>
<a class="sourceLine" id="cb171-3" data-line-number="3"><span class="kw">ggboxplot</span>(expo_df, <span class="dt">x =</span> <span class="st">&quot;Signature&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Exposure&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Cohort&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb171-4" data-line-number="4"><span class="st">  </span><span class="kw">stat_compare_means</span>(<span class="kw">aes</span>(<span class="dt">group=</span>Cohort), <span class="dt">label =</span> <span class="st">&quot;p.format&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-154-1.png" width="2400" /></p>
</div>
<div id="survival-analysis-1" class="section level3">
<h3>Survival analysis</h3>
<p>To better understand the signatures, here we evaluate the association between signature exposure and prognosis.</p>
<p>Firstly, get the signature exposure.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" data-line-number="1">expo_mskcc =<span class="st"> </span><span class="kw">get_sig_exposure</span>(Sig.CNV.mskcc)</a></code></pre></div>
<p>Then we get survival status, patient IDs, sample IDs etc.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" data-line-number="1">mskcc_patient =<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_tsv</span>(<span class="st">&quot;../data/mskcc_2020/data_clinical_patient.txt&quot;</span>, <span class="dt">comment =</span> <span class="st">&quot;#&quot;</span>)</a>
<a class="sourceLine" id="cb173-2" data-line-number="2">mskcc_sample  =<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_tsv</span>(<span class="st">&quot;../data/mskcc_2020/data_clinical_sample.txt&quot;</span>, <span class="dt">comment =</span> <span class="st">&quot;#&quot;</span>)</a></code></pre></div>
<p>Merge data before doing survival analysis with <strong>ezcox</strong> package.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" data-line-number="1">dat_mskcc =<span class="st"> </span>expo_mskcc <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb174-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb174-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb174-4" data-line-number="4">    mskcc_sample <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(SAMPLE_ID, PATIENT_ID, SAMPLE_TYPE),</a>
<a class="sourceLine" id="cb174-5" data-line-number="5">    <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;sample&quot;</span> =<span class="st"> &quot;SAMPLE_ID&quot;</span>)</a>
<a class="sourceLine" id="cb174-6" data-line-number="6">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb174-7" data-line-number="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb174-8" data-line-number="8">    mskcc_patient,</a>
<a class="sourceLine" id="cb174-9" data-line-number="9">    <span class="dt">by =</span> <span class="st">&quot;PATIENT_ID&quot;</span></a>
<a class="sourceLine" id="cb174-10" data-line-number="10">  )</a></code></pre></div>
<p>Clean. Still scale exposure to 1-20 for indicating HR per 5% exposure increase.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" data-line-number="1">cols_to_sig =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;Sig&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb175-2" data-line-number="2"></a>
<a class="sourceLine" id="cb175-3" data-line-number="3">range01 &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...) {</a>
<a class="sourceLine" id="cb175-4" data-line-number="4">  (x <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x, ...)) <span class="op">/</span><span class="st"> </span>(<span class="kw">max</span>(x, ...) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x, ...))</a>
<a class="sourceLine" id="cb175-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb175-6" data-line-number="6"></a>
<a class="sourceLine" id="cb175-7" data-line-number="7">dat_mskcc2 =<span class="st"> </span>dat_mskcc <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb175-8" data-line-number="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(sample<span class="op">:</span>SAMPLE_TYPE, OS_STATUS, OS_MONTHS) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb175-9" data-line-number="9"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb175-10" data-line-number="10">    <span class="dt">OS_STATUS =</span> <span class="kw">ifelse</span>(OS_STATUS <span class="op">==</span><span class="st"> &quot;LIVING&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb175-11" data-line-number="11">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb175-12" data-line-number="12"><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb175-13" data-line-number="13"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(</a>
<a class="sourceLine" id="cb175-14" data-line-number="14">    cols_to_sig,</a>
<a class="sourceLine" id="cb175-15" data-line-number="15">    <span class="op">~</span><span class="st"> </span><span class="dv">20</span> <span class="op">*</span><span class="st"> </span><span class="kw">range01</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb175-16" data-line-number="16">  )</a></code></pre></div>
<p>Now we do survival analysis.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" data-line-number="1"><span class="kw">library</span>(ezcox)</a></code></pre></div>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" data-line-number="1"><span class="co"># Unvariable analysis</span></a>
<a class="sourceLine" id="cb177-2" data-line-number="2"><span class="kw">show_forest</span>(dat_mskcc2, <span class="dt">covariates =</span> cols_to_sig,</a>
<a class="sourceLine" id="cb177-3" data-line-number="3">            <span class="dt">time =</span> <span class="st">&quot;OS_MONTHS&quot;</span>, <span class="dt">status =</span> <span class="st">&quot;OS_STATUS&quot;</span>, <span class="dt">merge_models =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-160-1.png" width="2400" /></p>
<p>Check primary and metastatic samples independently.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" data-line-number="1"><span class="kw">show_forest</span>(dat_mskcc2 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(SAMPLE_TYPE <span class="op">==</span><span class="st"> &quot;Primary&quot;</span>), <span class="dt">covariates =</span> cols_to_sig,</a>
<a class="sourceLine" id="cb178-2" data-line-number="2">            <span class="dt">time =</span> <span class="st">&quot;OS_MONTHS&quot;</span>, <span class="dt">status =</span> <span class="st">&quot;OS_STATUS&quot;</span>, <span class="dt">merge_models =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-161-1.png" width="2400" /></p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" data-line-number="1"><span class="kw">show_forest</span>(dat_mskcc2 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(SAMPLE_TYPE <span class="op">!=</span><span class="st"> &quot;Primary&quot;</span>), <span class="dt">covariates =</span> cols_to_sig,</a>
<a class="sourceLine" id="cb179-2" data-line-number="2">            <span class="dt">time =</span> <span class="st">&quot;OS_MONTHS&quot;</span>, <span class="dt">status =</span> <span class="st">&quot;OS_STATUS&quot;</span>, <span class="dt">merge_models =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-162-1.png" width="2400" /></p>
<p>Based on the result from mskcc dataset, overall survival status of primary and metastatic samples roughly have consistent relationship with copy number signatures. However, <code>Sig4</code> specially functions in primary tumors and <code>Sig3</code> tends to function in metastatic tumors. Furthermore, from the view of HR comparison between two plots above, copy number signatures have more clinical effects on primary tumors rather than metastatic tumors.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" data-line-number="1">groups =<span class="st"> </span><span class="kw">get_groups</span>(Sig.CNV.mskcc, <span class="dt">method =</span> <span class="st">&quot;consensus&quot;</span>, <span class="dt">match_consensus =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb180-2" data-line-number="2"><span class="co">#&gt;    </span></a>
<a class="sourceLine" id="cb180-3" data-line-number="3"><span class="co">#&gt;     Sig1 Sig2 Sig3 Sig4 Sig5</span></a>
<a class="sourceLine" id="cb180-4" data-line-number="4"><span class="co">#&gt;   1   29    7    0    3    1</span></a>
<a class="sourceLine" id="cb180-5" data-line-number="5"><span class="co">#&gt;   2    0   76    0    0    0</span></a>
<a class="sourceLine" id="cb180-6" data-line-number="6"><span class="co">#&gt;   3    6   20  132    3    1</span></a>
<a class="sourceLine" id="cb180-7" data-line-number="7"><span class="co">#&gt;   4    0   15    0  318    0</span></a>
<a class="sourceLine" id="cb180-8" data-line-number="8"><span class="co">#&gt;   5    0   24    0   60  607</span></a></code></pre></div>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" data-line-number="1">df.map =<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb181-2" data-line-number="2">  dat_mskcc, groups,</a>
<a class="sourceLine" id="cb181-3" data-line-number="3">  <span class="dt">by =</span> <span class="st">&quot;sample&quot;</span></a>
<a class="sourceLine" id="cb181-4" data-line-number="4">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb181-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;SAMPLE_TYPE&quot;</span>, <span class="st">&quot;enrich_sig&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb181-6" data-line-number="6"><span class="st">  </span><span class="kw">na.omit</span>()</a></code></pre></div>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" data-line-number="1"><span class="kw">names</span>(df.map) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Sample type&quot;</span>, <span class="st">&quot;Enriched signature&quot;</span>)</a>
<a class="sourceLine" id="cb182-2" data-line-number="2"><span class="kw">show_group_mapping</span>(df.map, </a>
<a class="sourceLine" id="cb182-3" data-line-number="3">                   <span class="dt">col_to_flow =</span> <span class="st">&quot;Sample type&quot;</span>, </a>
<a class="sourceLine" id="cb182-4" data-line-number="4">                   <span class="dt">cols_to_map =</span> <span class="kw">setdiff</span>(<span class="kw">colnames</span>(df.map), <span class="st">&quot;Sample type&quot;</span>),</a>
<a class="sourceLine" id="cb182-5" data-line-number="5">                   <span class="dt">fill_na =</span> <span class="st">&quot;NA&quot;</span>, <span class="dt">include_sig =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-165-1.png" width="2400" /></p>
<p>Test the correlation with fisher test.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" data-line-number="1">zz =<span class="st"> </span><span class="kw">table</span>(df.map<span class="op">$</span><span class="st">`</span><span class="dt">Sample type</span><span class="st">`</span>, df.map<span class="op">$</span><span class="st">`</span><span class="dt">Enriched signature</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb183-2" data-line-number="2"><span class="kw">fisher.test</span>(zz, <span class="dt">simulate.p.value =</span> T)</a>
<a class="sourceLine" id="cb183-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb183-4" data-line-number="4"><span class="co">#&gt;  Fisher&#39;s Exact Test for Count Data with simulated p-value (based on</span></a>
<a class="sourceLine" id="cb183-5" data-line-number="5"><span class="co">#&gt;  2000 replicates)</span></a>
<a class="sourceLine" id="cb183-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb183-7" data-line-number="7"><span class="co">#&gt; data:  zz</span></a>
<a class="sourceLine" id="cb183-8" data-line-number="8"><span class="co">#&gt; p-value = 0.0004998</span></a>
<a class="sourceLine" id="cb183-9" data-line-number="9"><span class="co">#&gt; alternative hypothesis: two.sided</span></a></code></pre></div>
</div>
</div>
</div>
<div id="reference" class="section level1 unnumbered">
<h1>Reference</h1>
<div id="refs" class="references">
<div id="ref-alexandrov2013signatures">
<p>Alexandrov, Ludmil B, Serena Nik-Zainal, David C Wedge, Samuel AJR Aparicio, Sam Behjati, Andrew V Biankin, Graham R Bignell, et al. 2013. “Signatures of Mutational Processes in Human Cancer.” <em>Nature</em> 500 (7463). Nature Publishing Group: 415.</p>
</div>
<div id="ref-armenia2018long">
<p>Armenia, Joshua, Stephanie AM Wankowicz, David Liu, Jianjiong Gao, Ritika Kundra, Ed Reznik, Walid K Chatila, et al. 2018. “The Long Tail of Oncogenic Drivers in Prostate Cancer.” <em>Nature Genetics</em> 50 (5). Nature Publishing Group: 645.</p>
</div>
<div id="ref-carter2012absolute">
<p>Carter, Scott L, Kristian Cibulskis, Elena Helman, Aaron McKenna, Hui Shen, Travis Zack, Peter W Laird, et al. 2012. “Absolute Quantification of Somatic Dna Alterations in Human Cancer.” <em>Nature Biotechnology</em> 30 (5). Nature Publishing Group: 413.</p>
</div>
<div id="ref-favero2014sequenza">
<p>Favero, Francesco, Tejal Joshi, Andrea Marion Marquard, Nicolai Juul Birkbak, Marcin Krzystanek, Qiyuan Li, Z Szallasi, and Aron Charles Eklund. 2014. “Sequenza: Allele-Specific Copy Number and Mutation Profiles from Tumor Sequencing Data.” <em>Annals of Oncology</em> 26 (1). European Society for Medical Oncology: 64–70.</p>
</div>
<div id="ref-gaujoux2010flexible">
<p>Gaujoux, Renaud, and Cathal Seoighe. 2010. “A Flexible R Package for Nonnegative Matrix Factorization.” <em>BMC Bioinformatics</em> 11 (1). BioMed Central: 367.</p>
</div>
<div id="ref-krueger2015trim">
<p>Krueger, Felix. 2015. “Trim Galore.” <em>A Wrapper Tool Around Cutadapt and FastQC to Consistently Apply Quality and Adapter Trimming to FastQ Files</em>.</p>
</div>
<div id="ref-li2013aligning">
<p>Li, Heng. 2013. “Aligning Sequence Reads, Clone Sequences and Assembly Contigs with Bwa-Mem.” <em>arXiv Preprint arXiv:1303.3997</em>.</p>
</div>
<div id="ref-li2009sequence">
<p>Li, Heng, Bob Handsaker, Alec Wysoker, Tim Fennell, Jue Ruan, Nils Homer, Gabor Marth, Goncalo Abecasis, and Richard Durbin. 2009. “The Sequence Alignment/Map Format and Samtools.” <em>Bioinformatics</em> 25 (16). Oxford University Press: 2078–9.</p>
</div>
<div id="ref-macintyre2018copy">
<p>Macintyre, Geoff, Teodora E Goranova, Dilrini De Silva, Darren Ennis, Anna M Piskorz, Matthew Eldridge, Daoud Sie, et al. 2018. “Copy Number Signatures and Mutational Processes in Ovarian Carcinoma.” <em>Nature Genetics</em> 50 (9). Nature Publishing Group: 1262.</p>
</div>
<div id="ref-mayakonda2016maftools">
<p>Mayakonda, Anand, and H Phillip Koeffler. 2016. “Maftools: Efficient Analysis, Visualization and Summarization of Maf Files from Large-Scale Cohort Based Cancer Studies.” <em>BioRxiv</em>. Cold Spring Harbor Laboratory, 052662.</p>
</div>
<div id="ref-mclaren2016ensembl">
<p>McLaren, William, Laurent Gil, Sarah E Hunt, Harpreet Singh Riat, Graham RS Ritchie, Anja Thormann, Paul Flicek, and Fiona Cunningham. 2016. “The Ensembl Variant Effect Predictor.” <em>Genome Biology</em> 17 (1). BioMed Central: 122.</p>
</div>
<div id="ref-Picard2019toolkit">
<p>“Picard Toolkit.” 2019. <em>Broad Institute, GitHub Repository</em>. <a href="http://broadinstitute.github.io/picard/">http://broadinstitute.github.io/picard/</a>; Broad Institute.</p>
</div>
<div id="ref-shen_facets:_2016">
<p>Shen, Ronglai, and Venkatraman E. Seshan. 2016. “FACETS: Allele-Specific Copy Number and Clonal Heterogeneity Analysis Tool for High-Throughput DNA Sequencing.” <em>Nucleic Acids Research</em> 44 (16): e131–e131. <a href="https://doi.org/10.1093/nar/gkw520">https://doi.org/10.1093/nar/gkw520</a>.</p>
</div>
<div id="ref-van2013fastq">
<p>Van der Auwera, Geraldine A, Mauricio O Carneiro, Christopher Hartl, Ryan Poplin, Guillermo Del Angel, Ami Levy-Moonshine, Tadeusz Jordan, et al. 2013. “From Fastq Data to High-Confidence Variant Calls: The Genome Analysis Toolkit Best Practices Pipeline.” <em>Current Protocols in Bioinformatics</em> 43 (1). Wiley Online Library: 11–10.</p>
</div>
<div id="ref-wang2019ucscxenatools">
<p>Wang, Shixiang, and Xuesong Liu. 2019. “The Ucscxenatools R Package: A Toolkit for Accessing Genomics Data from Ucsc Xena Platform, from Cancer Multi-Omics to Single-Cell Rna-Seq.” <em>Journal of Open Source Software</em> 4 (40): 1627.</p>
</div>
<div id="ref-yi2018patterns">
<p>Yi, Kijong, and Young Seok Ju. 2018. “Patterns and Mechanisms of Structural Variations in Human Cancer.” <em>Experimental &amp; Molecular Medicine</em> 50 (8). Nature Publishing Group: 98.</p>
</div>
</div>
</div>
</div>


</div>

<div id="postamble" data-toggle="wy-nav-shift" class="status">
<p class="author"><span class="glyphicon glyphicon-user"></span> Shixiang Wang</p>
<p class="author"><span class="glyphicon glyphicon-user"></span> Huimin Li</p>
<p class="author"><span class="glyphicon glyphicon-user"></span> Xuan Wang</p>
<p class="author"><span class="glyphicon glyphicon-user"></span> Minfang Song</p>
<p class="author"><span class="glyphicon glyphicon-user"></span> Xue-Song Liu (Corresponding author)</p>
<p class="date"><span class="glyphicon glyphicon-calendar"></span> 2020-03-10</p>
</div>


<script>
$(document).ready(function () {
 	    $('#content img')
 	  .addClass("image-lb");
  $('#content').magnificPopup({
	      type:'image',
	      closeOnContentClick: false,
	      closeBtnInside: false,
	      delegate: 'img',
	      gallery: {enabled: true },
	      image: {
	        verticalFit: true,
          titleSrc: 'alt'
	      }
 	    });
 	});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
