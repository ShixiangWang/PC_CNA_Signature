---
title: "Variation Summary"
author: ["Shixiang Wang", "Huimin Li", "Xuan Wang", "Minfang Song", "Xue-Song Liu (Corresponding author)"]
date: "`r Sys.Date()`"
output:
  rmdformats::readthedown:
    highlight: kate
    self_contained: false
    mathjax: true
    lightbox: true
    gallery: true
bibliography: ref.bib
link-citations: yes
---

```{r knitr_init_98, echo=FALSE}
library(knitr)
library(rmdformats)
## Global options
options(max.print = "75")
opts_chunk$set(
  echo = TRUE,
  comment = "#>",
  collapse = TRUE,
  cache = TRUE,
  dpi = 300,
  warning = FALSE,
  message = FALSE,
  tidy = "styler"
)
opts_knit$set(width = 75)
```

This part discribes some big pictures of genomic variations in prostate cancers.
They are not directly related to the core analyses previously reported.

```{r}
library(sigminer)


load("../output/CNV.seqz.RData")
load("../output/CNV.seqz.tally.W.RData")
load("../output/PRAD_TCGA_plus_dbGap_Maf.RData")
```


## Oncoplot


TODO: add GISTIC/MutSig, etc. data (plots ref to <http://bioconductor.org/packages/release/bioc/vignettes/maftools/inst/doc/oncoplots.html>) 

```{r}
oncoplot(maf = Maf, top = 10)
```



## Summary plots

### SBS


```{r}
library(maftools)
```

#### MAF summary

```{r}
plotmafSummary(maf = Maf, rmOutlier = TRUE, addStat = 'median', dashboard = TRUE, titvRaw = FALSE, log_scale = TRUE)
```

#### Transition and Transversions

```{r}
maf.titv = titv(maf = Maf, plot = FALSE, useSyn = TRUE)
#plot titv summary
plotTiTv(res = maf.titv)
```

#### Somatic Interactions

```{r}
somaticInteractions(maf = Maf, top = 25, pvalue = c(0.05, 0.1))
```


### Copy number

#### Copy number segment distribution


```{r}
show_cn_distribution(CNV.seqz, mode = "ld")
```

```{r}
show_cn_distribution(CNV.seqz, mode = "cd")
```

#### Feature distribution

```{r, fig.width=10, fig.height=6}
show_cn_features(CNV.seqz.tally.W$features, method = "W", log_y = TRUE)
```

#### Component distribution

```{r, fig.width=10, fig.height=6}
show_cn_components(CNV.seqz.tally.W$parameters, method = "W", log_y = TRUE)
```

Data details can be viewed as a table:

```{r}
DT::datatable(CNV.seqz.tally.W$parameters)
```

> `n_obs` column indicates the number of event of corresponding copy number component.
